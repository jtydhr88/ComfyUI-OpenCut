"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2877],{4600:(e,t,a)=>{a.d(t,{aU:()=>i,s6:()=>n});var r=a(82337);let n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HH:MM:SS:CS",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.ge,n=Math.floor(e/3600),i=Math.floor(e%3600/60),l=Math.floor(e%60),s=Math.floor(e%1*100),o=Math.floor(e%1*a);switch(t){case"MM:SS":return"".concat(i.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"));case"HH:MM:SS":return"".concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"));case"HH:MM:SS:CS":return"".concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"));case"HH:MM:SS:FF":return"".concat(n.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"),":").concat(o.toString().padStart(2,"0"))}},i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HH:MM:SS:CS",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.ge;if(!e||"string"!=typeof e)return null;let n=e.trim();try{switch(t){case"MM:SS":{let e=n.split(":");if(2!==e.length)return null;let[t,a]=e.map(e=>parseInt(e,10));if(isNaN(t)||isNaN(a)||t<0||a<0||a>=60)return null;return 60*t+a}case"HH:MM:SS":{let e=n.split(":");if(3!==e.length)return null;let[t,a,r]=e.map(e=>parseInt(e,10));if(isNaN(t)||isNaN(a)||isNaN(r)||t<0||a<0||r<0||a>=60||r>=60)return null;return 3600*t+60*a+r}case"HH:MM:SS:CS":{let e=n.split(":");if(4!==e.length)return null;let[t,a,r,i]=e.map(e=>parseInt(e,10));if(isNaN(t)||isNaN(a)||isNaN(r)||isNaN(i)||t<0||a<0||r<0||i<0||a>=60||r>=60||i>=100)return null;return 3600*t+60*a+r+i/100}case"HH:MM:SS:FF":{let e=n.split(":");if(4!==e.length)return null;let[t,r,i,l]=e.map(e=>parseInt(e,10));if(isNaN(t)||isNaN(r)||isNaN(i)||isNaN(l)||t<0||r<0||i<0||l<0||r>=60||i>=60||l>=a)return null;return 3600*t+60*r+i+l/a}}}catch(e){}return null}},4976:(e,t,a)=>{a.d(t,{K:()=>ee});var r=a(28064),n=a(10952),i=a(61309),l=a(15482),s=a(56440),o=a(85531),c=a(16224),d=a(43589),u=a(81450),m=a(53093),f=a(45440),h=a(47888),p=a(62243),x=a(82549),g=a(26796),v=a(65763),j=a(56139),y=a(79899),w=a(87134),b=a(73539),N=a(20288),S=a(26530),C=a(19884),k=a(43811),E=a(46438),T=a(86434),R=a(91685),A=a(80196),M=a(81925),I=a(82337),P=a(74188),L=a(47165),D=a(61557),z=a(64889),F=a(61275),_=a(90254),O=a(41662),B=a(90617);let U=e=>{let{audioUrl:t,height:a=32,className:n=""}=e,i=(0,P.useRef)(null),l=(0,P.useRef)(null),[s,o]=(0,P.useState)(!0),[c,d]=(0,P.useState)(!1);return((0,P.useEffect)(()=>{let e=!0,r=l.current,n=async()=>{if(i.current&&t)try{r&&(l.current=null);let n=B.A.create({container:i.current,waveColor:"rgba(255, 255, 255, 0.6)",progressColor:"rgba(255, 255, 255, 0.9)",cursorColor:"transparent",barWidth:2,barGap:1,height:a,normalize:!0,interact:!1});if(e)l.current=n;else{try{n.destroy()}catch(e){}return}n.on("ready",()=>{e&&(o(!1),d(!1))}),n.on("error",t=>{e&&(d(!0),o(!1))}),await n.load(t)}catch(t){e&&(d(!0),o(!1))}};return r?(l.current=null,requestAnimationFrame(()=>{try{r.destroy()}catch(e){}e&&n()})):n(),()=>{e=!1;let t=l.current;l.current=null,t&&requestAnimationFrame(()=>{try{t.destroy()}catch(e){}})}},[t,a]),c)?(0,r.jsx)("div",{className:"flex items-center justify-center ".concat(n),style:{height:a},children:(0,r.jsx)("span",{className:"text-xs text-foreground/60",children:"Audio unavailable"})}):(0,r.jsxs)("div",{className:"relative ".concat(n),children:[s&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-xs text-foreground/60",children:"Loading..."})}),(0,r.jsx)("div",{ref:i,className:"w-full transition-opacity duration-200 ".concat(s?"opacity-0":"opacity-100"),style:{height:a}})]})};var H=a(87100),$=a(90649);function X(e){let{element:t,track:a,zoomLevel:n,isSelected:i,onElementMouseDown:l,onElementClick:s}=e,{mediaItems:d}=(0,A.B)(),{updateElementTrim:u,updateElementDuration:m,removeElementFromTrack:f,removeElementFromTrackWithRipple:h,dragState:p,splitElement:g,addElementToTrack:v,replaceElementMedia:j,rippleEditingEnabled:w,toggleElementHidden:N,toggleElementMuted:S}=(0,R.A)(),{currentTime:C}=(0,M.E)(),k="media"===t.type?d.find(e=>e.id===t.mediaId):null,E=(null==k?void 0:k.type)==="audio"||(null==k?void 0:k.type)==="video",{resizing:L,handleResizeStart:B,handleResizeMove:X,handleResizeEnd:V}=function(e){let{element:t,track:a,zoomLevel:r,onUpdateTrim:n,onUpdateDuration:i}=e,[l,s]=(0,P.useState)(null),{mediaItems:o}=(0,A.B)(),{updateElementStartTime:c,updateElementTrim:d,updateElementDuration:u,pushHistory:m}=(0,R.A)();(0,P.useEffect)(()=>{if(!l)return;let e=e=>{h({clientX:e.clientX})},t=()=>{p()};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}},[l]);let f=()=>{if("text"===t.type)return!0;if("media"===t.type){let e=o.find(e=>e.id===t.mediaId);if(!e)return!1;if("image"===e.type)return!0}return!1},h=e=>{var n;if(!l)return;let i=(e.clientX-l.startX)/(50*r),s=(null==(n=I.Iw.getState().activeProject)?void 0:n.fps)||I.ge;if("left"===l.side){let e=t.duration-l.initialTrimEnd-.1,r=l.initialTrimStart+i;if(r>=0){let n=(0,H.gY)(Math.min(e,r),s),i=n-l.initialTrimStart,o=(0,H.gY)(t.startTime+i,s);d(a.id,t.id,n,l.initialTrimEnd,!1),c(a.id,t.id,o,!1)}else if(f()){let e=Math.min(Math.abs(r),t.startTime),n=(0,H.gY)(t.startTime-e,s),i=(0,H.gY)(t.duration+e,s);d(a.id,t.id,0,l.initialTrimEnd,!1),u(a.id,t.id,i,!1),c(a.id,t.id,n,!1)}else{let e=0-l.initialTrimStart,r=(0,H.gY)(t.startTime+e,s);d(a.id,t.id,0,l.initialTrimEnd,!1),c(a.id,t.id,r,!1)}}else{let e=l.initialTrimEnd-i;if(e<0)if(f()){let r=Math.abs(e),n=(0,H.gY)(t.duration+r,s);u(a.id,t.id,n,!1),d(a.id,t.id,l.initialTrimStart,0,!1)}else d(a.id,t.id,l.initialTrimStart,0,!1);else{let e=t.startTime+t.duration-t.trimStart-t.trimEnd,r=(0,H.gY)(e+i,s),n=Math.max(0,t.duration-t.trimStart-(r-t.startTime)),l=Math.min(t.duration-t.trimStart-.1,n);d(a.id,t.id,t.trimStart,l,!1)}}},p=()=>{s(null)};return{resizing:l,isResizing:null!==l,handleResizeStart:(e,a,r)=>{e.stopPropagation(),e.preventDefault(),m(),s({elementId:a,side:r,startX:e.clientX,initialTrimStart:t.trimStart,initialTrimEnd:t.trimEnd})},handleResizeMove:()=>{},handleResizeEnd:()=>{}}}({element:t,track:a,zoomLevel:n,onUpdateTrim:u,onUpdateDuration:m}),{requestRevealMedia:W}=$.t.getState(),Y=t.duration-t.trimStart-t.trimEnd,Z=Math.max(H.of.ELEMENT_MIN_WIDTH,Y*H.of.PIXELS_PER_SECOND*n),K=p.elementId===t.id,G=50*(K&&p.isDragging?p.currentTime:t.startTime)*n,q="media"===t.type&&!0===t.muted;return(0,r.jsxs)(T.tz,{children:[(0,r.jsx)(T.Rc,{asChild:!0,children:(0,r.jsx)("div",{className:"absolute top-0 h-full select-none timeline-element ".concat(K?"z-50":"z-10"),style:{left:"".concat(G,"px"),width:"".concat(Z,"px")},"data-element-id":t.id,"data-track-id":a.id,onMouseMove:L?X:void 0,onMouseUp:L?V:void 0,onMouseLeave:L?V:void 0,children:(0,r.jsxs)("div",{className:"relative h-full rounded-[0.5rem] cursor-pointer overflow-hidden ".concat((0,H.A0)(a.type)," ").concat(""," ").concat(K?"z-50":"z-10"," ").concat(t.hidden?"opacity-50":""),onClick:e=>s&&s(e,t),onMouseDown:e=>{l&&l(e,t)},onContextMenu:e=>l&&l(e,t),children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center h-full",children:(()=>{if("text"===t.type)return(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-start pl-2",children:(0,r.jsx)("span",{className:"text-xs text-white truncate",children:t.content})});let e=d.find(e=>e.id===t.mediaId);if(!e)return(0,r.jsx)("span",{className:"text-xs text-foreground/80 truncate",children:t.name});if("image"===e.type||"video"===e.type&&e.thumbnailUrl){let t=(0,H.t_)(a.type),n=16/9*t,l="image"===e.type?e.url:e.thumbnailUrl,s="image"===e.type;return(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-full h-full relative ".concat(i?"bg-primary":"bg-transparent"),children:(0,r.jsx)("div",{className:"absolute top-[0.25rem] bottom-[0.25rem] left-0 right-0",style:{backgroundImage:l?"url(".concat(l,")"):"none",backgroundRepeat:"repeat-x",backgroundSize:"".concat(n,"px ").concat(t,"px"),backgroundPosition:"left center",pointerEvents:"none"},"aria-label":"Tiled ".concat(s?"background":"thumbnail"," of ").concat(e.name)})})})}return"audio"===e.type?(0,r.jsx)("div",{className:"w-full h-full flex items-center gap-2",children:(0,r.jsx)("div",{className:"flex-1 min-w-0",children:(0,r.jsx)(U,{audioUrl:e.url||"",height:24,className:"w-full"})})}):(0,r.jsx)("span",{className:"text-xs text-foreground/80 truncate",children:t.name})})()}),(E?q:t.hidden)&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center pointer-events-none",children:E?(0,r.jsx)(z.A,{className:"h-6 w-6 text-white"}):(0,r.jsx)(F.A,{className:"h-6 w-6 text-white"})}),i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-[0.6rem] cursor-w-resize bg-primary z-50 flex items-center justify-center",onMouseDown:e=>B(e,t.id,"left"),children:(0,r.jsx)("div",{className:"w-[0.2rem] h-[1.5rem] bg-foreground/75 rounded-full"})}),(0,r.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-[0.6rem] cursor-e-resize bg-primary z-50 flex items-center justify-center",onMouseDown:e=>B(e,t.id,"right"),children:(0,r.jsx)("div",{className:"w-[0.2rem] h-[1.5rem] bg-foreground/75 rounded-full"})})]})]})})}),(0,r.jsxs)(T.Ip,{className:"z-200",children:[(0,r.jsxs)(T.kt,{onClick:e=>{e.stopPropagation();let r=t.startTime,n=t.startTime+(t.duration-t.trimStart-t.trimEnd);C>r&&C<n?g(a.id,t.id,C)||D.oR.error("Failed to split element"):D.oR.error("Playhead must be within element to split")},children:[(0,r.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Split at playhead"]}),(0,r.jsxs)(T.kt,{onClick:e=>{if(e.stopPropagation(),E&&"media"===t.type)return void S(a.id,t.id);N(a.id,t.id)},children:[E?q?(0,r.jsx)(o.A,{className:"h-4 w-4 mr-2"}):(0,r.jsx)(z.A,{className:"h-4 w-4 mr-2"}):t.hidden?(0,r.jsx)(c.A,{className:"h-4 w-4 mr-2"}):(0,r.jsx)(F.A,{className:"h-4 w-4 mr-2"}),(0,r.jsxs)("span",{children:[E?q?"Unmute":"Mute":t.hidden?"Show":"Hide"," ","text"===t.type?"text":"clip"]})]}),(0,r.jsxs)(T.kt,{onClick:e=>{e.stopPropagation();let{id:r,...n}=t;v(a.id,{...n,name:t.name+" (copy)",startTime:t.startTime+(t.duration-t.trimStart-t.trimEnd)+.1})},children:[(0,r.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Duplicate ","text"===t.type?"text":"clip"]}),"media"===t.type&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(T.kt,{onClick:e=>{if(e.stopPropagation(),"media"!==t.type)return void D.oR.error("Reveal is only available for media clips");W(t.mediaId)},children:[(0,r.jsx)(_.A,{className:"h-4 w-4 mr-2"}),"Reveal in media"]}),(0,r.jsxs)(T.kt,{onClick:e=>{if(e.stopPropagation(),"media"!==t.type)return void D.oR.error("Replace is only available for media clips");let r=document.createElement("input");r.type="file",r.accept="video/*,audio/*,image/*",r.onchange=async e=>{var r;let n=null==(r=e.target.files)?void 0:r[0];if(n)try{let e=await j(a.id,t.id,n);e.success?D.oR.success("Clip replaced successfully"):D.oR.error(e.error||"Failed to replace clip")}catch(e){D.oR.error("Unexpected error: ".concat(e instanceof Error?e.message:"Unknown error"))}},r.click()},children:[(0,r.jsx)(O.A,{className:"h-4 w-4 mr-2"}),"Replace clip"]})]}),(0,r.jsx)(T.K5,{}),(0,r.jsxs)(T.kt,{onClick:e=>{e.stopPropagation(),w?h(a.id,t.id):f(a.id,t.id)},className:"text-destructive focus:text-destructive",children:[(0,r.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Delete ","text"===t.type?"text":"clip"]})]})]})}var V=a(14700);function W(e){let{track:t,zoomLevel:a,onSnapPointChange:n}=e,{mediaItems:i}=(0,A.B)(),{tracks:l,addTrack:s,moveElementToTrack:o,updateElementStartTime:c,updateElementStartTimeWithRipple:d,addElementToTrack:u,selectedElements:m,selectElement:f,dragState:h,startDrag:p,updateDragTime:x,endDrag:g,clearSelectedElements:v,insertTrackAt:j,snappingEnabled:y,rippleEditingEnabled:w}=(0,R.A)(),{currentTime:b}=(0,M.E)(),{snapElementPosition:N,snapElementEdge:S}=function(){let{snapThreshold:e=10,enableElementSnapping:t=!0,enablePlayheadSnapping:a=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,P.useCallback)((e,r,n,i,l)=>{let s=[];return t&&e.forEach(e=>{e.elements.forEach(t=>{if(t.id===l)return;let a=t.startTime,r=t.startTime+(t.duration-t.trimStart-t.trimEnd);s.push({time:a,type:"element-start",elementId:t.id,trackId:e.id},{time:r,type:"element-end",elementId:t.id,trackId:e.id})})}),a&&s.push({time:n,type:"playhead"}),s},[t,a]),n=(0,P.useCallback)((t,a,r)=>{let n=e/(H.of.PIXELS_PER_SECOND*r),i=null,l=1/0;return a.forEach(e=>{let a=Math.abs(t-e.time);a<n&&a<l&&(l=a,i=e)}),{snappedTime:i?i.time:t,snapPoint:i,snapDistance:l}},[e]);return{snapElementPosition:(0,P.useCallback)((e,t,a,i,l)=>{let s=r(t,e,a,i,l);return n(e,s,i)},[r,n]),snapElementEdge:(0,P.useCallback)(function(e,t,a,i,l,s){let o=!(arguments.length>6)||void 0===arguments[6]||arguments[6],c=r(a,e,i,l,s),d=n(o?e:e+t,c,l);return!o&&d.snapPoint&&(d.snappedTime=d.snappedTime-t),d},[r,n]),findSnapPoints:r,snapToNearestPoint:n}}({snapThreshold:10,enableElementSnapping:y,enablePlayheadSnapping:y}),C=(e,t,r)=>{var n;let i=(null==(n=I.Iw.getState().activeProject)?void 0:n.fps)||I.ge,s=(0,H.gY)(e,i);if(y){let n=S(e,t,l,b,a,r,!0),i=S(e,t,l,b,a,r,!1),o=n;i.snapPoint&&(!n.snapPoint||i.snapDistance<n.snapDistance)&&(o=i),o.snapPoint&&(s=o.snappedTime)}return s},k=(0,P.useRef)(null),[E,T]=(0,P.useState)(!1),[z,F]=(0,P.useState)(null),[_,O]=(0,P.useState)(!1),B=(0,P.useRef)(0),[U,$]=(0,P.useState)(null);(0,P.useEffect)(()=>{if(!h.isDragging)return;let e=e=>{var t;if(!k.current)return;h.elementId&&h.trackId&&(m.some(e=>e.trackId===h.trackId&&e.elementId===h.elementId)||f(h.trackId,h.elementId,!1));let r=k.current.getBoundingClientRect(),i=Math.max(0,Math.max(0,(e.clientX-r.left)/(H.of.PIXELS_PER_SECOND*a))-h.clickOffsetTime),s=(null==(t=I.Iw.getState().activeProject)?void 0:t.fps)||I.ge,o=(0,H.gY)(i,s),c=null;if(y){let e=5;if(h.elementId&&h.trackId){let t=l.find(e=>e.id===h.trackId),a=null==t?void 0:t.elements.find(e=>e.id===h.elementId);a&&(e=a.duration-a.trimStart-a.trimEnd)}let t=S(i,e,l,b,a,h.elementId||void 0,!0),r=S(i,e,l,b,a,h.elementId||void 0,!1),s=t;r.snapPoint&&(!t.snapPoint||r.snapDistance<t.snapDistance)&&(s=r),s.snapPoint&&(o=s.snappedTime,c=s.snapPoint),null==n||n(c)}else null==n||n(null);x(o)},r=e=>{var a;if(!h.elementId||!h.trackId)return;let r=h.trackId===t.id,i=null==(a=k.current)?void 0:a.getBoundingClientRect();if(!i){r&&(w?d(t.id,h.elementId,h.currentTime):c(t.id,h.elementId,h.currentTime),g(),null==n||n(null));return}let s=e.clientY>=i.top&&e.clientY<=i.bottom;if(!s&&!r)return;let u=h.currentTime;if(s){let e=l.find(e=>e.id===h.trackId),a=null==e?void 0:e.elements.find(e=>e.id===h.elementId);if(a){let e=u+(a.duration-a.trimStart-a.trimEnd),r=l.find(e=>e.id===t.id);(null==r?void 0:r.elements.some(a=>{if(h.trackId===t.id&&a.id===h.elementId)return!1;let r=a.startTime;return u<a.startTime+(a.duration-a.trimStart-a.trimEnd)&&e>r}))||(h.trackId===t.id?w?d(t.id,h.elementId,u):c(t.id,h.elementId,u):(o(h.trackId,t.id,h.elementId),requestAnimationFrame(()=>{w?d(t.id,h.elementId,u):c(t.id,h.elementId,u)})))}}else if(r){let e=l.find(e=>e.id===h.trackId),a=null==e?void 0:e.elements.find(e=>e.id===h.elementId);if(a){let e=u+(a.duration-a.trimStart-a.trimEnd);t.elements.some(t=>{if(t.id===h.elementId)return!1;let a=t.startTime;return u<t.startTime+(t.duration-t.trimStart-t.trimEnd)&&e>a})||(w?d(t.id,h.elementId,u):c(t.id,h.elementId,u))}}r&&(g(),null==n||n(null))};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",r)}},[h.isDragging,h.clickOffsetTime,h.elementId,h.trackId,h.currentTime,a,l,t.id,x,c,o,g,m,f,n]);let W=(e,r)=>{$({x:e.clientX,y:e.clientY});let n=2===e.button,i=e.metaKey||e.ctrlKey||e.shiftKey;if(n){m.some(e=>e.trackId===t.id&&e.elementId===r.id)||f(t.id,r.id,i);return}i&&f(t.id,r.id,!0);let l=e.currentTarget.getBoundingClientRect(),s=(e.clientX-l.left)/(H.of.PIXELS_PER_SECOND*a);p(r.id,t.id,e.clientX,r.startTime,s)},Y=(e,a)=>{if(e.stopPropagation(),U){let t=Math.abs(e.clientX-U.x),a=Math.abs(e.clientY-U.y);if(t>5||a>5)return void $(null)}e.metaKey||e.ctrlKey||e.shiftKey||m.some(e=>e.trackId===t.id&&e.elementId===a.id)||f(t.id,a.id,!1)};return(0,r.jsx)("div",{className:"w-full h-full hover:bg-muted/20",onClick:e=>{e.target.closest(".timeline-element")||v()},onDragOver:e=>{e.preventDefault();let r=e.dataTransfer.types.includes("application/x-timeline-element"),n=e.dataTransfer.types.includes("application/x-media-item");if(!r&&!n)return;let s=e.currentTarget.querySelector(".track-elements-container"),o=0;if(s){let t=s.getBoundingClientRect();o=Math.max(0,e.clientX-t.left)/(H.of.PIXELS_PER_SECOND*a)}let c=!1;if(n)try{let a=e.dataTransfer.getData("application/x-media-item");if(a){let e=JSON.parse(a);if("text"===e.type){let e=C(o,5),a=e+5;c=t.elements.some(t=>{let r=t.startTime,n=t.startTime+(t.duration-t.trimStart-t.trimEnd);return e<n&&a>r})}else{let a=i.find(t=>t.id===e.id);if(a){let e=a.duration||5,r=C(o,e),n=r+e;c=t.elements.some(e=>{let t=e.startTime,a=e.startTime+(e.duration-e.trimStart-e.trimEnd);return r<a&&n>t})}}}}catch(e){}else if(r)try{let a=e.dataTransfer.getData("application/x-timeline-element");if(a){let{elementId:e,trackId:r}=JSON.parse(a),n=l.find(e=>e.id===r),i=null==n?void 0:n.elements.find(t=>t.id===e);if(i){let a=i.duration-i.trimStart-i.trimEnd,n=C(o,a,e),l=n+a;c=t.elements.some(a=>{if(r===t.id&&a.id===e)return!1;let i=a.startTime,s=a.startTime+(a.duration-a.trimStart-a.trimEnd);return n<s&&l>i})}}}catch(e){}if(c){e.dataTransfer.dropEffect="none",O(!0),F(C(o,5));return}e.dataTransfer.dropEffect=r?"move":"copy",O(!1),F(C(o,5))},onDragEnter:e=>{e.preventDefault();let t=e.dataTransfer.types.includes("application/x-timeline-element"),a=e.dataTransfer.types.includes("application/x-media-item");(t||a)&&(B.current++,T(!0))},onDragLeave:e=>{e.preventDefault();let t=e.dataTransfer.types.includes("application/x-timeline-element"),a=e.dataTransfer.types.includes("application/x-media-item");(t||a)&&(B.current--,0===B.current&&(T(!1),O(!1),F(null)))},onDrop:e=>{var r,n;let m;e.preventDefault(),e.stopPropagation(),B.current=0,T(!1),O(!1);let f=e.dataTransfer.types.includes("application/x-timeline-element"),h=e.dataTransfer.types.includes("application/x-media-item"),p=(null==(r=e.dataTransfer.files)?void 0:r.length)>0;if(!f&&!h&&!p)return;let x=e.currentTarget.querySelector(".track-elements-container");if(!x)return;let g=x.getBoundingClientRect(),v=Math.max(0,e.clientX-g.left),y=e.clientY-g.top,N=v/(H.of.PIXELS_PER_SECOND*a),S=(null==(n=I.Iw.getState().activeProject)?void 0:n.fps)||I.ge;(0,H.gY)(N,S);let k=l.findIndex(e=>e.id===t.id);m=y<20?"above":y>40?"below":"on";try{if(f){let a=e.dataTransfer.getData("application/x-timeline-element");if(!a)return;let{elementId:r,trackId:n,clickOffsetTime:i=0}=JSON.parse(a),s=l.find(e=>e.id===n),u=null==s?void 0:s.elements.find(e=>e.id===r);if(!u)return void D.oR.error("Element not found");let m=u.duration-u.trimStart-u.trimEnd,f=N-i,h=C(f,m,r),p=Math.max(0,h),x=p+m;if(t.elements.some(e=>{if(n===t.id&&e.id===r)return!1;let a=e.startTime,i=e.startTime+(e.duration-e.trimStart-e.trimEnd);return p<i&&x>a}))return void D.oR.error("Cannot move element here - it would overlap with existing elements");n===t.id?w?d(t.id,r,p):c(t.id,r,p):(o(n,t.id,r),requestAnimationFrame(()=>{w?d(t.id,r,p):c(t.id,r,p)}))}else if(h){let a=e.dataTransfer.getData("application/x-media-item");if(!a)return;let r=JSON.parse(a);if("text"===r.type){let e=t.id,a=t;if("text"!==t.type||"on"!==m){let t,r=(0,V.xK)(l);t="above"===m?k:"below"===m?k+1:r?l.findIndex(e=>e.id===r.id):0,e=j("text",t);let n=R.A.getState().tracks.find(t=>t.id===e);if(!n)return;a=n}let n=C(N,5),i=n+5;if(a.elements.some(e=>{let t=e.startTime,a=e.startTime+(e.duration-e.trimStart-e.trimEnd);return n<a&&i>t}))return void D.oR.error("Cannot place element here - it would overlap with existing elements");u(e,{type:"text",name:r.name||"Text",content:r.content||"Default Text",duration:H.of.DEFAULT_TEXT_DURATION,startTime:n,trimStart:0,trimEnd:0,fontSize:48,fontFamily:"Arial",color:"#ffffff",backgroundColor:"transparent",textAlign:"center",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",x:0,y:0,rotation:0,opacity:1})}else{let e=i.find(e=>e.id===r.id);if(!e)return void D.oR.error("Media item not found");let a=t.id,n="video"===r.type||"image"===r.type,o="audio"===r.type,c=n?(0,V.hX)("media",t.type):!!o&&(0,V.hX)("media",t.type),d=l.find(e=>e.id===a);if(!c||"on"!==m){if(n){let e=(0,V.xK)(l);if(e)if(0===e.elements.length&&"on"===m)a=e.id,d=e;else{let t;t="above"===m?k:"below"===m?k+1:l.findIndex(t=>t.id===e.id),a=j("media",t);let r=R.A.getState().tracks.find(e=>e.id===a);if(!r)return;d=r}else{a=s("media");let e=R.A.getState().tracks.find(e=>e.id===a);if(!e)return;d=e}}else if(o){let e,t=(0,V.xK)(l);e="above"===m?k:"below"===m?k+1:t?l.findIndex(e=>e.id===t.id)+1:l.length,a=j("audio",e);let r=R.A.getState().tracks.find(e=>e.id===a);if(!r)return;d=r}}if(!d)return;let f=e.duration||5,h=C(N,f),p=h+f;if(d.elements.some(e=>{let t=e.startTime,a=e.startTime+(e.duration-e.trimStart-e.trimEnd);return h<a&&p>t}))return void D.oR.error("Cannot place element here - it would overlap with existing elements");u(a,{type:"media",mediaId:e.id,name:e.name,duration:e.duration||5,startTime:h,trimStart:0,trimEnd:0})}}else if(p){let{activeProject:t}=I.Iw.getState(),{addMediaItem:a}=A.B.getState(),{addElementToTrack:r}=R.A.getState();if(!t)return void D.oR.error("No active project");(0,L.T)(e.dataTransfer.files).then(async e=>{for(let n of e){await a(t.id,n);let e=A.B.getState().mediaItems.find(e=>e.name===n.name&&e.url===n.url);if(e){let t="audio"===e.type?"audio":"media",a=j(t,0);r(a,{type:"media",mediaId:e.id,name:e.name,duration:e.duration||5,startTime:b,trimStart:0,trimEnd:0})}}}).catch(e=>{D.oR.error("Failed to process dropped files")})}}catch(e){D.oR.error("Failed to add media to track")}},children:(0,r.jsx)("div",{ref:k,className:"h-full relative track-elements-container min-w-full",children:0===t.elements.length?(0,r.jsx)("div",{className:"h-full w-full rounded-sm border-2 border-dashed flex items-center justify-center text-xs text-muted-foreground transition-colors ".concat(E?_?"border-red-500 bg-red-500/10 text-red-600":"border-blue-500 bg-blue-500/10 text-blue-600":"border-muted/30"),children:E?_?"Cannot drop - would overlap":"Drop element here":""}):(0,r.jsx)(r.Fragment,{children:t.elements.map(e=>{let n=m.some(a=>a.trackId===t.id&&a.elementId===e.id);return(0,r.jsx)(X,{element:e,track:t,zoomLevel:a,isSelected:n,onElementMouseDown:W,onElementClick:Y},e.id)})})})})}function Y(e){let{currentTime:t,duration:a,zoomLevel:r,seek:n,rulerRef:i,rulerScrollRef:l,tracksScrollRef:s,playheadRef:o}=e,[c,d]=(0,P.useState)(!1),[u,m]=(0,P.useState)(null),[f,h]=(0,P.useState)(!1),[p,x]=(0,P.useState)(!1),g=(0,P.useRef)(null),v=(0,P.useRef)(0),j=c&&null!==u?u:t,y=(0,P.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),d(!0),b(e)},[a,r]),w=(0,P.useCallback)(e=>{var t;0===e.button&&(null!=o&&null!=(t=o.current)&&t.contains(e.target)||(e.preventDefault(),h(!0),x(!1),d(!0),b(e)))},[a,r]),b=(0,P.useCallback)(e=>{var t;let l=i.current;if(!l)return;let s=l.getBoundingClientRect(),o=e.clientX-s.left,c=Math.max(0,Math.min(50*a*r,o)),d=Math.max(0,Math.min(a,c/(50*r))),u=(null==(t=I.Iw.getState().activeProject)?void 0:t.fps)||I.ge,f=(0,H.gY)(d,u);m(f),n(f),v.current=e.clientX},[a,r,n,i]),N=(0,P.useCallback)(()=>{let e=l.current,t=s.current;if(!e||!t||!c)return;let n=e.getBoundingClientRect(),i=v.current-n.left,o=e.clientWidth,d=Math.max(0,50*a*r-o),u=0;if(i<100&&e.scrollLeft>0?u=-15*(1-Math.max(0,i)/100):i>o-100&&e.scrollLeft<d&&(u=15*(1-Math.max(0,o-100-i)/100)),0!==u){let a=Math.max(0,Math.min(d,e.scrollLeft+u));e.scrollLeft=a,t.scrollLeft=a}c&&(g.current=requestAnimationFrame(N))},[c,l,s,a,r]);return(0,P.useEffect)(()=>{if(!c)return;let e=e=>{b(e),f&&x(!0)},t=e=>{d(!1),null!==u&&n(u),m(null),g.current&&(cancelAnimationFrame(g.current),g.current=null),f&&(h(!1),p||b(e),x(!1))};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),g.current=requestAnimationFrame(N),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t),g.current&&(cancelAnimationFrame(g.current),g.current=null)}},[c,u,n,b,f,p,N]),(0,P.useEffect)(()=>{let{isPlaying:e}=M.E.getState();if(!e||c)return;let t=l.current,a=s.current;if(!t||!a)return;let n=50*j*r,i=t.clientWidth,o=t.scrollWidth-i;(n<t.scrollLeft||n>t.scrollLeft+i)&&(t.scrollLeft=a.scrollLeft=Math.max(0,Math.min(o,n-i/2)))},[j,a,r,l,s,c]),{playheadPosition:j,handlePlayheadMouseDown:y,handleRulerMouseDown:w,isDraggingRuler:f}}function Z(e){var t;let{currentTime:a,duration:n,zoomLevel:i,tracks:l,seek:s,rulerRef:o,rulerScrollRef:c,tracksScrollRef:d,trackLabelsRef:u,timelineRef:m,playheadRef:f,isSnappingToPlayhead:h=!1}=e,p=(0,P.useRef)(null),x=f||p,[g,v]=(0,P.useState)(0),{playheadPosition:j,handlePlayheadMouseDown:y}=Y({currentTime:a,duration:n,zoomLevel:i,seek:s,rulerRef:o,rulerScrollRef:c,tracksScrollRef:d,playheadRef:x});(0,P.useEffect)(()=>{let e=d.current;if(!e)return;let t=()=>{v(e.scrollLeft)};return v(e.scrollLeft),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[d]);let w=(null==(t=m.current)?void 0:t.offsetHeight)||400,b=l.length>0&&(null==u?void 0:u.current)?u.current.offsetWidth:0,N=b+j*H.of.PIXELS_PER_SECOND*i-g,S=n*H.of.PIXELS_PER_SECOND*i,C=d.current,k=Math.min(b+S-g,b+((null==C?void 0:C.clientWidth)||1e3)),E=Math.max(b,Math.min(k,N));return(0,r.jsxs)("div",{ref:x,className:"absolute pointer-events-auto z-40",style:{left:"".concat(E,"px"),top:0,height:"".concat(w-4,"px"),width:"2px"},onMouseDown:y,children:[(0,r.jsx)("div",{className:"absolute left-0 w-0.5 cursor-col-resize h-full ".concat("bg-foreground")}),(0,r.jsx)("div",{className:"absolute top-1 left-1/2 transform -translate-x-1/2 w-3 h-3 rounded-full border-2 shadow-xs ".concat(h?"bg-foreground border-foreground":"bg-foreground border-foreground/50")})]})}function K(e){let{startPos:t,currentPos:a,containerRef:n,isActive:i}=e,l=(0,P.useRef)(null);return((0,P.useEffect)(()=>{if(!i||!t||!a||!n.current)return;let e=n.current.getBoundingClientRect(),r=t.x-e.left,s=t.y-e.top,o=a.x-e.left,c=a.y-e.top,d=Math.min(r,o),u=Math.min(s,c),m=Math.abs(o-r),f=Math.abs(c-s);l.current&&(l.current.style.left="".concat(d,"px"),l.current.style.top="".concat(u,"px"),l.current.style.width="".concat(m,"px"),l.current.style.height="".concat(f,"px"))},[t,a,i,n]),i&&t&&a)?(0,r.jsx)("div",{ref:l,className:"absolute pointer-events-none z-50 bg-foreground/10"}):null}function G(e){var t;let{snapPoint:a,zoomLevel:n,isVisible:i,tracks:l,timelineRef:s,trackLabelsRef:o,tracksScrollRef:c}=e,[d,u]=(0,P.useState)(0);if((0,P.useEffect)(()=>{let e=c.current;if(!e)return;let t=()=>{u(e.scrollLeft)};return u(e.scrollLeft),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[c]),!i||!a)return null;let m=(null==(t=s.current)?void 0:t.offsetHeight)||400,f=l.length>0&&(null==o?void 0:o.current)?o.current.offsetWidth:0,h=a.time*H.of.PIXELS_PER_SECOND*n;return(0,r.jsx)("div",{className:"absolute pointer-events-none z-90",style:{left:"".concat(f+h-d,"px"),top:0,height:"".concat(m-8,"px"),width:"2px"},children:(0,r.jsx)("div",{className:"w-0.5 h-full bg-primary/40 opacity-80"})})}var q=a(14138),J=a(4600),Q=a(76386);function ee(){var e;let{tracks:t,getTotalDuration:a,clearSelectedElements:i,snappingEnabled:d,setSelectedElements:u,toggleTrackMute:m,dragState:f}=(0,R.A)(),{mediaItems:h,addMediaItem:p}=(0,A.B)(),{activeProject:x}=(0,I.Iw)(),{currentTime:g,duration:v,seek:j,setDuration:y,isPlaying:w,toggle:b}=(0,M.E)(),[N,S]=(0,P.useState)(!1),[C,k]=(0,P.useState)(!1),[E,z]=(0,P.useState)(0),F=(0,P.useRef)(0),_=(0,P.useRef)(null),O=(0,P.useRef)(null),[B,U]=(0,P.useState)(!1),$=(0,P.useRef)({isMouseDown:!1,downX:0,downY:0,downTime:0}),{zoomLevel:X,setZoomLevel:V,handleWheel:q}=function(e){let{containerRef:t,isInTimeline:a=!1}=e,[r,n]=(0,P.useState)(1),i=(0,P.useCallback)(e=>{if(e.ctrlKey||e.metaKey){e.preventDefault();let t=e.deltaY>0?-.15:.15;n(e=>Math.max(.1,Math.min(10,e+t)))}else if(e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY))return},[]);return(0,P.useEffect)(()=>{let e=e=>{var r;a&&(e.ctrlKey||e.metaKey)&&(null==(r=t.current)?void 0:r.contains(e.target))&&e.preventDefault()};return document.addEventListener("wheel",e,{passive:!1}),()=>{document.removeEventListener("wheel",e)}},[a,t]),{zoomLevel:r,setZoomLevel:n,handleWheel:i}}({containerRef:_,isInTimeline:B}),J=Math.max((v||0)*H.of.PIXELS_PER_SECOND*X,(g+30)*H.of.PIXELS_PER_SECOND*X,(null==(e=_.current)?void 0:e.clientWidth)||1e3),Q=(0,P.useRef)(null),ee=(0,P.useRef)(null),er=(0,P.useRef)(null),en=(0,P.useRef)(null),ei=(0,P.useRef)(null),el=(0,P.useRef)(!1),es=(0,P.useRef)(0),eo=(0,P.useRef)(0),ec=(0,P.useRef)(0),{handleRulerMouseDown:ed}=function(e){let{currentTime:t,duration:a,zoomLevel:r,seek:n,rulerRef:i,rulerScrollRef:l,tracksScrollRef:s,playheadRef:o}=e,{handleRulerMouseDown:c,isDraggingRuler:d}=Y({currentTime:t,duration:a,zoomLevel:r,seek:n,rulerRef:i,rulerScrollRef:l,tracksScrollRef:s,playheadRef:o});return{handleRulerMouseDown:c,isDraggingRuler:d}}({currentTime:g,duration:v,zoomLevel:X,seek:j,rulerRef:O,rulerScrollRef:Q,tracksScrollRef:ee,playheadRef:en}),eu=(0,P.useRef)(null),{selectionBox:em,handleMouseDown:ef,isSelecting:eh,justFinishedSelecting:ep}=function(e){let{containerRef:t,playheadRef:a,onSelectionComplete:r,isEnabled:n=!0}=e,[i,l]=(0,P.useState)(null),[s,o]=(0,P.useState)(!1),c=(0,P.useCallback)(e=>{var t;!(!n||e.target.closest(".timeline-element")||(null==a||null==(t=a.current)?void 0:t.contains(e.target))||e.target.closest("[data-track-labels]"))&&(e.target.closest("[data-ruler-area]")||l({startPos:{x:e.clientX,y:e.clientY},currentPos:{x:e.clientX,y:e.clientY},isActive:!1}))},[n,a]),d=(0,P.useCallback)((e,a)=>{if(!t.current)return;let n=t.current,i=n.getBoundingClientRect();e.x,i.left,e.y,i.top,a.x,i.left,a.y,i.top;let l=n.querySelectorAll(".timeline-element"),s=[];l.forEach(t=>{let r=t.getBoundingClientRect(),n={left:r.left,top:r.top,right:r.right,bottom:r.bottom},i={left:e.x,top:e.y,right:a.x,bottom:a.y},l={left:Math.min(i.left,i.right),top:Math.min(i.top,i.bottom),right:Math.max(i.left,i.right),bottom:Math.max(i.top,i.bottom)},o=t.getAttribute("data-element-id"),c=t.getAttribute("data-track-id");!(n.right<l.left||n.left>l.right||n.bottom<l.top||n.top>l.bottom)&&o&&c&&s.push({trackId:c,elementId:o})}),r(s)},[t,r]);return(0,P.useEffect)(()=>{if(!i)return;let e=e=>{let t=Math.abs(e.clientX-i.startPos.x),a=Math.abs(e.clientY-i.startPos.y),r={...i,currentPos:{x:e.clientX,y:e.clientY},isActive:t>5||a>5||i.isActive};l(r),r.isActive&&d(r.startPos,r.currentPos)},t=()=>{(null==i?void 0:i.isActive)&&(o(!0),setTimeout(()=>{o(!1)},50)),l(null)};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[i,d]),{selectionBox:i,handleMouseDown:c,isSelecting:(null==i?void 0:i.isActive)||!1,justFinishedSelecting:s}}({containerRef:eu,playheadRef:en,onSelectionComplete:e=>{u(e)}}),[ex,eg]=(0,P.useState)(null),ev=f.isDragging&&d&&null!==ex,ej=(0,P.useCallback)(e=>{eg(e)},[]),ey=(0,P.useCallback)(e=>{var t;let a=e.target;a.closest(".timeline-element")||(null==(t=en.current)?void 0:t.contains(a))||a.closest("[data-track-labels]")||($.current={isMouseDown:!0,downX:e.clientX,downY:e.clientY,downTime:e.timeStamp})},[]),ew=(0,P.useCallback)(e=>{var t;let a,{isMouseDown:r,downX:n,downY:l,downTime:s}=$.current;if($.current={isMouseDown:!1,downX:0,downY:0,downTime:0},!r)return;let o=Math.abs(e.clientX-n),c=Math.abs(e.clientY-l),d=e.timeStamp-s;if(o>5||c>5||d>500||eh||ep||e.target.closest(".timeline-element")||(null==(t=en.current)?void 0:t.contains(e.target)))return;if(e.target.closest("[data-track-labels]"))return void i();i();let u=e.target.closest("[data-ruler-area]"),m=0;if(u){let t=Q.current;if(!t)return;let r=t.getBoundingClientRect();a=e.clientX-r.left,m=t.scrollLeft}else{let t=ee.current;if(!t)return;let r=t.getBoundingClientRect();a=e.clientX-r.left,m=t.scrollLeft}let f=Math.max(0,Math.min(v,(a+m)/(H.of.PIXELS_PER_SECOND*X))),h=(null==x?void 0:x.fps)||30;j((0,H.gY)(f,h))},[v,X,j,Q,ee,i,eh,ep]);(0,P.useEffect)(()=>{y(Math.max(a(),10))},[t,y,a]);let eb=async e=>{var t;if(e.preventDefault(),S(!1),F.current=0,e.dataTransfer.types.includes("application/x-timeline-element"))return;let a=e.dataTransfer.getData("application/x-media-item");if(a)try{let e=JSON.parse(a);if("text"===e.type)R.A.getState().addTextToNewTrack(e);else{let t=h.find(t=>t.id===e.id);if(!t)return void D.oR.error("Media item not found");R.A.getState().addMediaToNewTrack(t)}}catch(e){D.oR.error("Failed to add item to timeline")}else if((null==(t=e.dataTransfer.files)?void 0:t.length)>0){if(!x)return void D.oR.error("No active project");k(!0),z(0);try{for(let t of(await (0,L.T)(e.dataTransfer.files,e=>z(e)))){await p(x.id,t);let e=A.B.getState().mediaItems.find(e=>e.name===t.name&&e.url===t.url);if(e){let t="audio"===e.type?"audio":"media",a=R.A.getState().insertTrackAt(t,0);R.A.getState().addElementToTrack(a,{type:"media",mediaId:e.id,name:e.name,duration:e.duration||5,startTime:g,trimStart:0,trimEnd:0})}}}catch(e){D.oR.error("Failed to process dropped files")}finally{k(!1),z(0)}}};return(0,P.useEffect)(()=>{let e=Q.current,t=ee.current,a=ei.current;if(!e||!t)return;let r=()=>{let a=Date.now();el.current||a-es.current<16||(es.current=a,el.current=!0,t.scrollLeft=e.scrollLeft,el.current=!1)},n=()=>{let a=Date.now();el.current||a-eo.current<16||(eo.current=a,el.current=!0,e.scrollLeft=t.scrollLeft,el.current=!1)};if(e.addEventListener("scroll",r),t.addEventListener("scroll",n),a){let i=()=>{let e=Date.now();el.current||e-ec.current<16||(ec.current=e,el.current=!0,t.scrollTop=a.scrollTop,el.current=!1)},l=()=>{let e=Date.now();el.current||e-ec.current<16||(ec.current=e,el.current=!0,a.scrollTop=t.scrollTop,el.current=!1)};return a.addEventListener("scroll",i),t.addEventListener("scroll",l),()=>{e.removeEventListener("scroll",r),t.removeEventListener("scroll",n),a.removeEventListener("scroll",i),t.removeEventListener("scroll",l)}}return()=>{e.removeEventListener("scroll",r),t.removeEventListener("scroll",n)}},[]),(0,r.jsxs)("div",{className:"h-full flex flex-col transition-colors duration-200 relative bg-panel rounded-sm overflow-hidden",...{onDragEnter:e=>{e.preventDefault(),!e.dataTransfer.types.includes("application/x-timeline-element")&&(F.current+=1,N||S(!0))},onDragOver:e=>{e.preventDefault()},onDragLeave:e=>{e.preventDefault(),e.dataTransfer.types.includes("application/x-timeline-element")||(F.current-=1,0===F.current&&S(!1))},onDrop:eb},onMouseEnter:()=>U(!0),onMouseLeave:()=>U(!1),children:[(0,r.jsx)(ea,{zoomLevel:X,setZoomLevel:V}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden relative",ref:_,children:[(0,r.jsx)(Z,{currentTime:g,duration:v,zoomLevel:X,tracks:t,seek:j,rulerRef:O,rulerScrollRef:Q,tracksScrollRef:ee,trackLabelsRef:er,timelineRef:_,playheadRef:en,isSnappingToPlayhead:ev&&(null==ex?void 0:ex.type)==="playhead"}),(0,r.jsx)(G,{snapPoint:ex,zoomLevel:X,tracks:t,timelineRef:_,trackLabelsRef:er,tracksScrollRef:ee,isVisible:ev}),(0,r.jsxs)("div",{className:"flex bg-panel sticky top-0 z-10",children:[(0,r.jsx)("div",{className:"w-28 shrink-0 bg-panel border-r flex items-center justify-between px-3 py-2",children:(0,r.jsx)("span",{className:"text-sm font-medium text-muted-foreground opacity-0",children:"."})}),(0,r.jsx)("div",{className:"flex-1 relative overflow-hidden h-10",onWheel:e=>{e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY)||q(e)},onMouseDown:ef,onClick:ew,"data-ruler-area":!0,children:(0,r.jsx)(n.F,{className:"w-full",ref:Q,children:(0,r.jsxs)("div",{ref:O,className:"relative h-10 select-none cursor-default",style:{width:"".concat(J,"px")},onMouseDown:ed,children:[(()=>{let e=(e=>{let t=H.of.PIXELS_PER_SECOND*e;return t>=200?.1:t>=100?.5:t>=50?1:t>=25?2:t>=12?5:t>=6?10:30})(X);return Array.from({length:Math.ceil(v/e)+1},(t,a)=>{let n=a*e;if(n>v)return null;let i=n%(e>=1?Math.max(1,e):1)==0;return(0,r.jsx)("div",{className:"absolute top-0 h-4 ".concat(i?"border-l border-muted-foreground/40":"border-l border-muted-foreground/20"),style:{left:"".concat(n*H.of.PIXELS_PER_SECOND*X,"px")},children:(0,r.jsx)("span",{className:"absolute top-1 left-1 text-[0.6rem] ".concat(i?"text-muted-foreground font-medium":"text-muted-foreground/70"),children:(()=>{let t=Math.floor(n/3600),a=Math.floor(n%3600/60),r=n%60;return t>0?"".concat(t,":").concat(a.toString().padStart(2,"0"),":").concat(Math.floor(r).toString().padStart(2,"0")):a>0?"".concat(a,":").concat(Math.floor(r).toString().padStart(2,"0")):e>=1?"".concat(Math.floor(r),"s"):"".concat(r.toFixed(1),"s")})()})},a)}).filter(Boolean)})(),(()=>{var e;let{activeProject:t}=I.Iw.getState();return(null==t||null==(e=t.bookmarks)?void 0:e.length)?t.bookmarks.map((e,t)=>(0,r.jsx)("div",{className:"absolute top-0 h-10 w-0.5 !bg-primary cursor-pointer",style:{left:"".concat(e*H.of.PIXELS_PER_SECOND*X,"px")},onClick:t=>{t.stopPropagation(),M.E.getState().seek(e)},children:(0,r.jsx)("div",{className:"absolute top-[-1px] left-[-5px] text-primary",children:(0,r.jsx)(l.A,{className:"h-3 w-3 fill-primary"})})},"bookmark-".concat(t))):null})()]})})})]}),(0,r.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[t.length>0&&(0,r.jsx)("div",{ref:er,className:"w-28 shrink-0 border-r overflow-y-auto z-100 bg-panel","data-track-labels":!0,children:(0,r.jsx)(n.F,{className:"w-full h-full",ref:ei,children:(0,r.jsx)("div",{className:"flex flex-col gap-1",children:t.map(e=>(0,r.jsx)("div",{className:"flex items-center px-3 group",style:{height:"".concat((0,H.t_)(e.type),"px")},children:(0,r.jsxs)("div",{className:"flex items-center justify-end flex-1 min-w-0 gap-2",children:[e.muted?(0,r.jsx)(s.A,{className:"h-4 w-4 text-destructive cursor-pointer",onClick:()=>m(e.id)}):(0,r.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground cursor-pointer",onClick:()=>m(e.id)}),(0,r.jsx)(c.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)(et,{track:e})]})},e.id))})})}),(0,r.jsxs)("div",{className:"flex-1 relative overflow-hidden",onWheel:e=>{e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY)||q(e)},onMouseDown:e=>{ey(e),ef(e)},onClick:ew,ref:eu,children:[(0,r.jsx)(K,{startPos:(null==em?void 0:em.startPos)||null,currentPos:(null==em?void 0:em.currentPos)||null,containerRef:eu,isActive:(null==em?void 0:em.isActive)||!1}),(0,r.jsx)(n.F,{className:"w-full h-full",ref:ee,children:(0,r.jsx)("div",{className:"relative flex-1",style:{height:"".concat(Math.max(200,Math.min(800,(0,H.Ij)(t))),"px"),width:"".concat(J,"px")},children:0===t.length?(0,r.jsx)("div",{}):(0,r.jsx)(r.Fragment,{children:t.map((e,a)=>(0,r.jsxs)(T.tz,{children:[(0,r.jsx)(T.Rc,{asChild:!0,children:(0,r.jsx)("div",{className:"absolute left-0 right-0",style:{top:"".concat((0,H.sn)(t,a),"px"),height:"".concat((0,H.t_)(e.type),"px")},onClick:e=>{e.target.closest(".timeline-element")||i()},children:(0,r.jsx)(W,{track:e,zoomLevel:X,onSnapPointChange:ej})})}),(0,r.jsxs)(T.Ip,{className:"z-200",children:[(0,r.jsx)(T.kt,{onClick:t=>{t.stopPropagation(),m(e.id)},children:e.muted?"Unmute Track":"Mute Track"}),(0,r.jsx)(T.kt,{onClick:e=>e.stopPropagation(),children:"Track settings (soon)"})]})]},e.id))})})})]})]})]})]})}function et(e){let{track:t}=e;return(0,r.jsxs)(r.Fragment,{children:["media"===t.type&&(0,r.jsx)(d.A,{className:"w-4 h-4 shrink-0 text-muted-foreground"}),"text"===t.type&&(0,r.jsx)(u.A,{className:"w-4 h-4 shrink-0 text-muted-foreground"}),"audio"===t.type&&(0,r.jsx)(m.A,{className:"w-4 h-4 shrink-0 text-muted-foreground"})]})}function ea(e){var t;let{zoomLevel:a,setZoomLevel:n}=e,{tracks:s,addTrack:o,addElementToTrack:c,removeElementFromTrack:d,removeElementFromTrackWithRipple:u,selectedElements:m,clearSelectedElements:T,splitElement:A,splitAndKeepLeft:P,splitAndKeepRight:L,separateAudio:z,snappingEnabled:F,toggleSnapping:_,rippleEditingEnabled:O,toggleRippleEditing:B}=(0,R.A)(),{currentTime:U,duration:$,isPlaying:X,toggle:V,seek:W}=(0,M.E)(),{toggleBookmark:Y,isBookmarked:Z,activeProject:K}=(0,I.Iw)(),G=async()=>{await Y(U)},ee=Z(U);return(0,r.jsxs)("div",{className:"border-b flex items-center justify-between px-2 py-1",children:[(0,r.jsx)("div",{className:"flex items-center gap-1 w-full",children:(0,r.jsxs)(E.Bc,{delayDuration:500,children:[(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:V,className:"mr-2",children:X?(0,r.jsx)(f.A,{className:"h-4 w-4"}):(0,r.jsx)(h.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:X?"Pause (Space)":"Play (Space)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:()=>W(0),className:"mr-2",children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Return to Start (Home / Enter)"})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,r.jsxs)("div",{className:"flex flex-row items-center justify-center px-2",children:[(0,r.jsx)(Q.P,{time:U,duration:$,format:"HH:MM:SS:FF",fps:null!=(t=null==K?void 0:K.fps)?t:I.ge,onTimeChange:W,className:"text-center"}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground font-mono px-2",children:"/"}),(0,r.jsx)("div",{className:"text-xs text-muted-foreground font-mono text-center",children:(0,J.s6)($,"HH:MM:SS:FF")})]}),0===s.length&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>{c(o("media"),{type:"media",mediaId:"test",name:"Test Clip",duration:H.of.DEFAULT_TEXT_DURATION,startTime:0,trimStart:0,trimEnd:0})},className:"text-xs",children:"Add Test Clip"})}),(0,r.jsx)(E.ZI,{children:"Add a test clip to try playback"})]})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:()=>{if(0===m.length)return;let e=0;m.forEach(t=>{let{trackId:a,elementId:r}=t,n=s.find(e=>e.id===a),i=null==n?void 0:n.elements.find(e=>e.id===r);if(i&&n){let t=i.startTime,n=i.startTime+(i.duration-i.trimStart-i.trimEnd);U>t&&U<n&&A(a,r,U)&&e++}}),0===e&&D.oR.error("Playhead must be within selected elements to split")},children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Split element (Ctrl+S)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:()=>{if(1!==m.length)return void D.oR.error("Select exactly one element");let{trackId:e,elementId:t}=m[0],a=s.find(t=>t.id===e),r=null==a?void 0:a.elements.find(e=>e.id===t);if(!r)return;let n=r.startTime,i=r.startTime+(r.duration-r.trimStart-r.trimEnd);if(U<=n||U>=i)return void D.oR.error("Playhead must be within selected element");P(e,t,U)},children:(0,r.jsx)(g.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Split and keep left (Ctrl+Q)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:()=>{if(1!==m.length)return void D.oR.error("Select exactly one element");let{trackId:e,elementId:t}=m[0],a=s.find(t=>t.id===e),r=null==a?void 0:a.elements.find(e=>e.id===t);if(!r)return;let n=r.startTime,i=r.startTime+(r.duration-r.trimStart-r.trimEnd);if(U<=n||U>=i)return void D.oR.error("Playhead must be within selected element");L(e,t,U)},children:(0,r.jsx)(v.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Split and keep right (Ctrl+W)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:()=>{if(1!==m.length)return void D.oR.error("Select exactly one media element to separate audio");let{trackId:e,elementId:t}=m[0],a=s.find(t=>t.id===e);if(!a||"media"!==a.type)return void D.oR.error("Select a media element to separate audio");z(e,t)},children:(0,r.jsx)(j.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Separate audio (Ctrl+D)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:()=>{0!==m.length&&1===m.length&&(m.forEach(e=>{let{trackId:t,elementId:a}=e,r=s.find(e=>e.id===t),n=null==r?void 0:r.elements.find(e=>e.id===a);if(n){let e=n.startTime+(n.duration-n.trimStart-n.trimEnd)+.1,{id:a,...r}=n;c(t,{...r,startTime:e})}}),T())},children:(0,r.jsx)(y.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Duplicate element (Ctrl+D)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:()=>{D.oR.info("Freeze frame functionality coming soon!")},children:(0,r.jsx)(w.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Freeze frame (F)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:()=>{0!==m.length&&(m.forEach(e=>{let{trackId:t,elementId:a}=e;O?u(t,a):d(t,a)}),T())},children:(0,r.jsx)(b.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Delete element (Delete)"})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:G,children:(0,r.jsx)(l.A,{className:"h-4 w-4 ".concat(ee?"fill-primary text-primary":"")})})}),(0,r.jsx)(E.ZI,{children:ee?"Remove bookmark":"Add bookmark"})]})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)(E.Bc,{delayDuration:500,children:[(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:_,children:F?(0,r.jsx)(N.A,{className:"h-4 w-4 text-primary"}):(0,r.jsx)(N.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Auto snapping"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:B,children:(0,r.jsx)(S.A,{className:"h-4 w-4 ".concat(O?"text-primary":"")})})}),(0,r.jsx)(E.ZI,{children:O?"Disable Ripple Editing":"Enable Ripple Editing"})]})]}),(0,r.jsx)("div",{className:"h-6 w-px bg-border mx-1"}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:()=>{n(Math.max(.25,a-.25))},children:(0,r.jsx)(C.A,{className:"h-4 w-4"})}),(0,r.jsx)(q.A,{className:"w-24",value:[a],onValueChange:e=>{n(e[0])},min:.25,max:4,step:.25}),(0,r.jsx)(i.$,{variant:"text",size:"icon",onClick:()=>{n(Math.min(4,a+.25))},children:(0,r.jsx)(k.A,{className:"h-4 w-4"})})]})]})]})}},8435:(e,t,a)=>{a.d(t,{z:()=>j});var r=a(28064),n=a(74188),i=a(26880),l=a(75141);class s{subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}emit(e){this.listeners.forEach(t=>t(e))}constructor(){this.listeners=[]}}let o=new s,c={};function d(){let e=Object.keys(c);o.emit(e)}function u(e,t){if(c[e]){var a;null==(a=c[e])||a.push(t)}else c[e]=[t];d()}function m(e,t){var a,r;c[e]=null==(a=c[e])?void 0:a.filter(e=>e!==t),(null==(r=c[e])?void 0:r.length)===0&&delete c[e],d()}function f(e,t,a){let r=(0,n.useRef)(t),[i,l]=(0,n.useState)(!1);(0,n.useEffect)(()=>{r.current=t},[t]);let s=(0,n.useCallback)((e,t)=>{r.current(e,t)},[]);(0,n.useEffect)(()=>{let t=void 0===a||("boolean"==typeof a?a:a.current);return t&&!i?(u(e,s),l(!0)):!t&&i&&(m(e,s),l(!1)),()=>{i&&(m(e,s),l(!1))}},[e,s,a,i]),(0,n.useEffect)(()=>{if(a&&"object"==typeof a&&"current"in a){let t=setInterval(()=>{let t=a.current;t!==i&&(t?u(e,s):m(e,s),l(t))},100);return()=>clearInterval(t)}},[e,s,a,i])}var h=a(13893),p=a(91685),x=a(81925),g=a(82337),v=a(61557);function j(e){let{children:t}=e,{isInitializing:a,isPanelsReady:s,initializeApp:o}=(0,l.U)(),{disableKeybindings:d,enableKeybindings:u}=function(){let{disableKeybindings:e,enableKeybindings:t}=(0,h.y)();return{disableKeybindings:e,enableKeybindings:t}}(),{tracks:m,selectedElements:j,clearSelectedElements:y,setSelectedElements:w,removeElementFromTrack:b,splitElement:N,addElementToTrack:S,snappingEnabled:C,toggleSnapping:k,undo:E,redo:T}=(0,p.A)(),{currentTime:R,duration:A,isPlaying:M,toggle:I,seek:P}=(0,x.E)(),{activeProject:L}=(0,g.Iw)();f("toggle-play",()=>{I()},void 0),f("stop-playback",()=>{M&&I(),P(0)},void 0),f("seek-forward",e=>{var t;P(Math.min(A,R+(null!=(t=null==e?void 0:e.seconds)?t:1)))},void 0),f("seek-backward",e=>{var t;P(Math.max(0,R-(null!=(t=null==e?void 0:e.seconds)?t:1)))},void 0),f("frame-step-forward",()=>{P(Math.min(A,R+1/((null==L?void 0:L.fps)||g.ge)))},void 0),f("frame-step-backward",()=>{P(Math.max(0,R-1/((null==L?void 0:L.fps)||g.ge)))},void 0),f("jump-forward",e=>{var t;P(Math.min(A,R+(null!=(t=null==e?void 0:e.seconds)?t:5)))},void 0),f("jump-backward",e=>{var t;P(Math.max(0,R-(null!=(t=null==e?void 0:e.seconds)?t:5)))},void 0),f("goto-start",()=>{P(0)},void 0),f("goto-end",()=>{P(A)},void 0),f("split-element",()=>{if(1!==j.length)return void v.oR.error("Select exactly one element to split");let{trackId:e,elementId:t}=j[0],a=m.find(t=>t.id===e),r=null==a?void 0:a.elements.find(e=>e.id===t);if(r){let a=r.startTime,n=r.startTime+(r.duration-r.trimStart-r.trimEnd);R>a&&R<n?N(e,t,R):v.oR.error("Playhead must be within selected element")}},void 0),f("delete-selected",()=>{0!==j.length&&(j.forEach(e=>{let{trackId:t,elementId:a}=e;b(t,a)}),y())},void 0),f("select-all",()=>{w(m.flatMap(e=>e.elements.map(t=>({trackId:e.id,elementId:t.id}))))},void 0),f("duplicate-selected",()=>{if(1!==j.length)return void v.oR.error("Select exactly one element to duplicate");let{trackId:e,elementId:t}=j[0],a=m.find(t=>t.id===e),r=null==a?void 0:a.elements.find(e=>e.id===t);if(r){let t=r.startTime+(r.duration-r.trimStart-r.trimEnd)+.1,{id:a,...n}=r;S(e,{...n,startTime:t})}},void 0),f("toggle-snapping",()=>{k()},void 0),f("undo",()=>{E()},void 0),f("redo",()=>{T()},void 0);let{keybindings:D,getKeybindingString:z,keybindingsEnabled:F,isRecording:_}=(0,h.y)();return((0,n.useEffect)(()=>{let e=e=>{let t;if(!F||_)return;let a=z(e);if(!a)return;let r=D[a];if(!r)return;let n=document.activeElement;if(!(n&&("INPUT"===n.tagName||"TEXTAREA"===n.tagName||n.isContentEditable))){var i,l;e.preventDefault(),"seek-forward"===r||"seek-backward"===r?t={seconds:1}:"jump-forward"===r?t={seconds:5}:"jump-backward"===r&&(t={seconds:5}),i=t,null==(l=c[r])||l.forEach(e=>e(i,"keypress"))}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[D,z,F,_]),(0,n.useEffect)(()=>{a||!s?d():u()},[a,s,d,u]),(0,n.useEffect)(()=>{o()},[o]),a||!s)?(0,r.jsx)("div",{className:"h-screen w-screen flex items-center justify-center bg-background",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)(i.A,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading editor..."})]})}):(0,r.jsx)(r.Fragment,{children:t})}},9466:(e,t,a)=>{a.d(t,{v:()=>l});var r=a(59467),n=a(20159);let i={default:{toolsPanel:25,previewPanel:50,propertiesPanel:25,mainContent:70,timeline:30},media:{toolsPanel:30,previewPanel:45,propertiesPanel:25,mainContent:100,timeline:25},inspector:{toolsPanel:30,previewPanel:70,propertiesPanel:30,mainContent:75,timeline:25},"vertical-preview":{toolsPanel:30,previewPanel:40,propertiesPanel:30,mainContent:75,timeline:25}},l=(0,r.v)()((0,n.Zr)((e,t)=>({...i.default,activePreset:"default",presetCustomSizes:{default:{},media:{},inspector:{},"vertical-preview":{}},resetCounter:0,mediaViewMode:"grid",setToolsPanel:a=>{let{activePreset:r,presetCustomSizes:n}=t();e({toolsPanel:a,presetCustomSizes:{...n,[r]:{...n[r],toolsPanel:a}}})},setPreviewPanel:a=>{let{activePreset:r,presetCustomSizes:n}=t();e({previewPanel:a,presetCustomSizes:{...n,[r]:{...n[r],previewPanel:a}}})},setPropertiesPanel:a=>{let{activePreset:r,presetCustomSizes:n}=t();e({propertiesPanel:a,presetCustomSizes:{...n,[r]:{...n[r],propertiesPanel:a}}})},setMainContent:a=>{let{activePreset:r,presetCustomSizes:n}=t();e({mainContent:a,presetCustomSizes:{...n,[r]:{...n[r],mainContent:a}}})},setTimeline:a=>{let{activePreset:r,presetCustomSizes:n}=t();e({timeline:a,presetCustomSizes:{...n,[r]:{...n[r],timeline:a}}})},setMediaViewMode:t=>e({mediaViewMode:t}),setActivePreset:a=>{let{activePreset:r,presetCustomSizes:n,toolsPanel:l,previewPanel:s,propertiesPanel:o,mainContent:c,timeline:d}=t(),u={...n,[r]:{toolsPanel:l,previewPanel:s,propertiesPanel:o,mainContent:c,timeline:d}},m=i[a],f=u[a]||{};e({activePreset:a,presetCustomSizes:u,...m,...f})},resetPreset:a=>{let{presetCustomSizes:r,activePreset:n,resetCounter:l}=t(),s=i[a],o={presetCustomSizes:{...r,[a]:{}},resetCounter:l+1};a===n&&Object.assign(o,s),e(o)},getCurrentPresetSizes:()=>{let{toolsPanel:e,previewPanel:a,propertiesPanel:r,mainContent:n,timeline:i}=t();return{toolsPanel:e,previewPanel:a,propertiesPanel:r,mainContent:n,timeline:i}}}),{name:"panel-sizes"}))},10952:(e,t,a)=>{a.d(t,{F:()=>l});var r=a(28064),n=a(74188),i=a(93146);let l=n.forwardRef((e,t)=>{let{className:a,children:n,...l}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("overflow-auto scrollbar-thin",a),...l,children:n})});l.displayName="ScrollArea"},12131:(e,t,a)=>{a.d(t,{x:()=>$});var r=a(28064),n=a(91685),i=a(80196),l=a(81925),s=a(75141),o=a(74188);function c(e){let{src:t,poster:a,className:n="",clipStartTime:i,trimStart:s,trimEnd:c,clipDuration:d,trackMuted:u=!1}=e,m=(0,o.useRef)(null),{isPlaying:f,currentTime:h,volume:p,speed:x,muted:g}=(0,l.E)(),v=i+(d-s-c),j=h>=i&&h<v;return(0,o.useEffect)(()=>{let e=m.current;if(!e||!j)return;let t=t=>{e.currentTime=Math.max(s,Math.min(d-c,t.detail.time-i+s))},a=t=>{let a=Math.max(s,Math.min(d-c,t.detail.time-i+s));Math.abs(e.currentTime-a)>.5&&(e.currentTime=a)},r=t=>{e.playbackRate=t.detail.speed};return window.addEventListener("playback-seek",t),window.addEventListener("playback-update",a),window.addEventListener("playback-speed",r),()=>{window.removeEventListener("playback-seek",t),window.removeEventListener("playback-update",a),window.removeEventListener("playback-speed",r)}},[i,s,c,d,j]),(0,o.useEffect)(()=>{let e=m.current;e&&(f&&j?e.play().catch(()=>{}):e.pause())},[f,j]),(0,o.useEffect)(()=>{let e=m.current;e&&(e.volume=p,e.muted=g||u,e.playbackRate=x)},[p,x,g,u]),(0,r.jsx)("video",{ref:m,src:t,poster:a,className:"max-w-full max-h-full object-contain ".concat(n),playsInline:!0,preload:"auto",controls:!1,disablePictureInPicture:!0,disableRemotePlayback:!0,style:{pointerEvents:"none"},onContextMenu:e=>e.preventDefault()})}function d(e){let{src:t,className:a="",clipStartTime:n,trimStart:i,trimEnd:s,clipDuration:c,trackMuted:d=!1}=e,u=(0,o.useRef)(null),{isPlaying:m,currentTime:f,volume:h,speed:p,muted:x}=(0,l.E)(),g=n+(c-i-s),v=f>=n&&f<g;return(0,o.useEffect)(()=>{let e=u.current;if(!e||!v)return;let t=t=>{e.currentTime=Math.max(i,Math.min(c-s,t.detail.time-n+i))},a=t=>{let a=Math.max(i,Math.min(c-s,t.detail.time-n+i));Math.abs(e.currentTime-a)>.5&&(e.currentTime=a)},r=t=>{e.playbackRate=t.detail.speed};return window.addEventListener("playback-seek",t),window.addEventListener("playback-update",a),window.addEventListener("playback-speed",r),()=>{window.removeEventListener("playback-seek",t),window.removeEventListener("playback-update",a),window.removeEventListener("playback-speed",r)}},[n,i,s,c,v]),(0,o.useEffect)(()=>{let e=u.current;e&&(m&&v&&!d?e.play().catch(()=>{}):e.pause())},[m,v,d]),(0,o.useEffect)(()=>{let e=u.current;e&&(e.volume=h,e.muted=x||d,e.playbackRate=p)},[h,p,x,d]),(0,r.jsx)("audio",{ref:u,src:t,className:a,preload:"auto",controls:!1,style:{display:"none"},onContextMenu:e=>e.preventDefault()})}var u=a(61309),m=a(62243),f=a(45440),h=a(47888),p=a(76085),x=a(34802),g=a(93146),v=a(4600),j=a(76386),y=a(13746),w=a.n(y),b=a(19947),N=a.n(b),S=a(82189),C=a.n(S),k=a(93237),E=a.n(k),T=a(53322),R=a.n(T);let A={Inter:w().className,Roboto:N().className,"Open Sans":C().className,"Playfair Display":E().className,"Comic Neue":R().className,Arial:"",Helvetica:"","Times New Roman":"",Georgia:""};w(),N(),C(),E(),R();var M=a(82337),I=a(91554);let P=I.Root,L=I.Trigger;I.Anchor;let D=o.forwardRef((e,t)=>{let{className:a,align:n="center",sideOffset:i=4,...l}=e;return(0,r.jsx)(I.Portal,{children:(0,r.jsx)(I.Content,{ref:t,align:n,sideOffset:i,className:(0,g.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-hidden data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})})});D.displayName=I.Content.displayName;var z=a(14446),F=a(3532),_=a(30461);function O(){return(0,r.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:(0,r.jsx)(_.default,{src:(0,F.h)("/platform-guides/tiktok-blueprint.png"),alt:"TikTok layout guide",className:"absolute inset-0 w-full h-full object-contain",draggable:!1,fill:!0})})}function B(){let{layoutGuide:e}=(0,s.U)();return null===e.platform?null:"tiktok"===e.platform?(0,r.jsx)(O,{}):null}var U=a(25777),H=a(81310);function $(){let{tracks:e,getTotalDuration:t,updateTextElement:a}=(0,n.A)(),{mediaItems:s}=(0,i.B)(),{currentTime:u,toggle:m,setCurrentTime:f}=(0,l.E)(),{activeProject:h}=(0,M.Iw)(),p=(0,o.useRef)(null),x=(0,o.useRef)(null),[g,v]=(0,o.useState)({width:0,height:0}),[j,y]=(0,o.useState)(!1),w=(null==h?void 0:h.canvasSize)||M.lm,[b,N]=(0,o.useState)({isDragging:!1,elementId:null,trackId:null,startX:0,startY:0,initialElementX:0,initialElementY:0,currentX:0,currentY:0,elementWidth:0,elementHeight:0});(0,o.useEffect)(()=>{let e=()=>{let e,t,a,r;if(!x.current)return;if(j)e=window.innerWidth-24,t=window.innerHeight-80-24;else{let a=x.current.getBoundingClientRect(),r=getComputedStyle(x.current),n=parseFloat(r.paddingTop),i=parseFloat(r.paddingBottom),l=parseFloat(r.paddingLeft),s=parseFloat(r.paddingRight),o=parseFloat(r.gap)||16,c=x.current.querySelector("[data-toolbar]"),d=c?c.getBoundingClientRect().height:0;e=a.width-l-s,t=a.height-n-i-d-(d>0?o:0)}let n=w.width/w.height;e/t>n?a=(r=t*(j?.95:1))*n:r=(a=e*(j?.95:1))/n,v({width:a,height:r})};e();let t=new ResizeObserver(e);return x.current&&t.observe(x.current),j&&window.addEventListener("resize",e),()=>{t.disconnect(),j&&window.removeEventListener("resize",e)}},[w.width,w.height,j]),(0,o.useEffect)(()=>{let e=e=>{"Escape"===e.key&&j&&y(!1)};return j?(document.addEventListener("keydown",e),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.removeEventListener("keydown",e),document.body.style.overflow=""}},[j]),(0,o.useEffect)(()=>{let e=e=>{if(!b.isDragging)return;let t=e.clientX-b.startX,a=e.clientY-b.startY,r=g.width/w.width,n=b.initialElementX+t/r,i=b.initialElementY+a/r,l=b.elementWidth/r/2,s=b.elementHeight/r/2,o=Math.max(-w.width/2+l,Math.min(w.width/2-l,n)),c=Math.max(-w.height/2+s,Math.min(w.height/2-s,i));N(e=>({...e,currentX:o,currentY:c}))},t=()=>{b.isDragging&&b.trackId&&b.elementId&&a(b.trackId,b.elementId,{x:b.currentX,y:b.currentY}),N(e=>({...e,isDragging:!1}))};return b.isDragging&&(document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),document.body.style.cursor="grabbing",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.body.style.cursor="",document.body.style.userSelect=""}},[b,g,w,a]);let S=(0,o.useCallback)(()=>{y(e=>!e)},[]),C=e.some(e=>e.elements.length>0),k=(()=>{let t=[];return[...e].reverse().forEach(e=>{e.elements.forEach(a=>{if(a.hidden)return;let r=a.startTime,n=a.startTime+(a.duration-a.trimStart-a.trimEnd);if(u>=r&&u<n){let r=null;"media"===a.type&&(r="test"===a.mediaId?null:s.find(e=>e.id===a.mediaId)||null),t.push({element:a,track:e,mediaItem:r})}})}),t})(),E=k.filter(e=>{let{element:t,mediaItem:a}=e;return"media"===t.type&&a&&("video"===a.type||"image"===a.type)&&"test"!==t.mediaId}),T=()=>{if(!(null==h?void 0:h.backgroundType)||"blur"!==h.backgroundType||0===E.length)return null;let{element:e,mediaItem:t}=E[0];if(!t)return null;let a=h.blurIntensity||8;return"video"===t.type?(0,r.jsx)("div",{className:"absolute inset-0 overflow-hidden",style:{filter:"blur(".concat(a,"px)"),transform:"scale(1.1)",transformOrigin:"center"},children:(0,r.jsx)(c,{src:t.url,poster:t.thumbnailUrl,clipStartTime:e.startTime,trimStart:e.trimStart,trimEnd:e.trimEnd,clipDuration:e.duration,className:"w-full h-full object-cover",trackMuted:!0})},"blur-".concat(e.id)):"image"===t.type?(0,r.jsx)("div",{className:"absolute inset-0 overflow-hidden",style:{filter:"blur(".concat(a,"px)"),transform:"scale(1.1)",transformOrigin:"center"},children:(0,r.jsx)("img",{src:t.url,alt:t.name,className:"w-full h-full object-cover",draggable:!1})},"blur-".concat(e.id)):null},R=(e,t)=>{let{element:a,mediaItem:n}=e;if("text"===a.type){let n=A[a.fontFamily]||"",i=g.width/w.width;return(0,r.jsx)("div",{className:"absolute cursor-grab",onMouseDown:t=>((e,t,a)=>{e.preventDefault(),e.stopPropagation();let r=e.currentTarget.getBoundingClientRect();N({isDragging:!0,elementId:t.id,trackId:a,startX:e.clientX,startY:e.clientY,initialElementX:t.x,initialElementY:t.y,currentX:t.x,currentY:t.y,elementWidth:r.width,elementHeight:r.height})})(t,a,e.track.id),style:{left:"".concat(50+(b.isDragging&&b.elementId===a.id?b.currentX:a.x)/w.width*100,"%"),top:"".concat(50+(b.isDragging&&b.elementId===a.id?b.currentY:a.y)/w.height*100,"%"),transform:"translate(-50%, -50%) rotate(".concat(a.rotation,"deg)"),opacity:a.opacity,zIndex:100+t},children:(0,r.jsx)("div",{className:n,style:{fontSize:"".concat(a.fontSize*i,"px"),color:a.color,backgroundColor:a.backgroundColor,textAlign:a.textAlign,fontWeight:a.fontWeight,fontStyle:a.fontStyle,textDecoration:a.textDecoration,padding:"".concat(4*i,"px ").concat(8*i,"px"),borderRadius:"".concat(2*i,"px"),whiteSpace:"nowrap",...""===n&&{fontFamily:a.fontFamily}},children:a.content})},a.id)}if("media"===a.type){if(!n||"test"===a.mediaId)return(0,r.jsx)("div",{className:"absolute inset-0 bg-linear-to-br from-blue-500/20 to-purple-500/20 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-2",children:"\uD83C\uDFAC"}),(0,r.jsx)("p",{className:"text-xs text-foreground",children:a.name})]})},a.id);if("video"===n.type)return(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)(c,{src:n.url,poster:n.thumbnailUrl,clipStartTime:a.startTime,trimStart:a.trimStart,trimEnd:a.trimEnd,clipDuration:a.duration,trackMuted:a.muted||e.track.muted})},a.id);if("image"===n.type)return(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("img",{src:n.url,alt:n.name,className:"max-w-full max-h-full object-contain",draggable:!1})},a.id);if("audio"===n.type)return(0,r.jsx)("div",{className:"absolute inset-0",style:{pointerEvents:"none"},children:(0,r.jsx)(d,{src:n.url,clipStartTime:a.startTime,trimStart:a.trimStart,trimEnd:a.trimEnd,clipDuration:a.duration,trackMuted:a.muted||e.track.muted})},a.id)}return null};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"h-full w-full flex flex-col min-h-0 min-w-0 bg-panel rounded-sm relative",children:(0,r.jsxs)("div",{ref:x,className:"flex-1 flex flex-col items-center justify-center min-h-0 min-w-0",children:[(0,r.jsx)("div",{className:"flex-1"}),C?(0,r.jsxs)("div",{ref:p,className:"relative overflow-hidden border",style:{width:g.width,height:g.height,background:(null==h?void 0:h.backgroundType)==="blur"?"transparent":(null==h?void 0:h.backgroundColor)||"#000000"},children:[T(),0===k.length?(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-muted-foreground",children:"No elements at current time"}):k.map((e,t)=>R(e,t)),(0,r.jsx)(B,{})]}):null,(0,r.jsx)("div",{className:"flex-1"}),(0,r.jsx)(W,{hasAnyElements:C,onToggleExpanded:S,isExpanded:j,currentTime:u,setCurrentTime:f,toggle:m,getTotalDuration:t})]})}),j&&(0,r.jsx)(V,{previewDimensions:g,activeProject:h,renderBlurBackground:T,activeElements:k,renderElement:R,blurBackgroundElements:E,hasAnyElements:C,toggleExpanded:S,currentTime:u,setCurrentTime:f,toggle:m,getTotalDuration:t})]})}function X(e){let{hasAnyElements:t,onToggleExpanded:a,currentTime:n,setCurrentTime:i,toggle:s,getTotalDuration:c}=e,{isPlaying:d,seek:y}=(0,l.E)(),{activeProject:w}=(0,M.Iw)(),[b,N]=(0,o.useState)(!1),S=c(),C=S>0?n/S*100:0;return(0,r.jsxs)("div",{"data-toolbar":!0,className:"flex items-center gap-2 p-1 pt-2 w-full text-foreground relative",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-[0.70rem] tabular-nums text-foreground/90",children:[(0,r.jsx)(j.P,{time:n,duration:S,format:"HH:MM:SS:FF",fps:(null==w?void 0:w.fps)||M.ge,onTimeChange:y,disabled:!t,className:"text-foreground/90 hover:bg-white/10"}),(0,r.jsx)("span",{className:"opacity-50",children:"/"}),(0,r.jsx)("span",{children:(0,v.s6)(S,"HH:MM:SS:FF",(null==w?void 0:w.fps)||M.ge)})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(u.$,{variant:"text",size:"icon",onClick:()=>{i(Math.max(0,n-1))},disabled:!t,className:"h-auto p-0 text-foreground",title:"Skip backward 1s",children:(0,r.jsx)(m.A,{className:"h-3 w-3"})}),(0,r.jsx)(u.$,{variant:"text",size:"icon",onClick:s,disabled:!t,className:"h-auto p-0 text-foreground hover:text-foreground/80",children:d?(0,r.jsx)(f.A,{className:"h-3 w-3"}):(0,r.jsx)(h.A,{className:"h-3 w-3"})}),(0,r.jsx)(u.$,{variant:"text",size:"icon",onClick:()=>{i(Math.min(S,n+1))},disabled:!t,className:"h-auto p-0 text-foreground hover:text-foreground/80",title:"Skip forward 1s",children:(0,r.jsx)(p.A,{className:"h-3 w-3"})})]}),(0,r.jsx)("div",{className:"flex-1 flex items-center gap-2",children:(0,r.jsxs)("div",{className:(0,g.cn)("relative h-1 rounded-full cursor-pointer flex-1 bg-foreground/20",!t&&"opacity-50 cursor-not-allowed"),onClick:t?e=>{if(!t)return;let a=e.currentTarget.getBoundingClientRect();i(Math.max(0,Math.min(Math.max(0,Math.min(1,(e.clientX-a.left)/a.width))*S,S)))}:void 0,onMouseDown:t?e=>{if(!t)return;e.preventDefault(),e.stopPropagation();let a=e.currentTarget.getBoundingClientRect();N(!0);let r=e=>{e.preventDefault(),i(Math.max(0,Math.min(Math.max(0,Math.min(1,(e.clientX-a.left)/a.width))*S,S)))},n=()=>{N(!1),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",n),document.body.style.userSelect=""};document.body.style.userSelect="none",document.addEventListener("mousemove",r),document.addEventListener("mouseup",n),r(e.nativeEvent)}:void 0,style:{userSelect:"none"},children:[(0,r.jsx)("div",{className:(0,g.cn)("absolute top-0 left-0 h-full rounded-full bg-foreground",!b&&"duration-100"),style:{width:"".concat(C,"%")}}),(0,r.jsx)("div",{className:"absolute top-1/2 w-3 h-3 rounded-full -translate-y-1/2 -translate-x-1/2 shadow-xs bg-foreground border border-black/20",style:{left:"".concat(C,"%")}})]})}),(0,r.jsx)(u.$,{variant:"text",size:"icon",className:"size-4! text-foreground/80 hover:text-foreground",onClick:a,title:"Exit fullscreen (Esc)",children:(0,r.jsx)(x.A,{className:"size-4!"})})]})}function V(e){let{previewDimensions:t,activeProject:a,renderBlurBackground:n,activeElements:i,renderElement:l,blurBackgroundElements:s,hasAnyElements:o,toggleExpanded:c,currentTime:d,setCurrentTime:u,toggle:m,getTotalDuration:f}=e;return(0,r.jsxs)("div",{className:"fixed inset-0 z-9999 flex flex-col",children:[(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center bg-background",children:(0,r.jsxs)("div",{className:"relative overflow-hidden border border-border m-3",style:{width:t.width,height:t.height,background:(null==a?void 0:a.backgroundType)==="blur"?"#1a1a1a":(null==a?void 0:a.backgroundColor)||"#1a1a1a"},children:[n(),0===i.length?(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white/60",children:"No elements at current time"}):i.map((e,t)=>l(e,t)),(0,r.jsx)(B,{})]})}),(0,r.jsx)("div",{className:"p-4 bg-background",children:(0,r.jsx)(X,{hasAnyElements:o,onToggleExpanded:c,currentTime:d,setCurrentTime:u,toggle:m,getTotalDuration:f})})]})}function W(e){let{hasAnyElements:t,onToggleExpanded:a,isExpanded:n,currentTime:i,setCurrentTime:o,toggle:c,getTotalDuration:d}=e,{isPlaying:m}=(0,l.E)(),{layoutGuide:p,toggleLayoutGuide:g}=(0,s.U)();return n?(0,r.jsx)(X,{hasAnyElements:t,onToggleExpanded:a,currentTime:i,setCurrentTime:o,toggle:c,getTotalDuration:d}):(0,r.jsx)("div",{"data-toolbar":!0,className:"flex justify-end gap-2 h-auto pb-5 pr-5 pt-4 w-full",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(u.$,{variant:"text",size:"icon",onClick:c,disabled:!t,className:"h-auto p-0",children:m?(0,r.jsx)(f.A,{className:"h-3 w-3"}):(0,r.jsx)(h.A,{className:"h-3 w-3"})}),(0,r.jsxs)(P,{children:[(0,r.jsx)(L,{asChild:!0,children:(0,r.jsx)(u.$,{variant:"text",size:"icon",className:"h-auto p-0 mr-1",title:"Toggle layout guide",children:(0,r.jsx)(H.YE,{className:"!size-6"})})}),(0,r.jsx)(D,{className:"w-80",children:(0,r.jsxs)("div",{className:"grid gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h4",{className:"font-medium leading-none",children:"Layout guide"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Show platform-specific layout guides to help align your content with interface elements like profile pictures, usernames, and interaction buttons."})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(z.S,{id:"none",checked:null===p.platform,onCheckedChange:()=>g(p.platform||"tiktok")}),(0,r.jsx)(U.J,{htmlFor:"none",children:"None"})]}),Object.entries(s.Y).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(z.S,{id:t,checked:p.platform===t,onCheckedChange:()=>g(t)}),(0,r.jsx)(U.J,{htmlFor:t,children:a})]},t)})]})]})})]}),(0,r.jsx)(u.$,{variant:"text",size:"icon",className:"size-4!",onClick:a,title:"Enter fullscreen",children:(0,r.jsx)(x.A,{className:"size-4!"})})]})})}},13893:(e,t,a)=>{a.d(t,{y:()=>s});var r=a(59467),n=a(20159),i=a(93146);let l={space:"toggle-play",j:"seek-backward",k:"toggle-play",l:"seek-forward",left:"frame-step-backward",right:"frame-step-forward","shift+left":"jump-backward","shift+right":"jump-forward",home:"goto-start",enter:"goto-start",end:"goto-end",s:"split-element",n:"toggle-snapping","ctrl+a":"select-all","ctrl+d":"duplicate-selected","ctrl+z":"undo","ctrl+shift+z":"redo","ctrl+y":"redo",delete:"delete-selected",backspace:"delete-selected"},s=(0,r.v)()((0,n.Zr)((e,t)=>({keybindings:{...l},isCustomized:!1,keybindingsEnabled:!0,isRecording:!1,updateKeybinding:(t,a)=>{e(e=>{let r={...e.keybindings};return r[t]=a,{keybindings:r,isCustomized:!0}})},removeKeybinding:t=>{e(e=>{let a={...e.keybindings};return delete a[t],{keybindings:a,isCustomized:!0}})},resetToDefaults:()=>{e({keybindings:{...l},isCustomized:!1})},enableKeybindings:()=>{e({keybindingsEnabled:!0})},disableKeybindings:()=>{e({keybindingsEnabled:!1})},importKeybindings:t=>{for(let[e,a]of Object.entries(t))if("string"!=typeof e||0===e.length)throw Error("Invalid key format: ".concat(e));e({keybindings:{...t},isCustomized:!0})},exportKeybindings:()=>t().keybindings,validateKeybinding:(e,a)=>{let{keybindings:r}=t(),n=r[e];return n&&n!==a?{key:e,existingAction:n,newAction:a}:null},setIsRecording:t=>{e({isRecording:t})},getKeybindingsForAction:e=>{let{keybindings:a}=t();return Object.keys(a).filter(t=>a[t]===e)},getKeybindingString:e=>(function(e){let t=e.target,a=function(e){let t={ctrl:(0,i.lg)()?e.metaKey:e.ctrlKey,alt:e.altKey,shift:e.shiftKey},a=Object.keys(t).filter(e=>t[e]).join("+");return""===a?null:a}(e),r=function(e){var t,a;let r=(null!=(t=e.key)?t:"").toLowerCase(),n=null!=(a=e.code)?a:"";if(r.startsWith("arrow"))return r.slice(5);if("tab"===r)return"tab";if(" "===r||"space"===r)return"space";if("home"===r)return"home";if("end"===r)return"end";if("delete"===r)return"delete";if("backspace"===r)return"backspace";if(n.startsWith("Key")){let e=n.slice(3).toLowerCase();if(1===e.length&&e>="a"&&e<="z")return e}if(n.startsWith("Digit")){let e=n.slice(5);if(1===e.length&&e>="0"&&e<="9")return e}return 1===r.length&&r>="0"&&r<="9"||"/"===r||"."===r||"enter"===r?r:null}(e);return r?a?"shift"===a&&(0,i.Fe)(t)&&(0,i.mr)(t)?null:"".concat(a,"+").concat(r):(0,i.Fe)(t)&&(0,i.mr)(t)?null:"".concat(r):null})(e)}),{name:"opencut-keybindings",version:1}))},14138:(e,t,a)=>{a.d(t,{A:()=>s});var r=a(28064),n=a(74188),i=a(39124),l=a(93146);let s=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsxs)(i.Root,{ref:t,className:(0,l.cn)("relative flex w-full touch-none select-none items-center",a),...n,children:[(0,r.jsx)(i.Track,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:(0,r.jsx)(i.Range,{className:"absolute h-full bg-primary"})}),(0,r.jsx)(i.Thumb,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow-sm transition-colors focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]})});s.displayName=i.Root.displayName},15467:(e,t,a)=>{a.d(t,{H:()=>i});var r=a(28064),n=a(93146);function i(e){let{leftContent:t,centerContent:a,rightContent:i,className:l,children:s}=e;return s?(0,r.jsx)("header",{className:(0,n.cn)("px-6 h-16 flex items-center",l),children:s}):(0,r.jsxs)("header",{className:(0,n.cn)("px-6 h-14 flex justify-between items-center",l),children:[t&&(0,r.jsx)("div",{className:"flex items-center",children:t}),a&&(0,r.jsx)("div",{className:"flex items-center",children:a}),i&&(0,r.jsx)("div",{className:"flex items-center",children:i})]})}},25777:(e,t,a)=>{a.d(t,{J:()=>c});var r=a(28064),n=a(74188),i=a(20605),l=a(24827),s=a(93146);let o=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(i.Root,{ref:t,className:(0,s.cn)(o(),a),...n})});c.displayName=i.Root.displayName},30187:(e,t,a)=>{a.d(t,{E:()=>N});var r=a(28064),n=a(80196),i=a(91685),l=a(10952);function s(e){let{element:t}=e;return(0,r.jsx)("div",{className:"space-y-4 p-5",children:"Audio properties"})}function o(e){let{element:t}=e;return(0,r.jsx)("div",{className:"space-y-4 p-5",children:"Media properties"})}var c=a(74188),d=a(93146);let u=c.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("textarea",{className:(0,d.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-base shadow-xs placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-0 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-xs",a),ref:t,...n})});u.displayName="Textarea";var m=a(52801);let f=[{value:"Arial",label:"Arial",category:"system",hasClassName:!1},{value:"Helvetica",label:"Helvetica",category:"system",hasClassName:!1},{value:"Times New Roman",label:"Times New Roman",category:"system",hasClassName:!1},{value:"Georgia",label:"Georgia",category:"system",hasClassName:!1},{value:"Inter",label:"Inter",category:"google",weights:[400,700],hasClassName:!0},{value:"Roboto",label:"Roboto",category:"google",weights:[400,700],hasClassName:!0},{value:"Open Sans",label:"Open Sans",category:"google",hasClassName:!0},{value:"Playfair Display",label:"Playfair Display",category:"google",hasClassName:!0},{value:"Comic Neue",label:"Comic Neue",category:"google",hasClassName:!1}];function h(e){let{defaultValue:t,onValueChange:a,className:n}=e;return(0,r.jsxs)(m.l6,{defaultValue:t,onValueChange:a,children:[(0,r.jsx)(m.bq,{className:"w-full text-xs ".concat(n||""),children:(0,r.jsx)(m.yv,{placeholder:"Select a font"})}),(0,r.jsx)(m.gC,{children:f.map(e=>(0,r.jsx)(m.eb,{value:e.value,className:"text-xs",style:{fontFamily:e.value},children:e.label},e.value))})]})}var p=a(14138),x=a(84843),g=a(61309),v=a(38155);let j=c.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(v.Root,{className:(0,d.cn)("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-xs transition-colors focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",a),...n,ref:t,children:(0,r.jsx)(v.Thumb,{className:(0,d.cn)("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})});j.displayName=v.Root.displayName;var y=a(34248);function w(e){let{element:t,trackId:a}=e,{updateTextElement:n}=(0,i.A)(),[l,s]=(0,c.useState)(t.fontSize.toString()),[o,d]=(0,c.useState)(Math.round(100*t.opacity).toString()),m=(0,c.useRef)("#000000"),f=(e,t,a,r)=>{let n=parseInt(e,10);return isNaN(n)?r:Math.max(t,Math.min(a,n))};return(0,r.jsxs)("div",{className:"space-y-6 p-5",children:[(0,r.jsx)(u,{placeholder:"Name",defaultValue:t.content,className:"min-h-18 resize-none bg-background/50",onChange:e=>n(a,t.id,{content:e.target.value})}),(0,r.jsxs)(y.DC,{direction:"row",children:[(0,r.jsx)(y.Tq,{children:"Font"}),(0,r.jsx)(y.Wg,{children:(0,r.jsx)(h,{defaultValue:t.fontFamily,onValueChange:e=>n(a,t.id,{fontFamily:e})})})]}),(0,r.jsxs)(y.DC,{direction:"column",children:[(0,r.jsxs)(y.DC,{direction:"row",children:[(0,r.jsx)(y.Tq,{children:"Style"}),(0,r.jsx)(y.Wg,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(g.$,{variant:"bold"===t.fontWeight?"default":"outline",size:"sm",onClick:()=>n(a,t.id,{fontWeight:"bold"===t.fontWeight?"normal":"bold"}),className:"h-8 px-3 font-bold",children:"B"}),(0,r.jsx)(g.$,{variant:"italic"===t.fontStyle?"default":"outline",size:"sm",onClick:()=>n(a,t.id,{fontStyle:"italic"===t.fontStyle?"normal":"italic"}),className:"h-8 px-3 italic",children:"I"}),(0,r.jsx)(g.$,{variant:"underline"===t.textDecoration?"default":"outline",size:"sm",onClick:()=>n(a,t.id,{textDecoration:"underline"===t.textDecoration?"none":"underline"}),className:"h-8 px-3 underline",children:"U"}),(0,r.jsx)(g.$,{variant:"line-through"===t.textDecoration?"default":"outline",size:"sm",onClick:()=>n(a,t.id,{textDecoration:"line-through"===t.textDecoration?"none":"line-through"}),className:"h-8 px-3 line-through",children:"S"})]})})]}),(0,r.jsx)(y.Tq,{children:"Font size"}),(0,r.jsx)(y.Wg,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(p.A,{value:[t.fontSize],min:8,max:300,step:1,onValueChange:e=>{let[r]=e;n(a,t.id,{fontSize:r}),s(r.toString())},className:"w-full"}),(0,r.jsx)(x.p,{type:"number",value:l,min:8,max:300,onChange:e=>(e=>{if(s(e),""!==e.trim()){let r=f(e,8,300,t.fontSize);n(a,t.id,{fontSize:r})}})(e.target.value),onBlur:()=>{let e=f(l,8,300,t.fontSize);s(e.toString()),n(a,t.id,{fontSize:e})},className:"w-12 !text-xs h-7 rounded-sm text-center   [appearance:textfield]   [&::-webkit-outer-spin-button]:appearance-none   [&::-webkit-inner-spin-button]:appearance-none"})]})})]}),(0,r.jsxs)(y.DC,{direction:"row",children:[(0,r.jsx)(y.Tq,{children:"Color"}),(0,r.jsx)(y.Wg,{children:(0,r.jsx)(x.p,{type:"color",value:t.color||"#ffffff",onChange:e=>{let r=e.target.value;n(a,t.id,{color:r})},className:"w-full cursor-pointer rounded-full"})})]}),(0,r.jsxs)(y.DC,{direction:"column",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(y.Tq,{children:"Background"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(j,{id:"transparent-bg-toggle",checked:"transparent"===t.backgroundColor,onCheckedChange:e=>{let r=e?"transparent":m.current;n(a,t.id,{backgroundColor:r})}}),(0,r.jsx)("label",{htmlFor:"transparent-bg-toggle",className:"text-sm font-medium",children:"Transparent"})]})]}),(0,r.jsx)(y.Wg,{children:(0,r.jsx)(x.p,{type:"color",value:"transparent"===t.backgroundColor?m.current:t.backgroundColor||"#000000",onChange:e=>{var r;"transparent"!==(r=e.target.value)&&(m.current=r),n(a,t.id,{backgroundColor:r})},className:"w-full cursor-pointer rounded-full",disabled:"transparent"===t.backgroundColor})})]}),(0,r.jsxs)(y.DC,{direction:"column",children:[(0,r.jsx)(y.Tq,{children:"Opacity"}),(0,r.jsx)(y.Wg,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(p.A,{value:[100*t.opacity],min:0,max:100,step:1,onValueChange:e=>{let[r]=e;n(a,t.id,{opacity:r/100}),d(r.toString())},className:"w-full"}),(0,r.jsx)(x.p,{type:"number",value:o,min:0,max:100,onChange:e=>(e=>{if(d(e),""!==e.trim()){let r=f(e,0,100,Math.round(100*t.opacity));n(a,t.id,{opacity:r/100})}})(e.target.value),onBlur:()=>{let e=f(o,0,100,Math.round(100*t.opacity));d(e.toString()),n(a,t.id,{opacity:e/100})},className:"w-12 !text-xs h-7 rounded-sm text-center   [appearance:textfield]   [&::-webkit-outer-spin-button]:appearance-none   [&::-webkit-inner-spin-button]:appearance-none"})]})})]})]})}var b=a(24565);function N(){let{selectedElements:e,tracks:t}=(0,i.A)(),{mediaItems:a}=(0,n.B)();return(0,r.jsx)(r.Fragment,{children:e.length>0?(0,r.jsx)(l.F,{className:"h-full bg-panel rounded-sm",children:e.map(e=>{let{trackId:n,elementId:i}=e,l=t.find(e=>e.id===n),c=null==l?void 0:l.elements.find(e=>e.id===i);if((null==c?void 0:c.type)==="text")return(0,r.jsx)("div",{children:(0,r.jsx)(w,{element:c,trackId:n})},i);if((null==c?void 0:c.type)==="media"){let e=a.find(e=>e.id===c.mediaId);return(null==e?void 0:e.type)==="audio"?(0,r.jsx)(s,{element:c},i):(0,r.jsx)("div",{children:(0,r.jsx)(o,{element:c})},i)}return null})}):(0,r.jsx)(S,{})})}function S(){return(0,r.jsxs)("div",{className:"bg-panel h-full p-4 flex flex-col items-center justify-center gap-3",children:[(0,r.jsx)(b.A,{className:"w-10 h-10 text-muted-foreground",strokeWidth:1.5}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 text-center",children:[(0,r.jsx)("p",{className:"text-lg font-medium",children:"It’s empty here"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-balance",children:"Click an element on the timeline to edit its properties"})]})]})}},31872:(e,t,a)=>{a.d(t,{W:()=>d});var r=a(28064),n=a(61309),i=a(84843),l=a(65803),s=a(90254),o=a(37797),c=a(74188);function d(e){let{isExpanded:t,setIsExpanded:a,placeholder:d="Search anything",value:u,onChange:m}=e,[f,h]=(0,c.useState)(null),[p,x]=(0,c.useState)(-60),g={duration:.35,ease:[.25,.1,.25,1]};return(0,c.useEffect)(()=>{f&&x(-f.getBoundingClientRect().left-48)},[f]),(0,r.jsxs)("div",{ref:h,className:"relative w-full",children:[(0,r.jsx)(o.P.div,{className:"absolute left-0 top-1/2 -translate-y-1/2 cursor-pointer hover:opacity-75 transition-opacity z-10",initial:{x:t?0:p,opacity:t?1:.5},animate:{x:t?0:p,opacity:t?1:.5},transition:g,onClick:()=>a(!t),children:(0,r.jsx)(n.$,{variant:"outline",className:"!size-9 rounded-full bg-panel-accent",children:(0,r.jsx)(l.A,{})})}),(0,r.jsx)("div",{className:"relative flex-1",style:{marginLeft:"0px",paddingLeft:"0px"},children:(0,r.jsxs)(o.P.div,{className:"relative",initial:{marginLeft:50*!!t},animate:{marginLeft:50*!!t},transition:g,children:[(0,r.jsx)(s.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(i.p,{placeholder:d,className:"pl-9 bg-panel-accent w-full",value:u,onChange:e=>null==m?void 0:m(e.target.value)})]})})]})}},34248:(e,t,a)=>{a.d(t,{DC:()=>s,Tq:()=>o,Wg:()=>c,Zf:()=>d});var r=a(28064),n=a(93146),i=a(90320),l=a(74188);function s(e){let{direction:t="row",children:a,className:i}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex gap-2","row"===t?"items-center justify-between gap-6":"flex-col gap-1.5",i),children:a})}function o(e){let{children:t,className:a}=e;return(0,r.jsx)("label",{className:(0,n.cn)("text-xs text-muted-foreground",a),children:t})}function c(e){let{children:t,className:a}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex-1 text-sm",a),children:t})}function d(e){let{title:t,children:a,defaultExpanded:d=!0,className:u}=e,[m,f]=(0,l.useState)(d);return(0,r.jsxs)(s,{direction:"column",className:(0,n.cn)("gap-3",u),children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5 cursor-pointer",onClick:()=>f(!m),children:[(0,r.jsx)(o,{className:"cursor-pointer",children:t}),(0,r.jsx)(i.A,{className:(0,n.cn)("size-3",!m&&"-rotate-90")})]}),m&&(0,r.jsx)(c,{children:a})]})}},34828:(e,t,a)=>{a.d(t,{X:()=>ea});var r=a(28064),n=a(61309),i=a(90320),l=a(65803),s=a(80647),o=a(23392),c=a(27940),d=a(15467),u=a(82337),m=a(30651),f=a(74188),h=a(61557),p=a(13893),x=a(93146);let g={"toggle-play":{description:"Play/Pause",category:"Playback"},"stop-playback":{description:"Stop playback",category:"Playback"},"seek-forward":{description:"Seek forward 1 second",category:"Playback"},"seek-backward":{description:"Seek backward 1 second",category:"Playback"},"frame-step-forward":{description:"Frame step forward",category:"Navigation"},"frame-step-backward":{description:"Frame step backward",category:"Navigation"},"jump-forward":{description:"Jump forward 5 seconds",category:"Navigation"},"jump-backward":{description:"Jump backward 5 seconds",category:"Navigation"},"goto-start":{description:"Go to timeline start",category:"Navigation"},"goto-end":{description:"Go to timeline end",category:"Navigation"},"split-element":{description:"Split element at playhead",category:"Editing"},"delete-selected":{description:"Delete selected elements",category:"Editing"},"select-all":{description:"Select all elements",category:"Selection"},"duplicate-selected":{description:"Duplicate selected element",category:"Selection"},"toggle-snapping":{description:"Toggle snapping",category:"Editing"},undo:{description:"Undo",category:"History"},redo:{description:"Redo",category:"History"}};var v=a(66981);function j(){let[e,t]=(0,f.useState)(!1),[a,i]=(0,f.useState)(null),{updateKeybinding:l,removeKeybinding:s,getKeybindingString:o,validateKeybinding:c,getKeybindingsForAction:d,setIsRecording:u,resetToDefaults:j,isRecording:w}=(0,p.y)(),{shortcuts:b}=(()=>{let{keybindings:e}=(0,p.y)();return{shortcuts:(0,f.useMemo)(()=>{let t=[],a={};return Object.entries(e).forEach(e=>{let[t,r]=e;r&&(a[r]||(a[r]=[]),a[r].push(t.replace("ctrl",(0,x.C7)()).replace("alt",(0,x.bT)()).replace("shift","Shift").replace("left","←").replace("right","→").replace("up","↑").replace("down","↓").replace("space","Space").replace("home","Home").replace("enter","Enter").replace("end","End").replace("delete","Delete").replace("backspace","Backspace").replace("-","+")))}),Object.entries(a).forEach(e=>{let[a,r]=e,n=g[a];n&&t.push({id:a,keys:r,description:n.description,category:n.category,action:a})}),t.sort((e,t)=>e.category!==t.category?e.category.localeCompare(t.category):e.description.localeCompare(t.description))},[e])}})(),N=Array.from(new Set(b.map(e=>e.category)));(0,f.useEffect)(()=>{if(!w||!a)return;let e=e=>{e.preventDefault(),e.stopPropagation();let t=o(e);if(t){let e=c(t,a.action);if(e){h.oR.error('Key "'.concat(t,'" is already bound to "').concat(e.existingAction,'"')),i(null);return}d(a.action).forEach(e=>s(e)),l(t,a.action),u(!1),i(null)}},t=()=>{i(null),u(!1)};return document.addEventListener("keydown",e),document.addEventListener("click",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("click",t)}},[a,o,l,s,c,d,u,w]);let S=e=>{i(e),u(!0)};return(0,r.jsxs)(v.lG,{open:e,onOpenChange:t,children:[(0,r.jsx)(v.zM,{asChild:!0,children:(0,r.jsxs)(n.$,{variant:"text",size:"sm",className:"gap-2",children:[(0,r.jsx)(m.A,{className:"w-4 h-4"}),"Shortcuts"]})}),(0,r.jsxs)(v.Cf,{className:"max-w-2xl max-h-[80vh] flex flex-col p-0",children:[(0,r.jsxs)(v.c7,{className:"flex-shrink-0 p-6 pb-4",children:[(0,r.jsxs)(v.L3,{className:"flex items-center gap-2",children:[(0,r.jsx)(m.A,{className:"w-5 h-5"}),"Keyboard Shortcuts"]}),(0,r.jsx)(v.rr,{children:"Speed up your video editing workflow with these keyboard shortcuts. Click any shortcut key to edit it."})]}),(0,r.jsx)("div",{className:"overflow-y-auto flex-grow scrollbar-thin",children:(0,r.jsx)("div",{className:"space-y-6 p-6",children:N.map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h3",{className:"text-xs text-muted-foreground uppercase tracking-wide font-medium",children:e}),(0,r.jsx)("div",{className:"space-y-0.5",children:b.filter(t=>t.category===e).map(e=>(0,r.jsx)(y,{shortcut:e,isRecording:e.action===(null==a?void 0:a.action),onStartRecording:S},e.action))})]},e))})}),(0,r.jsx)(v.Es,{className:"flex-shrink-0 p-6 pt-4",children:(0,r.jsx)(n.$,{size:"sm",variant:"destructive",onClick:j,children:"Reset to Default"})})]})]})}function y(e){let{shortcut:t,isRecording:a,onStartRecording:n}=e,i=t.keys.filter(e=>!(e.includes("Cmd")&&t.keys.includes(e.replace("Cmd","Ctrl"))));return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[t.icon&&(0,r.jsx)("div",{className:"text-muted-foreground",children:t.icon}),(0,r.jsx)("span",{className:"text-sm",children:t.description})]}),(0,r.jsx)("div",{className:"flex items-center gap-1",children:i.map((e,l)=>(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"flex items-center",children:e.split("+").map((e,i)=>{let s="".concat(t.id,"-").concat(l,"-").concat(i);return(0,r.jsx)(w,{isRecording:a,onStartRecording:()=>n(t),children:e},s)})}),l<i.length-1&&(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"or"})]},e))})]})}function w(e){let{children:t,isRecording:a,onStartRecording:i}=e;return(0,r.jsx)(n.$,{variant:"outline",size:"sm",className:"font-sans px-2 min-w-6 min-h-6 leading-none mr-1 hover:bg-opacity-80 ".concat(a?"border-primary bg-primary/10":"border bg-accent/50"),onClick:e=>{e.preventDefault(),e.stopPropagation(),i()},title:a?"Press any key combination...":"Click to edit shortcut",children:t})}var b=a(54678),N=a(35021),S=a.n(N),C=a(97215),k=a(44775),E=a(93442),T=a(59726),R=a(81009),A=a(60331),M=a(81409),I=a(85495),P=a(9466);let L={default:"Default",media:"Media",inspector:"Inspector","vertical-preview":"Vertical Preview"},D={default:"Media, preview, and inspector on top row, timeline on bottom",media:"Full height media on left, preview and inspector on top row",inspector:"Full height inspector on right, media and preview on top row","vertical-preview":"Full height preview on right for vertical videos"};function z(){let{activePreset:e,setActivePreset:t,resetPreset:a}=(0,P.v)();return(0,r.jsxs)(b.rI,{children:[(0,r.jsx)(b.ty,{asChild:!0,children:(0,r.jsxs)(n.$,{variant:"secondary",size:"sm",className:"h-8 px-2 flex items-center gap-1 text-xs",title:"Panel Presets",children:[(0,r.jsx)(M.A,{className:"h-4 w-4"}),(0,r.jsx)(i.A,{className:"h-3 w-3"})]})}),(0,r.jsxs)(b.SQ,{align:"start",className:"w-64",children:[(0,r.jsx)("div",{className:"px-2 py-1.5 text-xs font-medium text-muted-foreground",children:"Panel Presets"}),(0,r.jsx)(b.mB,{}),Object.keys(L).map(i=>(0,r.jsxs)(b._2,{onClick:()=>{t(i)},className:"flex items-start justify-between gap-2 py-2 cursor-pointer",children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"font-medium text-sm",children:L[i]}),e===i&&(0,r.jsx)("div",{className:"h-2 w-2 rounded-full bg-primary"})]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5 leading-tight",children:D[i]})]}),(0,r.jsx)(n.$,{variant:"secondary",size:"icon",className:"h-6 w-6 shrink-0 opacity-60 hover:opacity-100",onClick:e=>{e.stopPropagation(),a(i)},title:"Reset ".concat(L[i]," preset"),children:(0,r.jsx)(I.A,{className:"h-3 w-3"})})]},i))]})]})}var F=a(81310),_=a(84843),O=a(5156),B=a(8059),U=a(25777);let H=O.Op,$=f.createContext({}),X=e=>{let{...t}=e;return(0,r.jsx)($.Provider,{value:{name:t.name},children:(0,r.jsx)(O.xI,{...t})})},V=()=>{let e=f.useContext($),t=f.useContext(W),{getFieldState:a,formState:r}=(0,O.xW)(),n=a(e.name,r);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...n}},W=f.createContext({}),Y=f.forwardRef((e,t)=>{let{className:a,...n}=e,i=f.useId();return(0,r.jsx)(W.Provider,{value:{id:i},children:(0,r.jsx)("div",{ref:t,className:(0,x.cn)("space-y-2",a),...n})})});Y.displayName="FormItem";let Z=f.forwardRef((e,t)=>{let{className:a,...n}=e,{error:i,formItemId:l}=V();return(0,r.jsx)(U.J,{ref:t,className:(0,x.cn)(i&&"text-destructive",a),htmlFor:l,...n})});Z.displayName="FormLabel";let K=f.forwardRef((e,t)=>{let{...a}=e,{error:n,formItemId:i,formDescriptionId:l,formMessageId:s}=V();return(0,r.jsx)(B.DX,{ref:t,id:i,"aria-describedby":n?"".concat(l," ").concat(s):"".concat(l),"aria-invalid":!!n,...a})});K.displayName="FormControl";let G=f.forwardRef((e,t)=>{let{className:a,...n}=e,{formDescriptionId:i}=V();return(0,r.jsx)("p",{ref:t,id:i,className:(0,x.cn)("text-[0.8rem] text-muted-foreground",a),...n})});G.displayName="FormDescription";let q=f.forwardRef((e,t)=>{let{className:a,children:n,...i}=e,{error:l,formMessageId:s}=V(),o=l?String(null==l?void 0:l.message):n;return o?(0,r.jsx)("p",{ref:t,id:s,className:(0,x.cn)("text-[0.8rem] font-medium text-destructive",a),...i,children:o}):null});q.displayName="FormMessage";var J=a(33112);let Q=J.Ik({email:J.Yj().email().max(320)});function ee(){let[e,t]=(0,f.useState)(!1),a=()=>{t(!0)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{type:"button",className:"flex items-center gap-1.5 bg-[#38BDF8] text-white rounded-md px-[0.12rem] py-[0.12rem] cursor-pointer hover:brightness-95 transition-all duration-200",onClick:a,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),a())},children:(0,r.jsxs)("div",{className:"flex items-center gap-1.5 bg-linear-270 from-[#2567EC] to-[#37B6F7] rounded-[0.8rem] px-4 py-1 relative shadow-[0_1px_3px_0px_rgba(0,0,0,0.65)]",children:[(0,r.jsx)(F.uj,{className:"z-50"}),(0,r.jsx)("span",{className:"text-[0.875rem] z-50",children:"Export (soon)"}),(0,r.jsx)("div",{className:"absolute w-full h-full left-0 top-0 bg-linear-to-t from-white/0 to-white/50 z-10 rounded-[0.8rem] flex items-center justify-center",children:(0,r.jsx)("div",{className:"absolute w-[calc(100%-2px)] h-[calc(100%-2px)] top-[0.08rem] bg-linear-270 from-[#2567EC] to-[#37B6F7] z-50 rounded-[0.8rem]"})})]})}),(0,r.jsx)(et,{isOpen:e,onOpenChange:t})]})}function et(e){let{isOpen:t,onOpenChange:a}=e,i=(0,O.mN)({defaultValues:{email:""}}),{isSubmitting:l}=i.formState,[s,o]=(0,f.useState)(null),c=i.handleSubmit(async e=>{let t=Q.safeParse(e);if(!t.success){for(let e of t.error.issues){let t=e.path[0]||"email";i.setError(t,{type:"zod",message:e.message})}return}o(null);let{email:a}=t.data,r=await fetch("/api/waitlist/export",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})});if(!r.ok)return void o({text:"Something went wrong. Please try again.",type:"error"});let n=await r.json();if(n.success&&n.alreadySubscribed)return void o({text:"You're already on the list.",type:"success"});if(n.success){o({text:"You're on the list. We'll email you when it's ready.",type:"success"}),i.reset();return}o({text:"Couldn't add your email. Please try again.",type:"error"})});return(0,r.jsx)(v.lG,{open:t,onOpenChange:a,children:(0,r.jsxs)(v.Cf,{className:"p-6",children:[(0,r.jsx)(v.c7,{children:(0,r.jsx)(v.L3,{children:"Export Project"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(v.rr,{children:"Export isn't ready yet. we're building a custom pipeline to make it great."}),(0,r.jsx)(H,{...i,children:(0,r.jsxs)("form",{className:"flex flex-col gap-5",onSubmit:c,children:[(0,r.jsxs)("div",{className:"flex flex-col gap-4 w-full",children:[(0,r.jsx)(X,{control:i.control,name:"email",render:e=>{let{field:t}=e;return(0,r.jsxs)(Y,{children:[(0,r.jsx)(Z,{children:"Email"}),(0,r.jsx)(K,{children:(0,r.jsx)(_.p,{type:"email",placeholder:"you@example.com",inputMode:"email",autoComplete:"email",disabled:l,...t})}),(0,r.jsx)(G,{children:"We'll let you know once export is ready."}),(0,r.jsx)(q,{})]})}}),(0,r.jsx)(n.$,{type:"submit",disabled:l,children:l?"Sending...":"Notify me"})]}),s?(0,r.jsx)("p",{role:"status","aria-live":"polite",className:(0,x.cn)("text-xs","success"===s.type?"text-green-600":"text-red-600"),children:s.text}):null]})})]})]})})}function ea(){let{activeProject:e,renameProject:t,deleteProject:a}=(0,u.Iw)(),[m,h]=(0,f.useState)(!1),[p,x]=(0,f.useState)(!1);(0,T.useRouter)();let{theme:g,setTheme:v}=(0,A.D)(),y=async a=>{if(e&&a.trim()&&a!==e.name)try{await t(e.id,a.trim()),x(!1)}catch(e){}},w=(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(b.rI,{children:[(0,r.jsx)(b.ty,{asChild:!0,children:(0,r.jsxs)(n.$,{variant:"secondary",className:"h-auto py-1.5 px-2.5 flex items-center justify-center",children:[(0,r.jsx)(i.A,{className:"text-muted-foreground"}),(0,r.jsx)("span",{className:"text-[0.85rem] mr-2",children:null==e?void 0:e.name})]})}),(0,r.jsxs)(b.SQ,{align:"start",className:"w-40 z-100",children:[(0,r.jsxs)(b._2,{className:"flex items-center gap-1.5",onClick:()=>(0,C.vv)(),children:[(0,r.jsx)(l.A,{className:"h-4 w-4"}),"Projects"]}),(0,r.jsxs)(b._2,{className:"flex items-center gap-1.5",onClick:()=>x(!0),children:[(0,r.jsx)(s.A,{className:"h-4 w-4"}),"Rename project"]}),(0,r.jsxs)(b._2,{variant:"destructive",className:"flex items-center gap-1.5",onClick:()=>h(!0),children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),"Delete Project"]}),(0,r.jsx)(b.mB,{}),(0,r.jsx)(b._2,{asChild:!0,children:(0,r.jsxs)(S(),{href:"https://discord.gg/zmR9N35cjK",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5",children:[(0,r.jsx)(R.O4U,{className:"h-4 w-4"}),"Discord"]})})]})]}),(0,r.jsx)(k.U,{isOpen:p,onOpenChange:x,onConfirm:y,projectName:(null==e?void 0:e.name)||""}),(0,r.jsx)(E.B,{isOpen:m,onOpenChange:h,onConfirm:()=>{e&&(a(e.id),h(!1),(0,C.vv)())},projectName:(null==e?void 0:e.name)||""})]}),N=(0,r.jsxs)("nav",{className:"flex items-center gap-2",children:[(0,r.jsx)(z,{}),(0,r.jsx)(j,{}),(0,r.jsx)(ee,{}),(0,r.jsxs)(n.$,{size:"icon",variant:"text",className:"h-7",onClick:()=>v("dark"===g?"light":"dark"),children:[(0,r.jsx)(c.A,{className:"!size-[1.1rem]"}),(0,r.jsx)("span",{className:"sr-only",children:"dark"===g?"Light":"Dark"})]})]});return(0,r.jsx)(d.H,{leftContent:w,rightContent:N,className:"bg-background h-[3.2rem] px-3 items-center mt-0.5"})}J.Ik({success:J.zM(),alreadySubscribed:J.zM().optional()})},47165:(e,t,a)=>{a.d(t,{T:()=>l});var r=a(61557),n=a(80196),i=a(70028);async function l(e,t){let a=Array.from(e),l=[],s=a.length,o=0;for(let e of a){let a,c,d,u,m,f=(0,n.getFileType)(e);if(!f){r.oR.error("Unsupported file type: ".concat(e.name));continue}let h=URL.createObjectURL(e);try{if("image"===f){let t=await (0,n.getImageDimensions)(e);d=t.width,u=t.height}else if("video"===f)try{let t=await (0,i.G5)(e);c=t.duration,d=t.width,u=t.height,m=t.fps,a=await (0,i.I6)(e,1)}catch(r){let t=await (0,n.generateVideoThumbnail)(e);a=t.thumbnailUrl,d=t.width,u=t.height,c=await (0,n.getMediaDuration)(e)}else"audio"===f&&(c=await (0,n.getMediaDuration)(e));if(l.push({name:e.name,type:f,file:e,url:h,thumbnailUrl:a,duration:c,width:d,height:u,fps:m}),await new Promise(e=>setTimeout(e,0)),o+=1,t){let e=Math.round(o/s*100);t(e)}}catch(t){r.oR.error("Failed to process ".concat(e.name)),URL.revokeObjectURL(h)}}return l}},52801:(e,t,a)=>{a.d(t,{bq:()=>h,eb:()=>v,gC:()=>g,l6:()=>u,yv:()=>m});var r=a(28064),n=a(74188),i=a(89188),l=a(90320),s=a(44585),o=a(58090),c=a(24827),d=a(93146);let u=i.Root;i.Group;let m=i.Value,f=(0,c.F)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-hidden transition-opacity data-disabled:pointer-events-none data-disabled:opacity-50",{variants:{variant:{default:"focus:opacity-65 focus:text-accent-foreground",destructive:"text-destructive focus:text-destructive/80"}},defaultVariants:{variant:"default"}}),h=n.forwardRef((e,t)=>{let{className:a,children:n,...s}=e;return(0,r.jsxs)(i.Trigger,{ref:t,className:(0,d.cn)("flex gap-1 h-7 cursor-pointer w-auto items-center justify-between whitespace-nowrap rounded-md bg-accent px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-hidden focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...s,children:[n,(0,r.jsx)(i.Icon,{asChild:!0,children:(0,r.jsx)(l.A,{className:"size-3 opacity-50"})})]})});h.displayName=i.Trigger.displayName;let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(i.ScrollUpButton,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,r.jsx)(s.A,{className:"h-4 w-4"})})});p.displayName=i.ScrollUpButton.displayName;let x=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(i.ScrollDownButton,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})});x.displayName=i.ScrollDownButton.displayName;let g=n.forwardRef((e,t)=>{let{className:a,children:n,position:l="popper",...s}=e;return(0,r.jsx)(i.Portal,{children:(0,r.jsxs)(i.Content,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-32 overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,onCloseAutoFocus:e=>{e.preventDefault(),e.stopPropagation()},...s,children:[(0,r.jsx)(p,{}),(0,r.jsx)(i.Viewport,{className:(0,d.cn)("p-1","popper"===l&&"h-(--radix-select-trigger-height) w-full min-w-(--radix-select-trigger-width)"),children:n}),(0,r.jsx)(x,{})]})})});g.displayName=i.Content.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(i.Label,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",a),...n})}).displayName=i.Label.displayName;let v=n.forwardRef((e,t)=>{let{className:a,children:n,variant:l="default",...s}=e;return(0,r.jsxs)(i.Item,{ref:t,className:(0,d.cn)(f({variant:l}),a),...s,children:[(0,r.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.ItemIndicator,{children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})}),(0,r.jsx)(i.ItemText,{children:n})]})});v.displayName=i.Item.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(i.Separator,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-foreground/10",a),...n})}).displayName=i.Separator.displayName},66575:(e,t,a)=>{a.d(t,{l:()=>tu});var r=a(28064),n=a(93146),i=a(90649),l=a(46438);function s(){let{activeTab:e,setActiveTab:t}=(0,i.t)();return(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)("div",{className:"h-full px-4 flex flex-col justify-start items-center gap-5 overflow-x-auto scrollbar-x-hidden relative w-full py-4",children:Object.keys(i.v).map(a=>{let s=i.v[a];return(0,r.jsx)("div",{className:(0,n.cn)("flex z-[100] flex-col gap-0.5 items-center cursor-pointer",e===a?"text-primary !opacity-100":"text-muted-foreground"),onClick:()=>t(a),children:(0,r.jsxs)(l.m_,{delayDuration:10,children:[(0,r.jsx)(l.k$,{asChild:!0,children:(0,r.jsx)(s.icon,{className:"size-[1.1rem]! opacity-100 hover:opacity-75"})}),(0,r.jsx)(l.ZI,{side:"right",align:"center",variant:"sidebar",sideOffset:8,children:(0,r.jsx)("div",{className:"dark:text-base-gray-950 text-black text-sm font-medium leading-none dark:text-white",children:s.label})})]})},a)})})})}var o=a(74188);let c=e=>!e.types.includes("application/x-media-item")&&e.types.includes("Files");var d=a(47165),u=a(80196),m=a(43589),f=a(53093),h=a(93843),p=a(26880),x=a(83091),g=a(97946),v=a(57107),j=a(80965),y=a(61557),w=a(61309),b=a(95647);function N(e){let{isVisible:t,isProcessing:a=!1,progress:n=0,onClick:i,isEmptyState:l=!1}=e;return t?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 h-full text-center rounded-lg bg-foreground/5 hover:bg-foreground/10 transition-all duration-200 p-8",onClick:e=>{!a&&i&&(e.preventDefault(),e.stopPropagation(),i())},children:[(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)(b.A,{className:"h-10 w-10 text-foreground"})}),(0,r.jsx)("div",{className:"space-y-2",children:(0,r.jsx)("p",{className:"text-xs text-muted-foreground max-w-sm",children:a?"Processing your files (".concat(n,"%)"):"Drag and drop videos, photos, and audio files here"})}),a&&(0,r.jsx)("div",{className:"w-full max-w-xs",children:(0,r.jsx)("div",{className:"w-full bg-muted/50 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:"".concat(n,"%")}})})})]}):null}var S=a(86434),C=a(54678);let k=a(26542).b;var E=a(82749),T=a(85794),R=a(81925);function A(e){let{name:t,preview:a,dragData:i,onDragStart:l,onAddToTimeline:s,aspectRatio:c=16/9,className:d="",containerClassName:u,showPlusOnDrag:m=!0,showLabel:f=!0,rounded:h=!0,variant:p="card",isDraggable:x=!0,isHighlighted:g=!1}=e,[v,j]=(0,o.useState)(!1),[y,w]=(0,o.useState)({x:0,y:0}),b=(0,o.useRef)(null),N=x?(0,R.E)(e=>e.currentTime):0,S="ring-2 ring-primary rounded-sm bg-primary/10",C=()=>{null==s||s(N)},T=new window.Image;T.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",(0,o.useEffect)(()=>{if(!v)return;let e=e=>{w({x:e.clientX,y:e.clientY})};return document.addEventListener("dragover",e),()=>{document.removeEventListener("dragover",e)}},[v]);let A=e=>{e.dataTransfer.setDragImage(T,0,0),e.dataTransfer.setData("application/x-media-item",JSON.stringify(i)),e.dataTransfer.effectAllowed="copy",w({x:e.clientX,y:e.clientY}),j(!0),null==l||l(e)},I=()=>{j(!1)};return(0,r.jsxs)(r.Fragment,{children:["card"===p?(0,r.jsx)("div",{ref:b,className:(0,n.cn)("relative group",null!=u?u:"w-28 h-28"),children:(0,r.jsxs)("div",{className:(0,n.cn)("flex flex-col gap-1 p-1 h-auto w-full relative cursor-default",d,g&&S),children:[(0,r.jsxs)(k,{ratio:c,className:(0,n.cn)("bg-panel-accent relative overflow-hidden",h&&"rounded-md",x&&"[&::-webkit-drag-ghost]:opacity-0"),draggable:x,onDragStart:x?A:void 0,onDragEnd:x?I:void 0,children:[a,!v&&(0,r.jsx)(M,{className:"opacity-0 group-hover:opacity-100",onClick:C})]}),f&&(0,r.jsx)("span",{className:"text-[0.7rem] text-muted-foreground truncate w-full text-left","aria-label":t,title:t,children:t.length>8?"".concat(t.slice(0,16),"...").concat(t.slice(-3)):t})]})}):(0,r.jsx)("div",{ref:b,className:(0,n.cn)("relative group w-full",g&&S),children:(0,r.jsxs)("div",{className:(0,n.cn)("h-8 flex items-center gap-3 cursor-default w-full px-1",x&&"[&::-webkit-drag-ghost]:opacity-0",d),draggable:x,onDragStart:x?A:void 0,onDragEnd:x?I:void 0,children:[(0,r.jsx)("div",{className:"w-6 h-6 flex-shrink-0 rounded-[0.35rem] overflow-hidden",children:a}),(0,r.jsx)("span",{className:"text-sm truncate flex-1 w-full",children:t})]})}),x&&v&&"undefined"!=typeof document&&(0,E.createPortal)((0,r.jsx)("div",{className:"fixed pointer-events-none z-9999",style:{left:y.x-40,top:y.y-40},children:(0,r.jsx)("div",{className:"w-[80px]",children:(0,r.jsxs)(k,{ratio:1,className:"relative rounded-md overflow-hidden shadow-2xl ring-3 ring-primary",children:[(0,r.jsx)("div",{className:"w-full h-full [&_img]:w-full [&_img]:h-full [&_img]:object-cover [&_img]:rounded-none",children:a}),m&&(0,r.jsx)(M,{onClick:C,tooltipText:"Add to timeline or drag to position"})]})})}),document.body)]})}function M(e){let{className:t,onClick:a,tooltipText:i}=e,s=(0,r.jsx)(w.$,{size:"icon",className:(0,n.cn)("absolute bottom-2 right-2 size-4 bg-background hover:bg-panel text-foreground",t),onClick:e=>{e.preventDefault(),e.stopPropagation(),null==a||a()},title:i,children:(0,r.jsx)(T.A,{className:"size-3!"})});return i?(0,r.jsxs)(l.m_,{children:[(0,r.jsx)(l.k$,{asChild:!0,children:s}),(0,r.jsx)(l.ZI,{children:(0,r.jsx)("p",{children:i})})]}):s}var I=a(82337),P=a(91685),L=a(9466);function D(e){let{item:t,children:a,onRemove:n}=e;return(0,r.jsxs)(S.tz,{children:[(0,r.jsx)(S.Rc,{children:a}),(0,r.jsxs)(S.Ip,{children:[(0,r.jsx)(S.kt,{children:"Export clips"}),(0,r.jsx)(S.kt,{variant:"destructive",onClick:e=>n(e,t.id),children:"Delete"})]})]})}function z(){let{mediaItems:e,addMediaItem:t,removeMediaItem:a}=(0,u.B)(),{activeProject:n}=(0,I.Iw)(),{mediaViewMode:s,setMediaViewMode:b}=(0,L.v)(),S=(0,o.useRef)(null),[k,E]=(0,o.useState)(!1),[T,R]=(0,o.useState)(0),[A,M]=(0,o.useState)(""),[P,D]=(0,o.useState)("all"),[z,O]=(0,o.useState)("name"),[B,U]=(0,o.useState)("asc"),{highlightMediaId:H,clearHighlight:$}=(0,i.t)(),{highlightedId:X,registerElement:V}=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,[r,n]=(0,o.useState)(null),i=(0,o.useRef)(new Map);return(0,o.useEffect)(()=>{if(!e)return;n(e);let r=i.current.get(e);null==r||r.scrollIntoView({block:"center"});let l=setTimeout(()=>{n(null),t()},a);return()=>clearTimeout(l)},[e,t,a]),{highlightedId:r,registerElement:(e,t)=>{t?i.current.set(e,t):i.current.delete(e)}}}(H,$),W=async e=>{if(e&&0!==e.length){if(!n)return void y.oR.error("No active project");E(!0),R(0);try{for(let a of(await (0,d.T)(e,e=>R(e))))await t(n.id,a)}catch(e){y.oR.error("Failed to process files")}finally{E(!1),R(0)}}},{isDragOver:Y,dragProps:Z}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,a]=(0,o.useState)(!1),r=(0,o.useRef)(0);return{isDragOver:t,dragProps:{onDragEnter:e=>{e.preventDefault(),c(e.dataTransfer)&&(r.current+=1,t||a(!0))},onDragOver:e=>{if(e.preventDefault(),!c(e.dataTransfer))return},onDragLeave:e=>{e.preventDefault(),c(e.dataTransfer)&&(r.current-=1,0===r.current&&a(!1))},onDrop:t=>{t.preventDefault(),a(!1),r.current=0,e.onDrop&&t.dataTransfer.files&&c(t.dataTransfer)&&e.onDrop(t.dataTransfer.files)}}}}({onDrop:W}),K=()=>{var e;return null==(e=S.current)?void 0:e.click()},G=async(e,t)=>{if(e.stopPropagation(),!n)return void y.oR.error("No active project");await a(n.id,t)},q=e=>{let t=Math.floor(e/60),a=Math.floor(e%60);return"".concat(t,":").concat(a.toString().padStart(2,"0"))},[J,Q]=(0,o.useState)(e);(0,o.useEffect)(()=>{let t=e.filter(e=>!e.ephemeral&&(!P||"all"===P||e.type===P)&&(!A||!!e.name.toLowerCase().includes(A.toLowerCase())));t.sort((e,t)=>{let a,r;switch(z){case"name":a=e.name.toLowerCase(),r=t.name.toLowerCase();break;case"type":a=e.type,r=t.type;break;case"duration":a=e.duration||0,r=t.duration||0;break;case"size":a=e.file.size,r=t.file.size;break;default:return 0}return a<r?"asc"===B?-1:1:a>r?"asc"===B?1:-1:0}),Q(t)},[e,P,A,z,B]);let ee=(0,o.useMemo)(()=>{let e=new Map;return J.forEach(t=>{let a;a="image"===t.type?(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)("img",{src:t.url,alt:t.name,className:"w-full max-h-full object-cover",loading:"lazy"})}):"video"===t.type?t.thumbnailUrl?(0,r.jsxs)("div",{className:"relative w-full h-full",children:[(0,r.jsx)("img",{src:t.thumbnailUrl,alt:t.name,className:"w-full h-full object-cover rounded",loading:"lazy"}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 rounded",children:(0,r.jsx)(m.A,{className:"h-6 w-6 text-white drop-shadow-md"})}),t.duration&&(0,r.jsx)("div",{className:"absolute bottom-1 right-1 bg-black/70 text-white text-xs px-1 rounded",children:q(t.duration)})]}):(0,r.jsxs)("div",{className:"w-full h-full bg-muted/30 flex flex-col items-center justify-center text-muted-foreground rounded",children:[(0,r.jsx)(m.A,{className:"h-6 w-6 mb-1"}),(0,r.jsx)("span",{className:"text-xs",children:"Video"}),t.duration&&(0,r.jsx)("span",{className:"text-xs opacity-70",children:q(t.duration)})]}):"audio"===t.type?(0,r.jsxs)("div",{className:"w-full h-full bg-linear-to-br from-green-500/20 to-emerald-500/20 flex flex-col items-center justify-center text-muted-foreground rounded border border-green-500/20",children:[(0,r.jsx)(f.A,{className:"h-6 w-6 mb-1"}),(0,r.jsx)("span",{className:"text-xs",children:"Audio"}),t.duration&&(0,r.jsx)("span",{className:"text-xs opacity-70",children:q(t.duration)})]}):(0,r.jsxs)("div",{className:"w-full h-full bg-muted/30 flex flex-col items-center justify-center text-muted-foreground rounded",children:[(0,r.jsx)(h.A,{className:"h-6 w-6"}),(0,r.jsx)("span",{className:"text-xs mt-1",children:"Unknown"})]}),e.set(t.id,a)}),e},[J]),et=e=>ee.get(e.id);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{ref:S,type:"file",accept:"image/*,video/*,audio/*",multiple:!0,className:"hidden",onChange:e=>{e.target.files&&W(e.target.files),e.target.value=""}}),(0,r.jsxs)("div",{className:"h-full flex flex-col gap-1 transition-colors relative ".concat(Y?"bg-accent/30":""),...Z,children:[(0,r.jsx)("div",{className:"p-3 pb-2 bg-panel",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(w.$,{variant:"outline",size:"lg",onClick:K,disabled:k,className:"!bg-background px-4 flex-1 justify-center items-center h-9 opacity-100 hover:opacity-75 transition-opacity",children:[k?(0,r.jsx)(p.A,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(x.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Upload"})]}),(0,r.jsx)("div",{className:"flex items-center gap-0",children:(0,r.jsx)(l.Bc,{children:(0,r.jsxs)(l.m_,{children:[(0,r.jsx)(l.k$,{asChild:!0,children:(0,r.jsx)(w.$,{size:"icon",variant:"text",onClick:()=>b("grid"===s?"list":"grid"),disabled:k,className:"justify-center items-center",children:"grid"===s?(0,r.jsx)(g.A,{strokeWidth:1.5,className:"!size-[1.05rem]"}):(0,r.jsx)(v.A,{strokeWidth:1.5,className:"!size-[1.05rem]"})})}),(0,r.jsx)(l.ZI,{children:(0,r.jsx)("p",{children:"grid"===s?"Switch to list view":"Switch to grid view"})}),(0,r.jsxs)(l.m_,{children:[(0,r.jsxs)(C.rI,{children:[(0,r.jsx)(l.k$,{asChild:!0,children:(0,r.jsx)(C.ty,{asChild:!0,children:(0,r.jsx)(w.$,{size:"icon",variant:"text",disabled:k,className:"justify-center items-center",children:(0,r.jsx)(j.A,{strokeWidth:1.5,className:"!size-[1.05rem]"})})})}),(0,r.jsxs)(C.SQ,{align:"end",children:[(0,r.jsxs)(C._2,{onClick:()=>{"name"===z?U("asc"===B?"desc":"asc"):(O("name"),U("asc"))},children:["Name"," ","name"===z&&("asc"===B?"↑":"↓")]}),(0,r.jsxs)(C._2,{onClick:()=>{"type"===z?U("asc"===B?"desc":"asc"):(O("type"),U("asc"))},children:["Type"," ","type"===z&&("asc"===B?"↑":"↓")]}),(0,r.jsxs)(C._2,{onClick:()=>{"duration"===z?U("asc"===B?"desc":"asc"):(O("duration"),U("asc"))},children:["Duration"," ","duration"===z&&("asc"===B?"↑":"↓")]}),(0,r.jsxs)(C._2,{onClick:()=>{"size"===z?U("asc"===B?"desc":"asc"):(O("size"),U("asc"))},children:["File Size"," ","size"===z&&("asc"===B?"↑":"↓")]})]})]}),(0,r.jsx)(l.ZI,{children:(0,r.jsxs)("p",{children:["Sort by ",z," (","asc"===B?"ascending":"descending",")"]})})]})]})})})]})}),(0,r.jsx)("div",{className:"h-full w-full overflow-y-auto scrollbar-thin pt-1",children:(0,r.jsx)("div",{className:"flex-1 p-3 pt-0 w-full",children:Y||0===J.length?(0,r.jsx)(N,{isVisible:!0,isProcessing:k,progress:T,onClick:K,isEmptyState:0===J.length&&!Y}):"grid"===s?(0,r.jsx)(F,{filteredMediaItems:J,renderPreview:et,handleRemove:G,highlightedId:X,registerElement:V}):(0,r.jsx)(_,{filteredMediaItems:J,renderPreview:et,handleRemove:G,highlightedId:X,registerElement:V})})})]})]})}function F(e){let{filteredMediaItems:t,renderPreview:a,handleRemove:n,highlightedId:i,registerElement:l}=e;return(0,r.jsx)("div",{className:"grid gap-2",style:{gridTemplateColumns:"repeat(auto-fill, 160px)"},children:t.map(e=>(0,r.jsx)("div",{ref:t=>l(e.id,t),children:(0,r.jsx)(D,{item:e,onRemove:n,children:(0,r.jsx)(A,{name:e.name,preview:a(e),dragData:{id:e.id,type:e.type,name:e.name},showPlusOnDrag:!1,onAddToTimeline:t=>P.A.getState().addMediaAtTime(e,t),rounded:!1,variant:"card",isHighlighted:i===e.id})})},e.id))})}function _(e){let{filteredMediaItems:t,renderPreview:a,handleRemove:n,highlightedId:i,registerElement:l}=e;return(0,r.jsx)("div",{className:"space-y-1",children:t.map(e=>(0,r.jsx)("div",{ref:t=>l(e.id,t),children:(0,r.jsx)(D,{item:e,onRemove:n,children:(0,r.jsx)(A,{name:e.name,preview:a(e),dragData:{id:e.id,type:e.type,name:e.name},showPlusOnDrag:!1,onAddToTimeline:t=>P.A.getState().addMediaAtTime(e,t),variant:"compact",isHighlighted:i===e.id})})},e.id))})}var O=a(10952),B=a(67034),U=a(91048);let H=U.Root,$=o.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)(U.List,{ref:t,className:(0,n.cn)("inline-flex h-auto items-center justify-center gap-2 rounded-lg bg-transparent p-0 text-muted-foreground",a),...i})});$.displayName=U.List.displayName;let X=o.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)(U.Trigger,{ref:t,className:(0,n.cn)("inline-flex items-center cursor-pointer justify-center whitespace-nowrap rounded-lg px-3 py-1 text-sm font-medium ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-card data-[state=active]:text-foreground",a),...i})});X.displayName=U.Trigger.displayName;let V=o.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,r.jsx)(U.Content,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...i})});function W(e){let{children:t,className:a}=e;return(0,r.jsx)(O.F,{className:"flex-1",children:(0,r.jsx)("div",{className:"p-5 h-full ".concat(a),children:t})})}function Y(e){let{children:t,defaultTab:a,tabs:n,className:i="",ref:l}=e;return(0,r.jsx)("div",{className:"h-full flex flex-col ".concat(i),ref:l,children:n&&0!==n.length?(0,r.jsxs)(H,{defaultValue:a,className:"flex flex-col h-full",children:[(0,r.jsx)("div",{className:"px-3 pt-4 pb-0",children:(0,r.jsx)($,{children:n.map(e=>(0,r.jsx)(X,{value:e.value,children:e.label},e.value))})}),(0,r.jsx)(B.Separator,{className:"mt-4"}),n.map(e=>(0,r.jsx)(V,{value:e.value,className:"mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(W,{children:e.content})},e.value))]}):(0,r.jsx)(W,{className:i,children:t})})}V.displayName=U.Content.displayName;var Z=a(87100);let K={id:"default-text",type:"text",name:"Default text",content:"Default text",fontSize:48,fontFamily:"Arial",color:"#ffffff",backgroundColor:"transparent",textAlign:"center",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",x:0,y:0,rotation:0,opacity:1,duration:Z.of.DEFAULT_TEXT_DURATION,startTime:0,trimStart:0,trimEnd:0};function G(){return(0,r.jsx)(Y,{children:(0,r.jsx)(A,{name:"Default text",preview:(0,r.jsx)("div",{className:"flex items-center justify-center w-full h-full bg-panel-accent rounded",children:(0,r.jsx)("span",{className:"text-xs select-none",children:"Default text"})}),dragData:{id:K.id,type:K.type,name:K.name,content:K.content},aspectRatio:1,onAddToTimeline:e=>P.A.getState().addTextAtTime(K,e),showLabel:!1})})}var q=a(84843),J=a(37975),Q=a(11566),ee=a(45440),et=a(47888),ea=a(59467),er=a(19439);let en=(0,ea.v)((e,t)=>({topSoundEffects:[],isLoading:!1,error:null,hasLoaded:!1,showCommercialOnly:!0,toggleCommercialFilter:()=>{e(e=>({showCommercialOnly:!e.showCommercialOnly}))},searchQuery:"",searchResults:[],isSearching:!1,searchError:null,lastSearchQuery:"",scrollPosition:0,currentPage:1,hasNextPage:!1,totalCount:0,isLoadingMore:!1,savedSounds:[],isSavedSoundsLoaded:!1,isLoadingSavedSounds:!1,savedSoundsError:null,setTopSoundEffects:t=>e({topSoundEffects:t}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t}),setHasLoaded:t=>e({hasLoaded:t}),setSearchQuery:t=>e({searchQuery:t}),setSearchResults:t=>e({searchResults:t,currentPage:1}),setSearching:t=>e({isSearching:t}),setSearchError:t=>e({searchError:t}),setLastSearchQuery:t=>e({lastSearchQuery:t}),setScrollPosition:t=>e({scrollPosition:t}),setCurrentPage:t=>e({currentPage:t}),setHasNextPage:t=>e({hasNextPage:t}),setTotalCount:t=>e({totalCount:t}),setLoadingMore:t=>e({isLoadingMore:t}),appendSearchResults:t=>e(e=>({searchResults:[...e.searchResults,...t]})),appendTopSounds:t=>e(e=>({topSoundEffects:[...e.topSoundEffects,...t]})),resetPagination:()=>e({currentPage:1,hasNextPage:!1,totalCount:0,isLoadingMore:!1}),loadSavedSounds:async()=>{if(!t().isSavedSoundsLoaded)try{e({isLoadingSavedSounds:!0,savedSoundsError:null});let t=await er.P.loadSavedSounds();e({savedSounds:t.sounds,isSavedSoundsLoaded:!0,isLoadingSavedSounds:!1})}catch(t){e({savedSoundsError:t instanceof Error?t.message:"Failed to load saved sounds",isLoadingSavedSounds:!1})}},saveSoundEffect:async t=>{try{await er.P.saveSoundEffect(t);let a=await er.P.loadSavedSounds();e({savedSounds:a.sounds})}catch(t){e({savedSoundsError:t instanceof Error?t.message:"Failed to save sound"}),y.oR.error("Failed to save sound")}},removeSavedSound:async t=>{try{await er.P.removeSavedSound(t),e(e=>({savedSounds:e.savedSounds.filter(e=>e.id!==t)}))}catch(t){e({savedSoundsError:t instanceof Error?t.message:"Failed to remove sound"}),y.oR.error("Failed to remove sound")}},isSoundSaved:e=>{let{savedSounds:a}=t();return a.some(t=>t.id===e)},toggleSavedSound:async e=>{let{isSoundSaved:a,saveSoundEffect:r,removeSavedSound:n}=t();a(e.id)?await n(e.id):await r(e)},clearSavedSounds:async()=>{try{await er.P.clearSavedSounds(),e({savedSounds:[],savedSoundsError:null})}catch(t){e({savedSoundsError:t instanceof Error?t.message:"Failed to clear saved sounds"}),y.oR.error("Failed to clear saved sounds")}},addSoundToTimeline:async e=>{let t=I.Iw.getState().activeProject;if(!t)return y.oR.error("No active project"),!1;let a=e.previewUrl;if(!a)return y.oR.error("Sound file not available"),!1;try{let r=await fetch(a);if(!r.ok)throw Error("Failed to download audio: ".concat(r.statusText));let n=await r.blob(),i=new File([n],"".concat(e.name,".mp3"),{type:"audio/mpeg"});await u.B.getState().addMediaItem(t.id,{name:e.name,type:"audio",file:i,duration:e.duration,url:URL.createObjectURL(i)});let l=u.B.getState().mediaItems.find(e=>e.file===i);if(!l)throw Error("Failed to create media item");if(P.A.getState().addMediaAtTime(l,R.E.getState().currentTime))return!0;throw Error("Failed to add to timeline - check for overlaps")}catch(t){return y.oR.error(t instanceof Error?t.message:"Failed to add sound to timeline",{id:"sound-".concat(e.id)}),!1}}}));var ei=a(66981);function el(e){let{onLoadMore:t,hasMore:a,isLoading:r,threshold:n=200,enabled:i=!0}=e;return{scrollAreaRef:(0,o.useRef)(null),handleScroll:(0,o.useCallback)(e=>{if(!i)return;let{scrollTop:l,scrollHeight:s,clientHeight:o}=e.currentTarget;l+o>=s-n&&a&&!r&&t()},[t,a,r,n,i])}}function es(){return(0,r.jsx)("div",{className:"h-full flex flex-col",children:(0,r.jsxs)(H,{defaultValue:"sound-effects",className:"flex flex-col h-full",children:[(0,r.jsx)("div",{className:"px-3 pt-4 pb-0",children:(0,r.jsxs)($,{children:[(0,r.jsx)(X,{value:"sound-effects",children:"Sound effects"}),(0,r.jsx)(X,{value:"songs",children:"Songs"}),(0,r.jsx)(X,{value:"saved",children:"Saved"})]})}),(0,r.jsx)(B.Separator,{className:"my-4"}),(0,r.jsx)(V,{value:"sound-effects",className:"p-5 pt-0 mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(eo,{})}),(0,r.jsx)(V,{value:"saved",className:"p-5 pt-0 mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(ec,{})}),(0,r.jsx)(V,{value:"songs",className:"p-5 pt-0 mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(ed,{})})]})})}function eo(){let{topSoundEffects:e,isLoading:t,searchQuery:a,setSearchQuery:i,scrollPosition:l,setScrollPosition:s,loadSavedSounds:c,isSoundSaved:d,toggleSavedSound:u,showCommercialOnly:m,toggleCommercialFilter:f}=en(),{results:h,isLoading:p,loadMore:x,hasNextPage:g,isLoadingMore:v}=function(e,t){let{searchResults:a,isSearching:r,searchError:n,lastSearchQuery:i,currentPage:l,hasNextPage:s,isLoadingMore:c,totalCount:d,setSearchResults:u,setSearching:m,setSearchError:f,setLastSearchQuery:h,setCurrentPage:p,setHasNextPage:x,setTotalCount:g,setLoadingMore:v,appendSearchResults:j,appendTopSounds:y,resetPagination:w}=en(),b=async()=>{if(!c&&s)try{v(!0);let a=l+1,r=new URLSearchParams({page:a.toString(),type:"effects"});e.trim()&&r.set("q",e),r.set("commercial_only",t.toString());let n=await fetch("/api/sounds/search?".concat(r.toString()));if(n.ok){let t=await n.json();e.trim()?j(t.results):y(t.results),p(a),x(!!t.next),g(t.count)}else f("Load more failed: ".concat(n.status))}catch(e){f(e instanceof Error?e.message:"Load more failed")}finally{v(!1)}};return(0,o.useEffect)(()=>{if(!e.trim()){u([]),f(null),h("");return}if(e===i&&a.length>0)return;let t=!1,r=setTimeout(async()=>{try{m(!0),f(null),w();let a=await fetch("/api/sounds/search?q=".concat(encodeURIComponent(e),"&type=effects&page=1"));if(!t)if(a.ok){let t=await a.json();u(t.results),h(e),x(!!t.next),g(t.count),p(1)}else f("Search failed: ".concat(a.status))}catch(e){t||f(e instanceof Error?e.message:"Search failed")}finally{t||m(!1)}},300);return()=>{clearTimeout(r),t=!0}},[e,i,a.length,u,m,f,h,p,x,g,w]),{results:a,isLoading:r,error:n,loadMore:b,hasNextPage:s,isLoadingMore:c,totalCount:d}}(a,m),[j,y]=(0,o.useState)(null),[b,N]=(0,o.useState)(null),{scrollAreaRef:S,handleScroll:k}=el({onLoadMore:x,hasMore:g,isLoading:v||p});(0,o.useEffect)(()=>{if(c(),S.current&&l>0){let e=setTimeout(()=>{var e;null==(e=S.current)||e.scrollTo({top:l})},100);return()=>clearTimeout(e)}},[]);let E=(0,o.useMemo)(()=>a?h:e,[a,h,e]);return(0,r.jsxs)("div",{className:"flex flex-col gap-5 mt-1 h-full",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(q.p,{placeholder:"Search sound effects",className:"bg-panel-accent w-full",containerClassName:"w-full",value:a,onChange:e=>i(e.target.value),showClearIcon:!0,onClear:()=>i("")}),(0,r.jsxs)(C.rI,{children:[(0,r.jsx)(C.ty,{asChild:!0,children:(0,r.jsx)(w.$,{variant:"text",size:"icon",className:(0,n.cn)(m&&"text-primary"),children:(0,r.jsx)(J.A,{className:"w-4 h-4"})})}),(0,r.jsxs)(C.SQ,{align:"end",className:"w-56",children:[(0,r.jsx)(C.hO,{checked:m,onCheckedChange:f,children:"Show only commercially licensed"}),(0,r.jsx)("div",{className:"px-2 py-1.5 text-xs text-muted-foreground",children:m?"Only showing sounds licensed for commercial use":"Showing all sounds regardless of license"})]})]})]}),(0,r.jsx)("div",{className:"relative h-full overflow-hidden",children:(0,r.jsx)(O.F,{className:"flex-1 h-full",ref:S,onScrollCapture:e=>{let{scrollTop:t}=e.currentTarget;s(t),k(e)},children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[t&&!a&&(0,r.jsx)("div",{className:"text-muted-foreground text-sm",children:"Loading sounds..."}),p&&a&&(0,r.jsx)("div",{className:"text-muted-foreground text-sm",children:"Searching..."}),E.map(e=>(0,r.jsx)(eu,{sound:e,isPlaying:j===e.id,onPlay:()=>(e=>{if(j===e.id){null==b||b.pause(),y(null);return}if(null==b||b.pause(),e.previewUrl){let t=new Audio(e.previewUrl);t.addEventListener("ended",()=>{y(null)}),t.addEventListener("error",e=>{y(null)}),t.play().catch(e=>{y(null)}),N(t),y(e.id)}})(e),isSaved:d(e.id),onToggleSaved:()=>u(e)},e.id)),!t&&!p&&0===E.length&&(0,r.jsx)("div",{className:"text-muted-foreground text-sm",children:a?"No sounds found":"No sounds available"}),v&&(0,r.jsx)("div",{className:"text-muted-foreground text-sm text-center py-4",children:"Loading more sounds..."})]})})})]})}function ec(){let{savedSounds:e,isLoadingSavedSounds:t,savedSoundsError:a,loadSavedSounds:n,isSoundSaved:i,toggleSavedSound:l,clearSavedSounds:s}=en(),[c,d]=(0,o.useState)(null),[u,m]=(0,o.useState)(null),[f,h]=(0,o.useState)(!1);(0,o.useEffect)(()=>{n()},[n]);let p=e=>({id:e.id,name:e.name,description:"",url:"",previewUrl:e.previewUrl,downloadUrl:e.downloadUrl,duration:e.duration,filesize:0,type:"audio",channels:0,bitrate:0,bitdepth:0,samplerate:0,username:e.username,tags:e.tags,license:e.license,created:e.savedAt,downloads:0,rating:0,ratingCount:0});return t?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)("div",{className:"text-muted-foreground text-sm",children:"Loading saved sounds..."})}):a?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsxs)("div",{className:"text-destructive text-sm",children:["Error: ",a]})}):0===e.length?(0,r.jsxs)("div",{className:"bg-panel h-full p-4 flex flex-col items-center justify-center gap-3",children:[(0,r.jsx)(Q.A,{className:"w-10 h-10 text-muted-foreground",strokeWidth:1.5}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 text-center",children:[(0,r.jsx)("p",{className:"text-lg font-medium",children:"No saved sounds"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-balance",children:"Click the heart icon on any sound to save it here"})]})]}):(0,r.jsxs)("div",{className:"flex flex-col gap-5 mt-1 h-full",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.length," saved"," ",1===e.length?"sound":"sounds"]}),(0,r.jsxs)(ei.lG,{open:f,onOpenChange:h,children:[(0,r.jsx)(ei.zM,{asChild:!0,children:(0,r.jsx)(w.$,{variant:"text",size:"sm",className:"h-auto text-muted-foreground hover:text-destructive !opacity-100",children:"Clear all"})}),(0,r.jsxs)(ei.Cf,{children:[(0,r.jsxs)(ei.c7,{children:[(0,r.jsx)(ei.L3,{children:"Clear all saved sounds?"}),(0,r.jsxs)(ei.rr,{children:["This will permanently remove all ",e.length," saved sounds from your collection. This action cannot be undone."]})]}),(0,r.jsxs)(ei.Es,{children:[(0,r.jsx)(w.$,{variant:"text",onClick:()=>h(!1),children:"Cancel"}),(0,r.jsx)(w.$,{variant:"destructive",onClick:async()=>{await s(),h(!1)},children:"Clear all sounds"})]})]})]})]}),(0,r.jsx)("div",{className:"relative h-full overflow-hidden",children:(0,r.jsx)(O.F,{className:"flex-1 h-full",children:(0,r.jsx)("div",{className:"flex flex-col gap-4",children:e.map(e=>(0,r.jsx)(eu,{sound:p(e),isPlaying:c===e.id,onPlay:()=>(e=>{if(c===e.id){null==u||u.pause(),d(null);return}if(null==u||u.pause(),e.previewUrl){let t=new Audio(e.previewUrl);t.addEventListener("ended",()=>{d(null)}),t.addEventListener("error",e=>{d(null)}),t.play().catch(e=>{d(null)}),m(t),d(e.id)}})(e),isSaved:i(e.id),onToggleSaved:()=>l(p(e))},e.id))})})})]})}function ed(){return(0,r.jsx)("div",{children:"Songs"})}function eu(e){let{sound:t,isPlaying:a,onPlay:n,isSaved:i,onToggleSaved:l}=e,{addSoundToTimeline:s}=en(),o=async e=>{e.stopPropagation(),await s(t)};return(0,r.jsxs)("div",{className:"group flex items-center gap-3 opacity-100 hover:opacity-75 transition-opacity cursor-pointer",onClick:()=>{n()},children:[(0,r.jsxs)("div",{className:"relative w-12 h-12 bg-accent rounded-md flex items-center justify-center overflow-hidden shrink-0",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/20 to-transparent"}),a?(0,r.jsx)(ee.A,{className:"w-5 h-5"}):(0,r.jsx)(et.A,{className:"w-5 h-5"})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0 overflow-hidden",children:[(0,r.jsx)("p",{className:"font-medium truncate text-sm",children:t.name}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground truncate block",children:t.username})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 pr-2",children:[(0,r.jsx)(w.$,{variant:"text",size:"icon",className:"text-muted-foreground hover:text-foreground !opacity-100 w-auto",onClick:o,title:"Add to timeline",children:(0,r.jsx)(T.A,{className:"w-4 h-4"})}),(0,r.jsx)(w.$,{variant:"text",size:"icon",className:"hover:text-foreground !opacity-100 w-auto ".concat(i?"text-red-500 hover:text-red-600":"text-muted-foreground"),onClick:e=>{e.stopPropagation(),l()},title:i?"Remove from saved":"Save sound",children:(0,r.jsx)(Q.A,{className:"w-4 h-4 ".concat(i?"fill-current":"")})})]})]})}let em=["https://api.iconify.design","https://api.simplesvg.com","https://api.unisvg.com"],ef=em[0];async function eh(e){for(let t of em)try{let a=await fetch("".concat(t).concat(e),{signal:AbortSignal.timeout(2e3)});if(a.ok)return ef=t,a}catch(e){}throw Error("All API hosts failed")}async function ep(e){try{let t=await eh("/collections?pretty=1"),a=await t.json();if(e)return Object.fromEntries(Object.entries(a).filter(t=>{let[a,r]=t;return r.category===e}));return a}catch(e){return{}}}async function ex(e){try{let t=await eh("/collection?prefix=".concat(e,"&pretty=1"));return await t.json()}catch(e){return null}}async function eg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=new URLSearchParams({query:e,limit:t.toString(),pretty:"1"});(null==a?void 0:a.length)&&n.append("prefixes",a.join(",")),r&&n.append("category",r);try{let e=await eh("/search?".concat(n));return await e.json()}catch(e){return{icons:[],total:0,limit:t,start:0,collections:{}}}}function ev(e,t,a){let[r,n]=t.includes(":")?t.split(":"):["",t];if(!r||!n)throw Error('Invalid icon name format. Expected "prefix:name"');let i=new URLSearchParams;(null==a?void 0:a.color)&&i.append("color",a.color.replace("#","%23")),(null==a?void 0:a.width)&&i.append("width",a.width.toString()),(null==a?void 0:a.height)&&i.append("height",a.height.toString()),(null==a?void 0:a.flip)&&i.append("flip",a.flip),(null==a?void 0:a.rotate)&&i.append("rotate",a.rotate.toString());let l=i.toString();return"".concat(e,"/").concat(r,"/").concat(n,".svg").concat(l?"?"+l:"")}async function ej(e,t){let a=ev(ef,e,t),r=await fetch(a);if(!r.ok)throw Error("Failed to download SVG: ".concat(r.statusText));return await r.text()}let ey={general:[{prefix:"mdi",name:"Material Design Icons"},{prefix:"ic",name:"Google Material Icons"},{prefix:"ph",name:"Phosphor"},{prefix:"heroicons",name:"Heroicons"},{prefix:"lucide",name:"Lucide"},{prefix:"tabler",name:"Tabler Icons"},{prefix:"fe",name:"Feather Icons"},{prefix:"bi",name:"Bootstrap Icons"}],brands:[{prefix:"simple-icons",name:"Simple Icons"},{prefix:"logos",name:"SVG Logos"},{prefix:"skill-icons",name:"Skill Icons"},{prefix:"devicon",name:"Devicon"},{prefix:"fa-brands",name:"Font Awesome Brands"}],emoji:[{prefix:"noto",name:"Noto Emoji"},{prefix:"twemoji",name:"Twemoji"},{prefix:"fluent-emoji",name:"Fluent Emoji"},{prefix:"fluent-emoji-flat",name:"Fluent Emoji Flat"},{prefix:"emojione",name:"EmojiOne"},{prefix:"openmoji",name:"OpenMoji"}]},ew=(0,ea.v)((e,t)=>({searchQuery:"",selectedCategory:"all",selectedCollection:null,viewMode:"browse",collections:{},currentCollection:null,searchResults:null,recentStickers:[],isLoadingCollections:!1,isLoadingCollection:!1,isSearching:!1,isDownloading:!1,setSearchQuery:t=>e({searchQuery:t}),setSelectedCategory:t=>e({selectedCategory:t,viewMode:"browse",selectedCollection:null,currentCollection:null}),setSelectedCollection:a=>{e({selectedCollection:a,viewMode:a?"collection":"browse",currentCollection:null}),a&&t().loadCollection(a)},setViewMode:t=>e({viewMode:t}),loadCollections:async()=>{e({isLoadingCollections:!0});try{let t=await ep();e({collections:t})}catch(e){}finally{e({isLoadingCollections:!1})}},loadCollection:async t=>{e({isLoadingCollection:!0});try{let a=await ex(t);e({currentCollection:a})}catch(t){e({currentCollection:null})}finally{e({isLoadingCollection:!1})}},searchStickers:async a=>{if(!a.trim())return void e({searchResults:null,viewMode:"browse"});let{selectedCategory:r}=t();e({isSearching:!0,viewMode:"search"});try{let t;"all"!==r&&("general"===r?t="General":"brands"===r?t="Brands / Social":"emoji"===r&&(t="Emoji"));let n=await eg(a,100,void 0,t);e({searchResults:n})}catch(t){e({searchResults:null})}finally{e({isSearching:!1})}},downloadSticker:async a=>{e({isDownloading:!0});try{let e=await ej(a,{width:200,height:200}),r="".concat(a.replace(":","-"),".svg"),n=new File([new Blob([e],{type:"image/svg+xml"})],r,{type:"image/svg+xml"});return t().addToRecentStickers(a),n}catch(e){return null}finally{e({isDownloading:!1})}},addToRecentStickers:t=>{e(e=>({recentStickers:[t,...e.recentStickers.filter(e=>e!==t)].slice(0,50)}))},clearRecentStickers:()=>e({recentStickers:[]})}));var eb=a(88603),eN=a(38333),eS=a(42962),eC=a(9278),ek=a(79649),eE=a(26172),eT=a(45186),eR=a(15700),eA=a(30461),eM=a(31872);function eI(){let{selectedCategory:e,setSelectedCategory:t}=ew();return(0,r.jsx)("div",{className:"h-full flex flex-col",children:(0,r.jsxs)(H,{value:e,onValueChange:e=>{["all","general","brands","emoji"].includes(e)&&t(e)},className:"flex flex-col h-full",children:[(0,r.jsx)("div",{className:"px-3 pt-4 pb-0",children:(0,r.jsxs)($,{children:[(0,r.jsxs)(X,{value:"all",className:"gap-1",children:[(0,r.jsx)(eb.A,{className:"h-3 w-3"}),"All"]}),(0,r.jsxs)(X,{value:"general",className:"gap-1",children:[(0,r.jsx)(eN.A,{className:"h-3 w-3"}),"Icons"]}),(0,r.jsxs)(X,{value:"brands",className:"gap-1",children:[(0,r.jsx)(eS.A,{className:"h-3 w-3"}),"Brands"]}),(0,r.jsxs)(X,{value:"emoji",className:"gap-1",children:[(0,r.jsx)(eC.A,{className:"h-3 w-3"}),"Emoji"]})]})}),(0,r.jsx)(B.Separator,{className:"my-4"}),(0,r.jsx)(V,{value:"all",className:"px-3 pt-0 mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(ez,{category:"all"})}),(0,r.jsx)(V,{value:"general",className:"px-3 pt-0 mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(ez,{category:"general"})}),(0,r.jsx)(V,{value:"brands",className:"px-3 pt-0 mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(ez,{category:"brands"})}),(0,r.jsx)(V,{value:"emoji",className:"px-3 pt-0 mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(ez,{category:"emoji"})})]})})}function eP(e){let{icons:t,onAdd:a,addingSticker:n,capSize:i=!1}=e;return(0,r.jsx)("div",{className:"grid gap-2",style:{gridTemplateColumns:i?"repeat(auto-fill, minmax(var(--sticker-min, 96px), var(--sticker-max, 160px)))":"repeat(auto-fit, minmax(var(--sticker-min, 96px), 1fr))","--sticker-min":"96px",...i?{"--sticker-max":"160px"}:{}},children:t.map(e=>(0,r.jsx)(e_,{iconName:e,onAdd:a,isAdding:n===e,capSize:i},e))})}function eL(e){let{collections:t,onSelectCollection:a}=e;return(0,r.jsx)("div",{className:"grid grid-cols-1 gap-2",children:t.map(e=>(0,r.jsx)(eF,{title:e.name,subtitle:"".concat(e.total.toLocaleString()," icons").concat(e.category?" • ".concat(e.category):""),onClick:()=>a(e.prefix)},e.prefix))})}function eD(e){let{message:t}=e;return(0,r.jsxs)("div",{className:"bg-panel h-full p-4 flex flex-col items-center justify-center gap-3",children:[(0,r.jsx)(ek.A,{className:"w-10 h-10 text-muted-foreground",strokeWidth:1.5}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 text-center",children:[(0,r.jsx)("p",{className:"text-lg font-medium",children:"No stickers found"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-balance",children:t})]})]})}function ez(e){let{category:t}=e,{activeProject:a}=(0,I.Iw)(),{addMediaAtTime:n}=(0,P.A)(),{currentTime:i}=(0,R.E)(),{addMediaItem:s}=(0,u.B)(),{searchQuery:c,selectedCollection:d,viewMode:m,collections:f,currentCollection:h,searchResults:x,recentStickers:g,isLoadingCollections:v,isLoadingCollection:j,isSearching:b,setSearchQuery:N,setSelectedCollection:S,loadCollections:C,searchStickers:k,downloadSticker:E,clearRecentStickers:T,setSelectedCategory:A}=ew(),[M,L]=(0,o.useState)(null),[D,z]=(0,o.useState)(c),[F,_]=(0,o.useState)(20),[B,U]=(0,o.useState)(!1),H=(0,o.useMemo)(()=>{if("all"===t)return Object.entries(f).map(e=>{let[t,a]=e;return{prefix:t,name:a.name,total:a.total,category:a.category}});let e=ey[t];return e?e.map(e=>{let t=f[e.prefix];return t?{prefix:e.prefix,name:e.name,total:t.total}:null}).filter(Boolean):[]},[f,t]),{scrollAreaRef:$,handleScroll:X}=el({onLoadMore:()=>_(e=>e+20),hasMore:H.length>F,isLoading:v,enabled:"browse"===m&&!d&&"all"===t});(0,o.useEffect)(()=>{0===Object.keys(f).length&&C()},[]),(0,o.useEffect)(()=>{let e=setTimeout(()=>{D!==c&&(N(D),D.trim()&&k(D))},500);return()=>clearTimeout(e)},[D]);let V=async e=>{if(!a)return void y.oR.error("No active project");L(e);try{let t=await E(e);if(!t)throw Error("Failed to download sticker");let r={name:e.replace(":","-"),type:"image",file:t,url:URL.createObjectURL(t),width:200,height:200,duration:Z.of.DEFAULT_IMAGE_DURATION,ephemeral:!1};await s(a.id,r);let l=u.B.getState().mediaItems.find(e=>e.url===r.url&&e.name===r.name);if(!l)throw Error("Sticker not in media store");n(l,i),y.oR.success('Added "'.concat(e,'" to timeline'))}catch(e){y.oR.error("Failed to add sticker to timeline")}finally{L(null)}},W=(0,o.useMemo)(()=>{if("search"===m&&x)return x.icons;if("collection"===m&&h){let e=[];return h.uncategorized&&e.push(...h.uncategorized.map(e=>"".concat(h.prefix,":").concat(e))),h.categories&&Object.values(h.categories).forEach(t=>{e.push(...t.map(e=>"".concat(h.prefix,":").concat(e)))}),e.slice(0,100)}return[]},[m,x,h]),Y="collection"===m&&!!d;return(0,o.useEffect)(()=>{if(Y){U(!1);let e=setTimeout(()=>U(!0),350);return()=>clearTimeout(e)}U(!1)},[Y]),(0,r.jsxs)("div",{className:"flex flex-col gap-5 mt-1 h-full",children:[(0,r.jsx)("div",{className:"space-y-3",children:(0,r.jsx)(eM.W,{isExpanded:Y,setIsExpanded:e=>{!e&&Y&&S(null)},placeholder:"all"===t?"Search all stickers":"general"===t?"Search icons":"brands"===t?"Search brands":"Search Emojis",value:D,onChange:z})}),(0,r.jsx)("div",{className:"relative h-full overflow-hidden",children:(0,r.jsx)(O.F,{className:"flex-1 h-full",ref:$,onScrollCapture:X,children:(0,r.jsxs)("div",{className:"flex flex-col gap-4 h-full",children:[g.length>0&&"browse"===m&&(0,r.jsxs)("div",{className:"h-full",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(eE.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"Recent"}),(0,r.jsx)(l.Bc,{children:(0,r.jsxs)(l.m_,{children:[(0,r.jsx)(l.k$,{asChild:!0,children:(0,r.jsx)("button",{onClick:T,className:"ml-auto h-5 w-5 p-0 rounded hover:bg-accent flex items-center justify-center",children:(0,r.jsx)(eT.A,{className:"h-3 w-3 text-muted-foreground"})})}),(0,r.jsx)(l.ZI,{children:(0,r.jsx)("p",{children:"Clear recent stickers"})})]})})]}),(0,r.jsx)(eP,{icons:g.slice(0,12),onAdd:V,addingSticker:M,capSize:!0})]}),"collection"===m&&d&&(0,r.jsx)("div",{className:"h-full",children:j?(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)(p.A,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):B?(0,r.jsx)(eP,{icons:W,onAdd:V,addingSticker:M}):(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)(p.A,{className:"h-6 w-6 animate-spin text-muted-foreground"})})}),"search"===m&&(0,r.jsx)("div",{className:"h-full",children:b?(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)(p.A,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(null==x?void 0:x.icons.length)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:[x.total," results"]})}),(0,r.jsx)(eP,{icons:W,onAdd:V,addingSticker:M,capSize:!0})]}):c?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[(0,r.jsx)(eD,{message:'No stickers found for "'.concat(c,'"')}),"all"!==t&&(0,r.jsx)(w.$,{variant:"outline",onClick:()=>{let e=D||c;e&&N(e),A("all"),e&&k(e)},children:"Search in all icons"})]}):null}),"browse"===m&&!d&&(0,r.jsx)("div",{className:"space-y-4 h-full",children:v?(0,r.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,r.jsx)(p.A,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(0,r.jsxs)(r.Fragment,{children:["all"!==t&&(0,r.jsxs)("div",{className:"h-full",children:[(0,r.jsxs)("h3",{className:"text-sm font-medium mb-2",children:["Popular"," ","general"===t?"Icon Sets":"brands"===t?"Brand Icons":"Emoji Sets"]}),(0,r.jsx)(eL,{collections:H,onSelectCollection:S})]}),"all"===t&&H.length>0&&(0,r.jsx)("div",{className:"h-full",children:(0,r.jsx)(eL,{collections:H.slice(0,F),onSelectCollection:S})})]})})]})})})]})}function eF(e){let{title:t,subtitle:a,onClick:n}=e;return(0,r.jsxs)(w.$,{variant:"outline",className:"justify-between h-auto py-2 ",onClick:n,children:[(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("p",{className:"font-medium",children:t}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:a})]}),(0,r.jsx)(eR.A,{className:"h-4 w-4"})]})}function e_(e){let{iconName:t,onAdd:a,isAdding:i,capSize:s=!1}=e,[c,d]=(0,o.useState)(!1),[u,m]=(0,o.useState)(0);(0,o.useEffect)(()=>{d(!1),m(0)},[t]);let f=t.split(":")[1]||t,h=t.split(":")[0],x=c?(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center p-2",children:(0,r.jsx)("span",{className:"text-xs text-muted-foreground text-center break-all",children:f})}):(0,r.jsx)("div",{className:"w-full h-full p-4 flex items-center justify-center",children:(0,r.jsx)(eA.default,{src:0===u?ev(ef,t,{width:64,height:64}):ev(em[Math.min(u,em.length-1)],t,{width:64,height:64}),alt:f,width:64,height:64,className:"w-full h-full object-contain",style:s?{maxWidth:"var(--sticker-max, 160px)",maxHeight:"var(--sticker-max, 160px)"}:void 0,onError:()=>{let e=u+1;e<em.length?m(e):d(!0)},loading:"lazy",unoptimized:!0})});return(0,r.jsxs)(l.m_,{children:[(0,r.jsx)(l.k$,{asChild:!0,children:(0,r.jsxs)("div",{className:(0,n.cn)("relative",i&&"opacity-50 pointer-events-none"),children:[(0,r.jsx)(A,{name:f,preview:x,dragData:{type:"sticker",iconName:t,name:f},onAddToTimeline:()=>a(t),aspectRatio:1,showLabel:!1,rounded:!0,variant:"card",className:"",containerClassName:"w-full",isDraggable:!1}),i&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center rounded-md z-10",children:(0,r.jsx)(p.A,{className:"h-6 w-6 animate-spin text-white"})})]})}),(0,r.jsx)(l.ZI,{children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"font-medium",children:f}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:h})]})})]})}var eO=a(52801),eB=a(34248),eU=a(75141);let eH=["#ffffff","#000000","#ffe2e2","#ffc9c9","#ffa2a2","#ff6467","#fb2c36","#e7000b","#c10007","#9f0712","#82181a","#460809","#fff7ed","#ffedd4","#ffd6a7","#ffb86a","#ff8904","#ff6900","#f54900","#ca3500","#9f2d00","#7e2a0c","#441306","#fffbeb","#fef3c6","#fee685","#ffd230","#ffb900","#fe9a00","#e17100","#bb4d00","#973c00","#7b3306","#461901","#fefce8","#fef9c2","#fff085","#ffdf20","#fdc700","#f0b100","#d08700","#a65f00","#894b00","#733e0a","#432004","#f7fee7","#ecfcca","#d8f999","#bbf451","#9ae600","#7ccf00","#5ea500","#497d00","#3c6300","#35530e","#192e03","#f0fdf4","#dcfce7","#b9f8cf","#7bf1a8","#05df72","#00c950","#00a63e","#008236","#016630","#0d542b","#032e15","#ecfdf5","#d0fae5","#a4f4cf","#5ee9b5","#00d492","#00bc7d","#009966","#007a55","#006045","#004f3b","#002c22","#f0fdfa","#cbfbf1","#96f7e4","#46ecd5","#00d5be","#00bba7","#009689","#00786f","#005f5a","#0b4f4a","#022f2e","#ecfeff","#cefafe","#a2f4fd","#53eafd","#00d3f2","#00b8db","#0092b8","#007595","#005f78","#104e64","#053345","#f0f9ff","#dff2fe","#b8e6fe","#74d4ff","#00bcff","#00a6f4","#0084d1","#0069a8","#00598a","#024a70","#052f4a","#eff6ff","#dbeafe","#bedbff","#8ec5ff","#51a2ff","#2b7fff","#155dfc","#1447e6","#193cb8","#1c398e","#162456","#eef2ff","#e0e7ff","#c6d2ff","#a3b3ff","#7c86ff","#615fff","#4f39f6","#432dd7","#372aac","#312c85","#1e1a4d","#f5f3ff","#ede9fe","#ddd6ff","#c4b4ff","#a684ff","#8e51ff","#7f22fe","#7008e7","#5d0ec0","#4d179a","#2f0d68","#faf5ff","#f3e8ff","#e9d4ff","#dab2ff","#c27aff","#ad46ff","#9810fa","#8200db","#6e11b0","#59168b","#3c0366","#fdf4ff","#fae8ff","#f6cfff","#f4a8ff","#ed6aff","#e12afb","#c800de","#a800b7","#8a0194","#721378","#4b004f","#fdf2f8","#fce7f3","#fccee8","#fda5d5","#fb64b6","#f6339a","#e60076","#c6005c","#a3004c","#861043","#510424","#fff1f2","#ffe4e6","#ffccd3","#ffa1ad","#ff637e","#ff2056","#ec003f","#c70036","#a50036","#8b0836","#4d0218","#f8fafc","#f1f5f9","#e2e8f0","#cad5e2","#90a1b9","#62748e","#45556c","#314158","#1d293d","#0f172b","#020618","#f9fafb","#f3f4f6","#e5e7eb","#d1d5dc","#99a1af","#6a7282","#4a5565","#364153","#1e2939","#101828","#030712","#fafafa","#f4f4f5","#e4e4e7","#d4d4d8","#9f9fa9","#71717b","#52525c","#3f3f46","#27272a","#18181b","#09090b","#f5f5f5","#e5e5e5","#d4d4d4","#a1a1a1","#737373","#525252","#404040","#262626","#171717","#0a0a0a","#fafaf9","#f5f5f4","#e7e5e4","#d6d3d1","#a6a09b","#79716b","#57534d","#44403b","#292524","#1c1917","#0c0a09"],e$=["radial-gradient(circle at 30% 70%, rgba(173, 216, 230, 0.35), transparent 60%), radial-gradient(circle at 70% 30%, rgba(255, 182, 193, 0.4), transparent 60%)","radial-gradient(circle at 20% 80%, rgba(255, 182, 153, 0.3) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(255, 244, 214, 0.5) 0%, transparent 50%), radial-gradient(circle at 40% 40%, rgba(255, 182, 153, 0.1) 0%, transparent 50%), #fff8f0","radial-gradient(circle at 20% 80%, rgba(255, 160, 146, 0.25) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(255, 244, 228, 0.3) 0%, transparent 50%), radial-gradient(circle at 40% 40%, rgba(255, 160, 146, 0.15) 0%, transparent 50%), #fef9f7","radial-gradient(circle at center, #8FFFB0, transparent), white","radial-gradient(circle at top right, rgba(173, 109, 244, 0.5), transparent 70%)","radial-gradient(circle at top right, rgba(56, 193, 182, 0.5), transparent 70%)","radial-gradient(circle at top right, rgba(255, 140, 60, 0.5), transparent 70%)","radial-gradient(circle at top right, rgba(70, 130, 180, 0.5), transparent 70%)","radial-gradient(circle at top left, rgba(173, 109, 244, 0.5), transparent 70%)","linear-gradient(120deg, #d5c5ff 0%, #a7f3d0 50%, #f0f0f0 100%)"];var eX=a(2245),eV=a(86197),eW=a(90172),eY=a(60079),eZ=a(84787);let eK=["linear-gradient(to right, #22d3ee, #0ea5e9, #0284c7)","linear-gradient(to right, #bfdbfe, #a5f3fc)","linear-gradient(to right, #22d3ee, #0ea5e9, #0284c7)","linear-gradient(to right, #e9d5ff, #d8b4fe, #c084fc)","linear-gradient(to right, #c4b5fd, #a78bfa, #8b5cf6)","linear-gradient(to right, #93c5fd, #60a5fa, #3b82f6)","linear-gradient(to right, #93c5fd, #60a5fa, #3b82f6)","linear-gradient(to right, #6ee7b7, #34d399, #10b981)","linear-gradient(to right, #d1fae5, #a7f3d0, #6ee7b7)","linear-gradient(to right, #fca5a5, #f87171, #ef4444)","linear-gradient(to right, #fde68a, #fbbf24, #f59e0b)","linear-gradient(to right, #fbcfe8, #f9a8d4, #f472b6)","radial-gradient(circle at bottom left, #ff00ff, #00ffff)"],eG=null,eq=!1;class eJ{static async init(){if(!eq)try{let e,t,r,n;eG=(await Promise.all([a.e(1282),a.e(8265),a.e(9618),a.e(3047),a.e(4986),a.e(7761)]).then(a.bind(a,87249))).api;let i="3000"===window.location.port||"3001"===window.location.port||"localhost"===window.location.hostname&&"8188"!==window.location.port,l=window.location.pathname.startsWith("/opencut");i?(e=window.location.hostname,t=window.location.port,r="ws",n="http",eG.apiURL&&(eG.apiURL=e=>e.startsWith("/")?e:"/".concat(e)),eG.websocketURL&&(eG.websocketURL=()=>null),eG.createSocket&&(eG.createSocket,eG.createSocket=function(){return null}),Object.defineProperty(eG,"socket",{get:()=>null,set(e){},configurable:!0})):(l?(e=window.location.hostname,t=window.location.port||"8188",n=window.location.protocol.replace(":",""),r="https"===n?"wss":"ws",eG.apiURL&&(eG.apiURL=a=>{let r=a.replace(/^\/opencut/,"");return"".concat(n,"://").concat(e,":").concat(t).concat(r)})):(e="127.0.0.1",t="8188",n="http",r="ws",eG.apiURL&&(eG.apiURL=a=>"".concat(n,"://").concat(e,":").concat(t).concat(a.startsWith("/")?a:"/".concat(a)))),eG.websocketURL&&(eG.websocketURL=()=>"".concat(r,"://").concat(e,":").concat(t,"/ws"))),void 0!==eG.api_base&&(eG.api_base=i?"":"".concat(n,"://").concat(e,":").concat(t)),void 0!==eG.apiHost&&(eG.apiHost="".concat(e,":").concat(t)),i?eG.apiBase&&(eG.apiBase=""):eG.init(),eq=!0}catch(e){}}static async checkStatus(){try{if(await this.init(),!eG)return{status:"error",message:"ComfyUI API not initialized"};return await eG.getSystemStats(),{status:"success",message:"Connected to ComfyUI"}}catch(e){return{status:"error",message:"Unable to connect to ComfyUI. Make sure ComfyUI is running."}}}static async getSystemInfo(){try{if(await this.init(),!eG)return null;return await eG.getSystemStats()}catch(e){return null}}static async getModels(){try{return await this.init(),[]}catch(e){return[]}}static async getSamplers(){try{return await this.init(),[]}catch(e){return[]}}}function eQ(){return(0,r.jsx)(e0,{})}function e0(){return(0,r.jsx)(Y,{defaultTab:"project-info",tabs:[{value:"project-info",label:"Project info",content:(0,r.jsx)(e1,{})},{value:"background",label:"Background",content:(0,r.jsx)(e4,{})},{value:"comfyui",label:"Comfyui",content:(0,r.jsx)(e3,{})}]})}function e1(){let{activeProject:e,updateProjectFps:t,updateCanvasSize:a}=(0,I.Iw)(),{canvasPresets:n}=(0,eU.U)(),{getDisplayName:i}=function(){let{canvasPresets:e}=(0,eU.U)(),{activeProject:t}=(0,I.Iw)(),{mediaItems:a}=(0,u.B)(),{tracks:r}=(0,P.A)(),n=(null==t?void 0:t.canvasSize)||I.lm,i=(null==t?void 0:t.canvasMode)||"preset",l=e.find(e=>e.width===n.width&&e.height===n.height),s=()=>n.width/n.height,o=e=>{for(let{ratio:t,label:a}of[{ratio:16/9,label:"16:9"},{ratio:9/16,label:"9:16"},{ratio:1,label:"1:1"},{ratio:4/3,label:"4:3"},{ratio:3/4,label:"3:4"},{ratio:21/9,label:"21:9"}])if(.01>Math.abs(e-t))return a;return e.toFixed(2)};return{currentPreset:l,canvasMode:i,isOriginal:"original"===i,getCurrentAspectRatio:s,getOriginalAspectRatio:()=>{for(let e of r)for(let t of e.elements)if("media"===t.type){let e=a.find(e=>e.id===t.mediaId);if(e&&("video"===e.type||"image"===e.type))return(0,u.C)(e)}return 16/9},formatAspectRatio:o,getDisplayName:()=>"original"===i?"Original":l?l.name:o(s()),canvasSize:n,canvasPresets:e}}();return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)(eB.DC,{direction:"column",children:[(0,r.jsx)(eB.Tq,{children:"Name"}),(0,r.jsx)(eB.Wg,{children:(null==e?void 0:e.name)||"Untitled project"})]}),(0,r.jsxs)(eB.DC,{direction:"column",children:[(0,r.jsx)(eB.Tq,{children:"Aspect ratio"}),(0,r.jsx)(eB.Wg,{children:(0,r.jsxs)(eO.l6,{value:i(),onValueChange:e=>{let t=n.find(t=>t.name===e);t&&a({width:t.width,height:t.height},"preset")},children:[(0,r.jsx)(eO.bq,{className:"bg-panel-accent",children:(0,r.jsx)(eO.yv,{placeholder:"Select an aspect ratio"})}),(0,r.jsx)(eO.gC,{children:n.map(e=>(0,r.jsx)(eO.eb,{value:e.name,children:e.name},e.name))})]})})]}),(0,r.jsxs)(eB.DC,{direction:"column",children:[(0,r.jsx)(eB.Tq,{children:"Frame rate"}),(0,r.jsx)(eB.Wg,{children:(0,r.jsxs)(eO.l6,{value:((null==e?void 0:e.fps)||30).toString(),onValueChange:e=>{t(parseFloat(e))},children:[(0,r.jsx)(eO.bq,{className:"bg-panel-accent",children:(0,r.jsx)(eO.yv,{placeholder:"Select a frame rate"})}),(0,r.jsx)(eO.gC,{children:Z.Tm.map(e=>(0,r.jsx)(eO.eb,{value:e.value,children:e.label},e.value))})]})})]})]})}let e2=(0,o.memo)(e=>{let{blur:t,isSelected:a,onSelect:i}=e;return(0,r.jsxs)("div",{className:(0,n.cn)("w-full aspect-square rounded-sm cursor-pointer border border-foreground/15 hover:border-primary relative overflow-hidden",a&&"border-2 border-primary"),onClick:i,children:[(0,r.jsx)(eA.default,{src:"https://images.unsplash.com/photo-1501785888041-af3ef285b470?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",alt:"Blur preview ".concat(t.label),fill:!0,className:"object-cover",style:{filter:"blur(".concat(t.value,"px)")},loading:"eager"}),(0,r.jsx)("div",{className:"absolute bottom-1 left-1 right-1 text-center",children:(0,r.jsx)("span",{className:"text-xs text-white bg-black/50 px-1 rounded",children:t.label})})]})});e2.displayName="BlurPreview";let e5=(0,o.memo)(e=>{let{backgrounds:t,currentBackgroundColor:a,isColorBackground:i,handleColorSelect:l,useBackgroundColor:s=!1}=e;return(0,o.useMemo)(()=>t.map(e=>(0,r.jsx)("div",{className:(0,n.cn)("w-full aspect-square rounded-sm cursor-pointer border border-foreground/15 hover:border-primary",i&&e===a&&"border-2 border-primary"),style:s?{backgroundColor:e}:{background:e,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},onClick:()=>l(e)},e)),[t,i,a,l,s])});function e4(){let{activeProject:e,updateBackgroundType:t}=(0,I.Iw)(),a=(0,o.useMemo)(()=>[{label:"Light",value:4},{label:"Medium",value:8},{label:"Heavy",value:18}],[]),n=(0,o.useCallback)(async e=>{await t("blur",{blurIntensity:e})},[t]),i=(0,o.useCallback)(async e=>{await t("color",{backgroundColor:e})},[t]),l=(null==e?void 0:e.blurIntensity)||8,s=(null==e?void 0:e.backgroundType)==="blur",c=(null==e?void 0:e.backgroundColor)||"#000000",d=(null==e?void 0:e.backgroundType)==="color",u=(0,o.useMemo)(()=>a.map(e=>(0,r.jsx)(e2,{blur:e,isSelected:s&&l===e.value,onSelect:()=>n(e.value)},e.value)),[a,s,l,n]);return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsx)(eB.Zf,{title:"Blur",defaultExpanded:!1,children:(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 w-full",children:u})}),(0,r.jsx)(eB.Zf,{title:"Colors",defaultExpanded:!1,children:(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-2 w-full",children:[(0,r.jsx)("div",{className:"w-full aspect-square rounded-sm cursor-pointer border border-foreground/15 hover:border-primary flex items-center justify-center",children:(0,r.jsx)(eX.A,{className:"size-4"})}),(0,r.jsx)(e5,{backgrounds:eH,currentBackgroundColor:c,isColorBackground:d,handleColorSelect:i,useBackgroundColor:!0})]})}),(0,r.jsx)(eB.Zf,{title:"Pattern Craft",defaultExpanded:!1,children:(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 w-full",children:(0,r.jsx)(e5,{backgrounds:e$,currentBackgroundColor:c,isColorBackground:d,handleColorSelect:i})})}),(0,r.jsx)(eB.Zf,{title:"Syntax UI",defaultExpanded:!1,children:(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 w-full",children:(0,r.jsx)(e5,{backgrounds:eK,currentBackgroundColor:c,isColorBackground:d,handleColorSelect:i})})})]})}function e3(){let[e,t]=(0,o.useState)({status:"idle",message:"Click to check connection status"}),[a,i]=(0,o.useState)(null),l=window.location.pathname.startsWith("/opencut"),s=(0,o.useCallback)(async()=>{t({status:"loading",message:"Checking connection..."});try{let e=await eJ.checkStatus();if(t({status:e.status,message:e.message}),"success"===e.status){let e=await eJ.getSystemInfo();i(e)}}catch(e){t({status:"error",message:"Failed to check connection"})}},[]);return(0,o.useEffect)(()=>{l&&s()},[l,s]),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)(eB.DC,{direction:"column",children:[(0,r.jsx)(eB.Tq,{children:"Environment"}),(0,r.jsx)(eB.Wg,{children:(0,r.jsx)("div",{className:"flex items-center gap-2",children:l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eW.A,{className:"size-4 text-green-500"}),(0,r.jsx)("span",{className:"text-sm",children:"Running in ComfyUI"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eY.A,{className:"size-4 text-yellow-500"}),(0,r.jsx)("span",{className:"text-sm",children:"Running in standalone mode"})]})})})]}),(0,r.jsxs)(eB.DC,{direction:"column",children:[(0,r.jsx)(eB.Tq,{children:"Connection Status"}),(0,r.jsx)(eB.Wg,{children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(()=>{switch(e.status){case"loading":return(0,r.jsx)(eV.A,{className:"size-4 animate-spin"});case"success":return(0,r.jsx)(eW.A,{className:"size-4 text-green-500"});case"error":return(0,r.jsx)(eY.A,{className:"size-4 text-red-500"});default:return(0,r.jsx)(eZ.A,{className:"size-4"})}})(),(0,r.jsx)("span",{className:(0,n.cn)("text-sm",(()=>{switch(e.status){case"success":return"text-green-500";case"error":return"text-red-500";case"loading":return"text-yellow-500";default:return"text-muted-foreground"}})()),children:e.message})]}),(0,r.jsx)(w.$,{onClick:s,disabled:"loading"===e.status,size:"sm",variant:"outline",className:"w-fit",children:"loading"===e.status?"Checking...":"Check Connection"})]})})]}),a&&(0,r.jsx)(eB.Zf,{title:"System Information",defaultExpanded:!0,children:(0,r.jsx)("div",{className:"flex flex-col gap-2 text-sm",children:Object.entries(a).map(e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("span",{className:"text-muted-foreground",children:[t,":"]}),(0,r.jsx)("span",{children:String(a)})]},t)})})}),(0,r.jsx)(eB.Zf,{title:"ComfyUI Features",defaultExpanded:!1,children:(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,r.jsx)("p",{children:"Future features will include:"}),(0,r.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,r.jsx)("li",{children:"Model selection"}),(0,r.jsx)("li",{children:"Sampler configuration"}),(0,r.jsx)("li",{children:"Workflow integration"}),(0,r.jsx)("li",{children:"Queue management"}),(0,r.jsx)("li",{children:"Real-time generation preview"})]})]})})]})}e5.displayName="BackgroundPreviews";var e8=a(50587),e6=a(90320),e9=a(29584),e7=a(53791);function te(e){let{languages:t}=e;return(0,r.jsx)("div",{className:"absolute -top-[9999px] left-0 pointer-events-none",children:t.map(e=>(0,r.jsx)(e7.A,{countryCode:e.code,svg:!0,style:{width:"1.05rem",height:"1.05rem"}},e.code))})}function tt(e){let{selectedCountry:t,onSelect:a,containerRef:i,languages:l}=e,[s,c]=(0,o.useState)(!1),[d,u]=(0,o.useState)(!1),[m,f]=(0,o.useState)(!1),h="2.5rem",p=(0,o.useRef)(null);(0,o.useEffect)(()=>{if(!s)return;let e=e=>{if(p.current&&!p.current.contains(e.target)){var t;f(!0),setTimeout(()=>f(!1),600),c(!1),null==(t=p.current)||t.blur()}};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s]);let x=l.find(e=>e.code===t),g=e=>{let{code:t,e:r}=e;r.stopPropagation(),r.preventDefault(),a(t),c(!1)};return(0,r.jsxs)("div",{className:"relative w-full h-9",children:[(0,r.jsx)(te,{languages:l}),(0,r.jsx)(e9.P.button,{type:"button",className:(0,n.cn)("absolute w-full h-full flex flex-col overflow-hidden items-start justify-between z-10 rounded-lg px-3 cursor-pointer","!bg-foreground/10 backdrop-blur-md text-foreground py-0","transition-[color,box-shadow] focus:border-ring focus:ring-ring/50 focus:ring-[1px]"),initial:{height:h,scale:1},animate:{height:s?"12rem":h,scale:d?[1,.985,1]:1},transition:{height:{duration:.25,ease:[.4,0,.2,1]},scale:{duration:.6,ease:"easeOut"}},onClick:()=>{var e;u(!0),setTimeout(()=>u(!1),600),c(!0),null==(e=p.current)||e.focus()},ref:p,children:s?(0,r.jsxs)("div",{className:"flex flex-col gap-2 my-2.5 w-full overflow-y-auto scrollbar-hidden",children:[(0,r.jsx)(ta,{language:{code:"auto",name:"Auto"},onSelect:g,selectedCountry:t}),l.map(e=>(0,r.jsx)(ta,{language:e,onSelect:g,selectedCountry:t},e.code))]}):(0,r.jsx)("div",{className:"flex items-center justify-between w-full",style:{height:h},children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["auto"===t?(0,r.jsx)(e8.A,{className:"!size-[1.05rem]"}):(0,r.jsx)(e7.A,{countryCode:t,svg:!0,style:{width:"1.05rem",height:"1.05rem"}}),(0,r.jsx)("span",{className:"pt-[0.05rem]",children:"auto"===t?"Auto":null==x?void 0:x.name})]})})}),(0,r.jsx)(e9.P.div,{className:"absolute top-1/2 right-3 -translate-y-1/2 pointer-events-none z-20 mt-0.5",initial:{opacity:1},animate:{opacity:+!s},transition:{duration:.2,ease:"easeInOut"},children:(0,r.jsx)(e6.A,{className:"text-muted-foreground size-4"})})]})}function ta(e){let{language:t,onSelect:a,selectedCountry:n}=e;return(0,r.jsxs)("button",{type:"button",className:"flex items-center gap-2 cursor-pointer text-foreground hover:text-foreground/75",onClick:e=>a({code:t.code,e}),children:["auto"===t.code?(0,r.jsx)(e8.A,{className:"!size-[1.0rem]"}):(0,r.jsx)(e7.A,{countryCode:t.code,svg:!0,style:{width:"1.05rem",height:"1.05rem"}}),(0,r.jsx)("span",{className:"pt-[0.05rem]",children:t.name})]})}var tr=a(70028);async function tn(e){let t=crypto.getRandomValues(new Uint8Array(32)),a=crypto.getRandomValues(new Uint8Array(12)),r=await crypto.subtle.importKey("raw",t,{name:"AES-GCM"},!1,["encrypt"]);return{encryptedData:await crypto.subtle.encrypt({name:"AES-GCM",iv:a},r,e),key:t.buffer,iv:a.buffer}}function ti(e){let t=new Uint8Array(e),a="";for(let e=0;e<t.byteLength;e++)a+=String.fromCharCode(t[e]);return btoa(a)}var tl=a(58671),ts=a(73539);let to=[{code:"US",name:"English"},{code:"ES",name:"Spanish"},{code:"IT",name:"Italian"},{code:"FR",name:"French"},{code:"DE",name:"German"},{code:"PT",name:"Portuguese"},{code:"RU",name:"Russian"},{code:"JP",name:"Japanese"},{code:"CN",name:"Chinese"}],tc="opencut-transcription-privacy-accepted";function td(){let[e,t]=(0,o.useState)("auto"),[a,n]=(0,o.useState)(!1),[i,l]=(0,o.useState)(""),[s,c]=(0,o.useState)(null),[d,u]=(0,o.useState)(!1),[m,f]=(0,o.useState)(!1),h=(0,o.useRef)(null),{insertTrackAt:x,addElementToTrack:g}=(0,P.A)();(0,o.useEffect)(()=>{f("true"===localStorage.getItem(tc))},[]);let v=async()=>{try{n(!0),c(null),l("Extracting audio...");let t=await (0,tr.Pt)();l("Encrypting audio...");let a=await t.arrayBuffer(),r=await tn(a),i=new Blob([r.encryptedData]);l("Uploading...");let s=await fetch("/api/get-upload-url",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileExtension:"wav"})});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to get upload URL")}let{uploadUrl:o,fileName:d}=await s.json();await fetch(o,{method:"PUT",body:i}),l("Transcribing...");let u=await fetch("/api/transcribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:d,language:"auto"===e?"auto":e.toLowerCase(),decryptionKey:ti(r.key),iv:ti(r.iv)})});if(!u.ok){let e=await u.json();throw Error(e.message||"Transcription failed")}let{text:m,segments:f}=await u.json(),h=[],p=0;f.forEach(e=>{let t=e.text.trim().split(/\s+/),a=e.end-e.start,r=t.length/a,n=[];for(let e=0;e<t.length;e+=3)n.push(t.slice(e,e+3).join(" "));let i=e.start;n.forEach(e=>{let t=e.split(/\s+/).length,a=Math.max(.8,t/r),n=i;n<p&&(n=p),h.push({text:e,startTime:n,duration:a}),p=n+a,i+=a})});let v=x("text",0);h.forEach((e,t)=>{g(v,{type:"text",name:"Caption ".concat(t+1),content:e.text,duration:e.duration,startTime:e.startTime,trimStart:0,trimEnd:0,fontSize:65,fontFamily:"Arial",color:"#ffffff",textAlign:"center",fontWeight:"bold",fontStyle:"normal",textDecoration:"none",x:0,y:0,rotation:0,opacity:1})})}catch(e){c(e instanceof Error?e.message:"An unexpected error occurred")}finally{n(!1),l("")}};return(0,r.jsxs)(Y,{ref:h,className:"flex flex-col justify-between",children:[(0,r.jsx)(eB.Zf,{title:"Language",children:(0,r.jsx)(tt,{selectedCountry:e,onSelect:t,containerRef:h,languages:to})}),(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[s&&(0,r.jsx)("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:(0,r.jsx)("p",{className:"text-sm text-destructive",children:s})}),(0,r.jsxs)(w.$,{className:"w-full",onClick:()=>{m?v():u(!0)},disabled:a,children:[a&&(0,r.jsx)(p.A,{className:"mr-1 h-4 w-4 animate-spin"}),a?i:"Generate transcript"]}),(0,r.jsx)(ei.lG,{open:d,onOpenChange:u,children:(0,r.jsxs)(ei.Cf,{className:"sm:max-w-md",children:[(0,r.jsxs)(ei.c7,{children:[(0,r.jsxs)(ei.L3,{className:"flex items-center gap-2",children:[(0,r.jsx)(tl.A,{className:"h-5 w-5"}),"Audio Processing Notice"]}),(0,r.jsxs)(ei.rr,{className:"space-y-3",children:[(0,r.jsx)("p",{children:"To generate captions, we need to process your timeline audio using speech-to-text technology."}),(0,r.jsxs)("div",{className:"space-y-2 pt-2",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(tl.A,{className:"h-4 w-4 flex-shrink-0"}),(0,r.jsx)("span",{className:"text-sm",children:"Zero-knowledge encryption - we cannot decrypt your files even if we wanted to"})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(tl.A,{className:"h-4 w-4 flex-shrink-0"}),(0,r.jsx)("span",{className:"text-sm",children:"Encryption keys generated randomly in your browser, never stored anywhere"})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(b.A,{className:"h-4 w-4 flex-shrink-0"}),(0,r.jsx)("span",{className:"text-sm",children:"Audio encrypted before upload - raw audio never leaves your device"})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(ts.A,{className:"h-4 w-4 flex-shrink-0"}),(0,r.jsx)("span",{className:"text-sm",children:"Everything permanently deleted within seconds after transcription"})]})]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(0,r.jsx)("strong",{children:"True zero-knowledge privacy:"})," Encryption keys are generated randomly in your browser and never stored anywhere. It's cryptographically impossible for us, our cloud providers, or anyone else to decrypt your audio files."]})]})]}),(0,r.jsxs)(ei.Es,{className:"gap-2",children:[(0,r.jsx)(w.$,{variant:"outline",onClick:()=>u(!1),disabled:a,children:"Cancel"}),(0,r.jsx)(w.$,{onClick:()=>{localStorage.setItem(tc,"true"),f(!0),u(!1),v()},disabled:a,children:"Continue & Generate Captions"})]})]})})]})]})}function tu(){let{activeTab:e}=(0,i.t)(),t={media:(0,r.jsx)(z,{}),sounds:(0,r.jsx)(es,{}),text:(0,r.jsx)(G,{}),stickers:(0,r.jsx)(eI,{}),effects:(0,r.jsx)("div",{className:"p-4 text-muted-foreground",children:"Effects view coming soon..."}),transitions:(0,r.jsx)("div",{className:"p-4 text-muted-foreground",children:"Transitions view coming soon..."}),captions:(0,r.jsx)(td,{}),filters:(0,r.jsx)("div",{className:"p-4 text-muted-foreground",children:"Filters view coming soon..."}),adjustment:(0,r.jsx)("div",{className:"p-4 text-muted-foreground",children:"Adjustment view coming soon..."}),settings:(0,r.jsx)(eQ,{})};return(0,r.jsxs)("div",{className:"h-full flex bg-panel",children:[(0,r.jsx)(s,{}),(0,r.jsx)(B.Separator,{orientation:"vertical"}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:t[e]})]})}},67034:(e,t,a)=>{a.d(t,{Separator:()=>s});var r=a(28064),n=a(74188),i=a(22276),l=a(93146);let s=n.forwardRef((e,t)=>{let{className:a,orientation:n="horizontal",decorative:s=!0,...o}=e;return(0,r.jsx)(i.b,{ref:t,decorative:s,orientation:n,className:(0,l.cn)("shrink-0 bg-border","horizontal"===n?"h-px w-full":"h-full w-px",a),...o})});s.displayName=i.b.displayName},68820:(e,t,a)=>{a.d(t,{HK:()=>l,WM:()=>o,wV:()=>s});var r=a(28064),n=a(11940),i=a(93146);let l=e=>{let{className:t,...a}=e;return(0,r.jsx)(n.YZ,{className:(0,i.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...a})},s=n.Zk,o=e=>{let{withHandle:t,className:a,...l}=e;return(0,r.jsx)(n.TW,{className:(0,i.cn)("relative flex w-px items-center justify-center bg-transparent after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",a),...l})}},70028:(e,t,a)=>{a.d(t,{G5:()=>u,I6:()=>d,Pt:()=>m});var r=a(19600),n=a(84945),i=a(3532),l=a(91685),s=a(80196);let o=null,c=async()=>{if(o)return o;o=new r.m;let e="".concat(i.J,"/ffmpeg");return await o.load({coreURL:await (0,n.KA)("".concat(e,"/ffmpeg-core.js"),"text/javascript"),wasmURL:await (0,n.KA)("".concat(e,"/ffmpeg-core.wasm"),"application/wasm")}),o},d=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=await c(),r="input.mp4",n="thumbnail.jpg";await a.writeFile(r,new Uint8Array(await e.arrayBuffer())),await a.exec(["-i",r,"-ss",t.toString(),"-vframes","1","-vf","scale=320:240","-q:v","2",n]);let i=new Blob([await a.readFile(n)],{type:"image/jpeg"});return await a.deleteFile(r),await a.deleteFile(n),URL.createObjectURL(i)},u=async e=>{let t=await c(),a="input.mp4";await t.writeFile(a,new Uint8Array(await e.arrayBuffer()));let r="",n=!0;t.on("log",e=>{let{message:t}=e;n&&(r+=t)});try{await t.exec(["-i",a,"-f","null","-"])}catch(e){throw n=!1,await t.deleteFile(a),Error("Failed to extract video info. The file may be corrupted or in an unsupported format.")}n=!1,await t.deleteFile(a);let i=r.match(/Duration: (\d+):(\d+):([\d.]+)/),l=0;if(i){let[,e,t,a]=i;l=3600*parseInt(e)+60*parseInt(t)+parseFloat(a)}let s=r.match(/Video:.* (\d+)x(\d+)[^,]*, ([\d.]+) fps/),o=0,d=0,u=0;return s&&(o=parseInt(s[1]),d=parseInt(s[2]),u=parseFloat(s[3])),{duration:l,width:o,height:d,fps:u}},m=async e=>{let t=new r.m;try{await t.load()}catch(e){throw Error("Unable to initialize audio processing. Please try again.")}let a=l.A.getState(),n=s.B.getState(),i=a.tracks,o=a.getTotalDuration();if(0===o)return new Blob([new ArrayBuffer(44)],{type:"audio/wav"});e&&t.on("progress",t=>{let{progress:a}=t;e(100*a)});let c=[];for(let e of i)if(!e.muted){for(let t of e.elements)if("media"===t.type){let a=n.mediaItems.find(e=>e.id===t.mediaId);if(!a)continue;("video"===a.type||"audio"===a.type)&&c.push({file:a.file,startTime:t.startTime,duration:t.duration,trimStart:t.trimStart,trimEnd:t.trimEnd,trackMuted:e.muted||!1})}}if(0===c.length){let e=Math.max(1,o);try{return await f(e)}catch(e){throw Error("Unable to generate audio for empty timeline.")}}let d=[],u=[];try{for(let e=0;e<c.length;e++){let a=c[e],r="input_".concat(e,".").concat(a.file.name.split(".").pop());d.push(r);try{await t.writeFile(r,new Uint8Array(await a.file.arrayBuffer()))}catch(e){throw Error("Unable to process file: ".concat(a.file.name,". The file may be corrupted or in an unsupported format."))}let n=a.trimStart,i=a.duration-a.trimStart-a.trimEnd,l="audio_".concat(e);u.push("[".concat(e,":a]atrim=start=").concat(n,":duration=").concat(i,",asetpts=PTS-STARTPTS,adelay=").concat(1e3*a.startTime,"|").concat(1e3*a.startTime,"[").concat(l,"]"))}let e=1===c.length?"[audio_0]aresample=44100,aformat=sample_fmts=s16:channel_layouts=stereo[out]":"".concat(u.map((e,t)=>"[audio_".concat(t,"]")).join(""),"amix=inputs=").concat(c.length,":duration=longest:dropout_transition=2,aresample=44100,aformat=sample_fmts=s16:channel_layouts=stereo[out]"),a=[...u,e].join(";"),r="timeline_audio.wav",n=[...d.flatMap(e=>["-i",e]),"-filter_complex",a,"-map","[out]","-t",o.toString(),"-c:a","pcm_s16le","-ar","44100",r];try{await t.exec(n)}catch(e){throw Error("Audio processing failed. Some audio files may be corrupted or incompatible.")}let i=await t.readFile(r);return new Blob([i],{type:"audio/wav"})}catch(e){for(let e of d)try{await t.deleteFile(e)}catch(e){}try{await t.deleteFile("timeline_audio.wav")}catch(e){}throw e}finally{for(let e of d)try{await t.deleteFile(e)}catch(e){}try{await t.deleteFile("timeline_audio.wav")}catch(e){}}},f=async e=>{let t=await c(),a="silent.wav";try{await t.exec(["-f","lavfi","-i","anullsrc=channel_layout=stereo:sample_rate=44100","-t",e.toString(),"-c:a","pcm_s16le",a]);let r=await t.readFile(a);return new Blob([r],{type:"audio/wav"})}catch(e){throw e}finally{try{await t.deleteFile(a)}catch(e){}}}},75141:(e,t,a)=>{a.d(t,{U:()=>s,Y:()=>i});var r=a(59467),n=a(20159);let i={tiktok:"TikTok"},l=[{name:"16:9",width:1920,height:1080},{name:"9:16",width:1080,height:1920},{name:"1:1",width:1080,height:1080},{name:"4:3",width:1440,height:1080}],s=(0,r.v)()((0,n.Zr)(e=>({isInitializing:!0,isPanelsReady:!1,canvasPresets:l,layoutGuide:{platform:null},setInitializing:t=>{e({isInitializing:t})},setPanelsReady:t=>{e({isPanelsReady:t})},initializeApp:async()=>{e({isInitializing:!0,isPanelsReady:!1}),e({isPanelsReady:!0,isInitializing:!1})},setLayoutGuide:t=>{e(e=>({layoutGuide:{...e.layoutGuide,...t}}))},toggleLayoutGuide:t=>{e(e=>({layoutGuide:{platform:e.layoutGuide.platform===t?null:t}}))}}),{name:"editor-settings",partialize:e=>({layoutGuide:e.layoutGuide})}))},76386:(e,t,a)=>{a.d(t,{P:()=>o});var r=a(28064),n=a(74188),i=a(93146),l=a(4600),s=a(82337);function o(e){let{time:t,duration:a,format:o="HH:MM:SS:FF",fps:c=s.ge,onTimeChange:d,className:u,disabled:m=!1}=e,[f,h]=(0,n.useState)(!1),[p,x]=(0,n.useState)(""),[g,v]=(0,n.useState)(!1),j=(0,n.useRef)(null),y=(0,n.useRef)(!1),w=(0,l.s6)(t,o,c),b=()=>{let e=(0,l.aU)(p,o,c);if(null===e)return void v(!0);let t=Math.max(0,a?Math.min(a,e):e);null==d||d(t),h(!1),x(""),v(!1),y.current=!1};return((0,n.useEffect)(()=>{f&&j.current&&(j.current.focus(),j.current.select())},[f]),f)?(0,r.jsx)("input",{ref:j,type:"text",value:p,onChange:e=>{x(e.target.value),v(!1)},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),y.current=!0,b()):"Escape"===e.key&&(e.preventDefault(),h(!1),x(""),v(!1),y.current=!1)},onBlur:()=>{!y.current&&f&&b()},className:(0,i.cn)("text-xs font-mono bg-transparent border-none outline-none","focus:bg-background focus:border focus:border-primary focus:px-1 focus:rounded","tabular-nums text-primary",g&&"text-destructive focus:border-destructive",u),style:{width:"".concat(w.length+1,"ch")},placeholder:w}):(0,r.jsx)("span",{onClick:()=>{m||(h(!0),x(w),v(!1),y.current=!1)},className:(0,i.cn)("text-xs font-mono tabular-nums text-primary cursor-pointer","hover:bg-muted/50 hover:rounded px-1 -mx-1 transition-colors",m&&"cursor-default hover:bg-transparent",u),title:m?void 0:"Click to edit time",children:w})}},81310:(e,t,a)=>{a.d(t,{PY:()=>n,YE:()=>i,uj:()=>l});var r=a(28064);function n(e){let{className:t}=e;return(0,r.jsx)("svg",{className:t,width:"20",height:"18",viewBox:"0 0 76 65",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M37.5274 0L75.0548 65H0L37.5274 0Z",fill:"currentColor"})})}function i(e){let{className:t="",size:a=32}=e;return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 345 243",fill:"none",className:t,children:[(0,r.jsxs)("g",{opacity:"0.5",children:[(0,r.jsx)("path",{d:"M203.75 4H39.25C19.782 4 4 19.782 4 39.25V203.75C4 223.218 19.782 239 39.25 239H203.75C223.218 239 239 223.218 239 203.75V39.25C239 19.782 223.218 4 203.75 4Z",fill:"#FFFC00"}),(0,r.jsx)("path",{d:"M97.1738 194.02C88.9121 188.053 82.4863 184.84 66.8809 187.594C64.5859 188.053 60.4551 189.43 59.9961 185.299C59.0781 182.086 59.0781 177.037 56.7832 176.578C42.5547 174.742 37.5059 171.988 35.2109 169.234C34.293 168.316 33.834 166.021 35.6699 165.562C59.9961 160.973 71.4707 137.564 73.7656 132.975C76.5195 126.09 71.9297 121.959 63.209 119.205C59.0781 117.828 52.1934 115.992 52.1934 111.402C52.1934 109.107 54.4883 107.73 56.7832 106.812C58.6191 106.354 60.4551 105.895 62.291 106.812C67.7988 109.107 72.8477 110.025 75.6016 107.73C75.6016 95.3379 72.3887 79.7324 77.4375 66.8809C83.4043 52.6523 98.0918 39.8008 121.5 39.8008C144.908 39.8008 159.596 52.6523 165.562 66.8809C170.611 79.7324 167.398 95.3379 167.398 107.73C170.152 110.025 175.201 109.107 180.709 106.812C182.545 105.895 184.381 106.354 186.217 106.812C188.512 107.73 190.807 109.107 190.807 111.402C190.807 115.992 183.922 117.828 179.791 119.205C171.07 121.959 166.48 126.09 169.234 132.975C171.529 137.564 183.004 160.973 207.33 165.562C209.166 166.021 208.707 168.316 207.789 169.234C205.494 171.988 200.445 174.742 186.217 176.578C183.922 177.037 183.922 182.086 183.004 185.299C182.545 189.43 178.414 188.053 176.119 187.594C160.514 184.84 154.088 188.053 145.826 194.02C139.065 199.872 130.442 203.126 121.5 203.199C111.861 203.658 104.059 199.527 97.1738 194.02Z",fill:"white"}),(0,r.jsx)("path",{d:"M203.75 4H39.25C19.782 4 4 19.782 4 39.25V203.75C4 223.218 19.782 239 39.25 239H203.75C223.218 239 239 223.218 239 203.75V39.25C239 19.782 223.218 4 203.75 4Z",stroke:"black",strokeWidth:"7"}),(0,r.jsx)("path",{d:"M97.1738 194.02C88.9121 188.053 82.4863 184.84 66.8809 187.594C64.5859 188.053 60.4551 189.43 59.9961 185.299C59.0781 182.086 59.0781 177.037 56.7832 176.578C42.5547 174.742 37.5059 171.988 35.2109 169.234C34.293 168.316 33.834 166.021 35.6699 165.562C59.9961 160.973 71.4707 137.564 73.7656 132.975C76.5195 126.09 71.9297 121.959 63.209 119.205C59.0781 117.828 52.1934 115.992 52.1934 111.402C52.1934 109.107 54.4883 107.73 56.7832 106.812C58.6191 106.354 60.4551 105.895 62.291 106.812C67.7988 109.107 72.8477 110.025 75.6016 107.73C75.6016 95.3379 72.3887 79.7324 77.4375 66.8809C83.4043 52.6523 98.0918 39.8008 121.5 39.8008C144.908 39.8008 159.596 52.6523 165.562 66.8809C170.611 79.7324 167.398 95.3379 167.398 107.73C170.152 110.025 175.201 109.107 180.709 106.812C182.545 105.895 184.381 106.354 186.217 106.812C188.512 107.73 190.807 109.107 190.807 111.402C190.807 115.992 183.922 117.828 179.791 119.205C171.07 121.959 166.48 126.09 169.234 132.975C171.529 137.564 183.004 160.973 207.33 165.562C209.166 166.021 208.707 168.316 207.789 169.234C205.494 171.988 200.445 174.742 186.217 176.578C183.922 177.037 183.922 182.086 183.004 185.299C182.545 189.43 178.414 188.053 176.119 187.594C160.514 184.84 154.088 188.053 145.826 194.02C139.065 199.872 130.442 203.126 121.5 203.199C111.861 203.658 104.059 199.527 97.1738 194.02Z",stroke:"black",strokeWidth:"7"})]}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M133.5 4H321.5C334.48 4 345 14.5205 345 27.5V215.5C345 228.48 334.48 239 321.5 239H133.5C120.52 239 110 228.48 110 215.5V27.5C110 14.5205 120.52 4 133.5 4Z",fill:"#010101"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M261.497 99.4086C271.784 106.758 284.388 111.083 297.999 111.083V84.9035C295.423 84.9045 292.854 84.6357 290.333 84.1016V104.709C276.723 104.709 264.121 100.384 253.831 93.0345V146.459C253.831 173.185 232.155 194.85 205.417 194.85C195.44 194.85 186.167 191.835 178.464 186.665C187.256 195.65 199.516 201.224 213.08 201.224C239.821 201.224 261.498 179.56 261.498 152.833L261.497 99.4086ZM270.953 72.9965C265.696 67.2559 262.244 59.8365 261.497 51.634V48.267H254.233C256.061 58.6916 262.298 67.5981 270.953 72.9965ZM195.376 166.157C192.438 162.308 190.851 157.598 190.858 152.756C190.858 140.533 200.773 130.622 213.005 130.622C215.285 130.621 217.551 130.97 219.723 131.659V104.894C217.185 104.547 214.622 104.399 212.061 104.454V125.286C209.887 124.597 207.62 124.247 205.34 124.249C193.107 124.249 183.193 134.159 183.193 146.384C183.193 155.027 188.149 162.512 195.376 166.157Z",fill:"#EE1D52"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M253.831 93.0345C264.121 100.384 276.723 104.709 290.333 104.709V84.1016C282.736 82.4848 276.011 78.5162 270.953 72.9965C262.298 67.5981 256.061 58.6916 254.233 48.267H235.152V152.832C235.108 165.022 225.21 174.892 213.004 174.892C205.811 174.892 199.422 171.465 195.376 166.157C188.149 162.512 183.193 155.027 183.193 146.384C183.193 134.159 193.107 124.249 205.34 124.249C207.683 124.249 209.942 124.614 212.061 125.286V104.454C185.792 104.996 164.665 126.449 164.665 152.833C164.665 166.003 169.926 177.942 178.464 186.665C186.167 191.835 195.44 194.85 205.417 194.85C232.155 194.85 253.831 173.185 253.831 146.459V93.0345Z",fill:"white"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M290.333 84.1016V78.5293C283.482 78.5396 276.766 76.6229 270.953 72.9965C276.099 78.6269 282.874 82.5087 290.333 84.1016ZM254.233 48.267C254.058 47.2708 253.924 46.2679 253.831 45.2608V41.8938H227.485V146.459C227.443 158.648 217.545 168.518 205.339 168.518C201.754 168.518 198.372 167.669 195.376 166.157C199.422 171.465 205.811 174.892 213.004 174.892C225.21 174.892 235.108 165.022 235.152 152.832V48.267H254.233ZM212.061 104.454L212.061 98.5212C209.859 98.2202 207.64 98.0698 205.418 98.071C178.676 98.071 157 119.736 157 146.459C157 163.214 165.518 177.979 178.464 186.665C169.926 177.942 164.666 166.002 164.666 152.832C164.666 126.449 185.791 104.996 212.061 104.454Z",fill:"#69C9D0"})]})}function l(e){let{className:t="",size:a=16}=e;return(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:a,height:a,viewBox:"0 0 16 16",fill:"none",className:t,children:[(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.5 12.6667C2.5 13.4951 3.17157 14.1667 4 14.1667H12C12.8284 14.1667 13.5 13.4951 13.5 12.6667V11.3333C13.5 10.5049 12.8284 9.83333 12 9.83333H4C3.17157 9.83333 2.5 10.5049 2.5 11.3333V12.6667ZM4 15.1667C2.61929 15.1667 1.5 14.0474 1.5 12.6667V11.3333C1.5 9.95262 2.61929 8.83333 4 8.83333H12C13.3807 8.83333 14.5 9.95262 14.5 11.3333V12.6667C14.5 14.0474 13.3807 15.1667 12 15.1667H4Z",fill:"white"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2 5.83333C1.72386 5.83333 1.5 5.60947 1.5 5.33333L1.5 4C1.5 2.2511 2.91777 0.833332 4.66667 0.833332L11.3333 0.833332C13.0822 0.833332 14.5 2.2511 14.5 4V5.33333C14.5 5.60947 14.2761 5.83333 14 5.83333C13.7239 5.83333 13.5 5.60947 13.5 5.33333V4C13.5 2.80338 12.53 1.83333 11.3333 1.83333L4.66667 1.83333C3.47005 1.83333 2.5 2.80338 2.5 4V5.33333C2.5 5.60947 2.27614 5.83333 2 5.83333Z",fill:"white"}),(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.35355 3.64645C8.15829 3.45118 7.84171 3.45118 7.64645 3.64645L5.64645 5.64645C5.45118 5.84171 5.45118 6.15829 5.64645 6.35355C5.84171 6.54882 6.15829 6.54882 6.35355 6.35355L7.5 5.20711L7.5 9.33333C7.5 9.60948 7.72386 9.83333 8 9.83333C8.27614 9.83333 8.5 9.60948 8.5 9.33333V5.20711L9.64645 6.35355C9.84171 6.54882 10.1583 6.54882 10.3536 6.35355C10.5488 6.15829 10.5488 5.84171 10.3536 5.64645L8.35355 3.64645Z",fill:"white"})]})}},81925:(e,t,a)=>{a.d(t,{E:()=>s});var r=a(59467),n=a(91685),i=a(82337);let l=null,s=(0,r.v)((e,t)=>({isPlaying:!1,currentTime:0,duration:0,volume:1,muted:!1,previousVolume:1,speed:1,play:()=>{let a=t(),r=n.A.getState().getTotalDuration(),s=r>0?r:a.duration;if(s>0){var o,c;let e=Math.max(0,s-1/(null!=(c=null==(o=i.Iw.getState().activeProject)?void 0:o.fps)?c:i.ge));a.currentTime>=e&&t().seek(0)}e({isPlaying:!0}),(e=>{l&&cancelAnimationFrame(l);let t=()=>{let r=e();if(r.isPlaying&&r.currentTime<r.duration){let e=performance.now(),t=(e-a)/1e3;a=e;let l=r.currentTime+t*r.speed,o=n.A.getState().getTotalDuration(),c=o>0?o:r.duration;if(l>=c){var s;let e=null==(s=i.Iw.getState().activeProject)?void 0:s.fps,t=Math.max(0,c-1/(null!=e?e:i.ge));r.pause(),r.setCurrentTime(t),window.dispatchEvent(new CustomEvent("playback-seek",{detail:{time:t}}))}else r.setCurrentTime(l),window.dispatchEvent(new CustomEvent("playback-update",{detail:{time:l}}))}l=requestAnimationFrame(t)},a=performance.now();l=requestAnimationFrame(t)})(t)},pause:()=>{e({isPlaying:!1}),l&&(cancelAnimationFrame(l),l=null)},toggle:()=>{let{isPlaying:e}=t();e?t().pause():t().play()},seek:a=>{let{duration:r}=t(),n=Math.max(0,Math.min(r,a));e({currentTime:n});let i=new CustomEvent("playback-seek",{detail:{time:n}});window.dispatchEvent(i)},setVolume:t=>e(e=>({volume:Math.max(0,Math.min(1,t)),muted:0===t,previousVolume:t>0?t:e.previousVolume})),setSpeed:t=>{let a=Math.max(.1,Math.min(2,t));e({speed:a});let r=new CustomEvent("playback-speed",{detail:{speed:a}});window.dispatchEvent(r)},setDuration:t=>e({duration:t}),setCurrentTime:t=>e({currentTime:t}),mute:()=>{let{volume:a,previousVolume:r}=t();e({muted:!0,previousVolume:a>0?a:r,volume:0})},unmute:()=>{let{previousVolume:a}=t();e({muted:!1,volume:null!=a?a:1})},toggleMute:()=>{let{muted:e}=t();e?t().unmute():t().mute()}}))},86434:(e,t,a)=>{a.d(t,{Ip:()=>h,K5:()=>x,Rc:()=>m,kt:()=>p,tz:()=>u});var r=a(28064),n=a(74188),i=a(14219),l=a(37770),s=a(58090),o=a(57118),c=a(24827),d=a(93146);let u=i.Root,m=i.Trigger;i.Group,i.Portal,i.Sub,i.RadioGroup;let f=(0,c.F)("relative flex cursor-pointer select-none items-center gap-2 px-2 py-1.5 text-sm outline-hidden transition-opacity data-disabled:pointer-events-none data-disabled:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"focus:opacity-65 focus:text-accent-foreground",destructive:"text-destructive focus:text-destructive/80"}},defaultVariants:{variant:"default"}});n.forwardRef((e,t)=>{let{className:a,inset:n,children:s,variant:o="default",...c}=e;return(0,r.jsxs)(i.SubTrigger,{ref:t,className:(0,d.cn)(f({variant:o}),"data-[state=open]:bg-accent data-[state=open]:opacity-65",n&&"pl-8",a),...c,children:[s,(0,r.jsx)(l.A,{className:"ml-auto"})]})}).displayName=i.SubTrigger.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(i.SubContent,{ref:t,className:(0,d.cn)("z-50 min-w-32 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})}).displayName=i.SubContent.displayName;let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(i.Portal,{children:(0,r.jsx)(i.Content,{ref:t,className:(0,d.cn)("z-50 min-w-32 overflow-hidden rounded-md border p-1 bg-popover text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})})});h.displayName=i.Content.displayName;let p=n.forwardRef((e,t)=>{let{className:a,inset:n,variant:l="default",...s}=e;return(0,r.jsx)(i.Item,{ref:t,className:(0,d.cn)(f({variant:l}),n&&"pl-8",a),...s})});p.displayName=i.Item.displayName,n.forwardRef((e,t)=>{let{className:a,children:n,checked:l,variant:o="default",...c}=e;return(0,r.jsxs)(i.CheckboxItem,{ref:t,className:(0,d.cn)(f({variant:o}),"pl-8 pr-2",a),checked:l,...c,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.ItemIndicator,{children:(0,r.jsx)(s.A,{className:"h-4 w-4"})})}),n]})}).displayName=i.CheckboxItem.displayName,n.forwardRef((e,t)=>{let{className:a,children:n,variant:l="default",...s}=e;return(0,r.jsxs)(i.RadioItem,{ref:t,className:(0,d.cn)(f({variant:l}),"pl-8 pr-2",a),...s,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.ItemIndicator,{children:(0,r.jsx)(o.A,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=i.RadioItem.displayName,n.forwardRef((e,t)=>{let{className:a,inset:n,...l}=e;return(0,r.jsx)(i.Label,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",a),...l})}).displayName=i.Label.displayName;let x=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(i.Separator,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-foreground/10",a),...n})});x.displayName=i.Separator.displayName},87819:(e,t,a)=>{a.d(t,{M:()=>c});var r=a(28064),n=a(66981),i=a(61309),l=a(15700),s=a(74188),o=a(40124);function c(){let[e,t]=(0,s.useState)(0),[a,i]=(0,s.useState)(!1);(0,s.useEffect)(()=>{localStorage.getItem("hasSeenOnboarding")||i(!0)},[]);let l=()=>{t(e+1)},o=()=>{i(!1),localStorage.setItem("hasSeenOnboarding","true")},c=()=>{switch(e){case 0:return"Welcome to OpenCut Beta! \uD83C\uDF89";case 1:return"⚠️ This is a super early beta!";case 2:return"\uD83E\uDD8B Have fun testing!";default:return"OpenCut Onboarding"}};return(0,r.jsx)(n.lG,{open:a,onOpenChange:o,children:(0,r.jsxs)(n.Cf,{className:"sm:max-w-[425px] !outline-none pt-2",children:[(0,r.jsx)(n.L3,{children:(0,r.jsx)("span",{className:"sr-only",children:c()})}),(()=>{switch(e){case 0:return(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(d,{title:"Welcome to OpenCut Beta! \uD83C\uDF89"}),(0,r.jsx)(u,{description:"You're among the first to try OpenCut - the fully open source CapCut alternative."})]}),(0,r.jsx)(m,{onClick:l,children:"Next"})]});case 1:return(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(d,{title:c()}),(0,r.jsx)(u,{description:"OpenCut started just one month ago. There's still a ton of things to do to make this editor amazing."}),(0,r.jsx)(u,{description:"A lot of features are still missing, like the export functionality. We're working hard to build them out!"}),(0,r.jsx)(u,{description:"If you're curious, check out our roadmap [here](https://opencut.app/roadmap)"})]}),(0,r.jsx)(m,{onClick:l,children:"Next"})]});case 2:return(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(d,{title:c()}),(0,r.jsx)(u,{description:"Join our [Discord](https://discord.gg/zmR9N35cjK), chat with cool people and share feedback to help make OpenCut the best editor ever."})]}),(0,r.jsx)(m,{onClick:o,children:"Finish"})]});default:return null}})()]})})}function d(e){let{title:t}=e;return(0,r.jsx)("h2",{className:"text-lg md:text-xl font-bold",children:t})}function u(e){let{description:t}=e;return(0,r.jsx)("div",{className:"text-muted-foreground",children:(0,r.jsx)(o.oz,{components:{p:e=>{let{children:t}=e;return(0,r.jsx)("p",{className:"mb-0",children:t})},a:e=>{let{href:t,children:a}=e;return(0,r.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-foreground hover:text-foreground/80 underline",children:a})}},children:t})})}function m(e){let{children:t,onClick:a}=e;return(0,r.jsxs)(i.$,{onClick:a,variant:"default",className:"w-full",children:[t,(0,r.jsx)(l.A,{className:"w-4 h-4"})]})}},89100:(e,t,a)=>{a.d(t,{z:()=>s});var r=a(74188),n=a(81925),i=a(91685),l=a(61557);let s=()=>{let{isPlaying:e,currentTime:t,play:a,pause:s,seek:o}=(0,n.E)(),{selectedElements:c,tracks:d,splitElement:u,splitAndKeepLeft:m,splitAndKeepRight:f,separateAudio:h}=(0,i.A)();(0,r.useCallback)(()=>{if(1!==c.length)return void l.oR.error("Select exactly one element to split");let{trackId:e,elementId:a}=c[0],r=d.find(t=>t.id===e),n=null==r?void 0:r.elements.find(e=>e.id===a);if(!n)return;let i=n.startTime,s=n.startTime+(n.duration-n.trimStart-n.trimEnd);if(t<=i||t>=s)return void l.oR.error("Playhead must be within selected element");u(e,a,t)},[c,d,t,u]),(0,r.useCallback)(()=>{if(1!==c.length)return void l.oR.error("Select exactly one element");let{trackId:e,elementId:a}=c[0],r=d.find(t=>t.id===e),n=null==r?void 0:r.elements.find(e=>e.id===a);if(!n)return;let i=n.startTime,s=n.startTime+(n.duration-n.trimStart-n.trimEnd);if(t<=i||t>=s)return void l.oR.error("Playhead must be within selected element");m(e,a,t)},[c,d,t,m]),(0,r.useCallback)(()=>{if(1!==c.length)return void l.oR.error("Select exactly one element");let{trackId:e,elementId:a}=c[0],r=d.find(t=>t.id===e),n=null==r?void 0:r.elements.find(e=>e.id===a);if(!n)return;let i=n.startTime,s=n.startTime+(n.duration-n.trimStart-n.trimEnd);if(t<=i||t>=s)return void l.oR.error("Playhead must be within selected element");f(e,a,t)},[c,d,t,f]),(0,r.useCallback)(()=>{if(1!==c.length)return void l.oR.error("Select exactly one media element to separate audio");let{trackId:e,elementId:t}=c[0],a=d.find(t=>t.id===e);if(!a||"media"!==a.type)return void l.oR.error("Select a media element to separate audio");h(e,t)},[c,d,h])}},90649:(e,t,a)=>{a.d(t,{t:()=>p,v:()=>h});var r=a(43589),n=a(53093),i=a(81450),l=a(79649),s=a(38333),o=a(78456),c=a(40149),d=a(99469),u=a(26951),m=a(16219),f=a(59467);let h={media:{icon:r.A,label:"Media"},sounds:{icon:n.A,label:"Sounds"},text:{icon:i.A,label:"Text"},stickers:{icon:l.A,label:"Stickers"},effects:{icon:s.A,label:"Effects"},transitions:{icon:o.A,label:"Transitions"},captions:{icon:c.A,label:"Captions"},filters:{icon:d.A,label:"Filters"},adjustment:{icon:u.A,label:"Adjustment"},settings:{icon:m.A,label:"Settings"}},p=(0,f.v)(e=>({activeTab:"media",setActiveTab:t=>e({activeTab:t}),highlightMediaId:null,requestRevealMedia:t=>e({activeTab:"media",highlightMediaId:t}),clearHighlight:()=>e({highlightMediaId:null})}))}}]);
//# sourceMappingURL=2877-99c3e59952da32cc.js.map