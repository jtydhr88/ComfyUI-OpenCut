"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[622],{2688:(e,t,a)=>{a.d(t,{x:()=>D});var r=a(28064),n=a(8300),l=a(80196),i=a(81925),s=a(75141),o=a(74188);function d(e){let{src:t,poster:a,className:n="",clipStartTime:l,trimStart:s,trimEnd:d,clipDuration:c}=e,u=(0,o.useRef)(null),{isPlaying:m,currentTime:f,volume:h,speed:x,muted:p}=(0,i.E)(),g=l+(c-s-d),v=f>=l&&f<g;return(0,o.useEffect)(()=>{let e=u.current;if(!e||!v)return;let t=t=>{e.currentTime=Math.max(s,Math.min(c-d,t.detail.time-l+s))},a=t=>{let a=Math.max(s,Math.min(c-d,t.detail.time-l+s));Math.abs(e.currentTime-a)>.5&&(e.currentTime=a)},r=t=>{e.playbackRate=t.detail.speed};return window.addEventListener("playback-seek",t),window.addEventListener("playback-update",a),window.addEventListener("playback-speed",r),()=>{window.removeEventListener("playback-seek",t),window.removeEventListener("playback-update",a),window.removeEventListener("playback-speed",r)}},[l,s,d,c,v]),(0,o.useEffect)(()=>{let e=u.current;e&&(m&&v?e.play().catch(()=>{}):e.pause())},[m,v]),(0,o.useEffect)(()=>{let e=u.current;e&&(e.volume=h,e.muted=p,e.playbackRate=x)},[h,x,p]),(0,r.jsx)("video",{ref:u,src:t,poster:a,className:"max-w-full max-h-full object-contain ".concat(n),playsInline:!0,preload:"auto",controls:!1,disablePictureInPicture:!0,disableRemotePlayback:!0,style:{pointerEvents:"none"},onContextMenu:e=>e.preventDefault()})}function c(e){let{src:t,className:a="",clipStartTime:n,trimStart:l,trimEnd:s,clipDuration:d,trackMuted:c=!1}=e,u=(0,o.useRef)(null),{isPlaying:m,currentTime:f,volume:h,speed:x,muted:p}=(0,i.E)(),g=n+(d-l-s),v=f>=n&&f<g;return(0,o.useEffect)(()=>{let e=u.current;if(!e||!v)return;let t=t=>{e.currentTime=Math.max(l,Math.min(d-s,t.detail.time-n+l))},a=t=>{let a=Math.max(l,Math.min(d-s,t.detail.time-n+l));Math.abs(e.currentTime-a)>.5&&(e.currentTime=a)},r=t=>{e.playbackRate=t.detail.speed};return window.addEventListener("playback-seek",t),window.addEventListener("playback-update",a),window.addEventListener("playback-speed",r),()=>{window.removeEventListener("playback-seek",t),window.removeEventListener("playback-update",a),window.removeEventListener("playback-speed",r)}},[n,l,s,d,v]),(0,o.useEffect)(()=>{let e=u.current;e&&(m&&v&&!c?e.play().catch(()=>{}):e.pause())},[m,v,c]),(0,o.useEffect)(()=>{let e=u.current;e&&(e.volume=h,e.muted=p||c,e.playbackRate=x)},[h,x,p,c]),(0,r.jsx)("audio",{ref:u,src:t,className:a,preload:"auto",controls:!1,style:{display:"none"},onContextMenu:e=>e.preventDefault()})}var u=a(61309),m=a(62243),f=a(45440),h=a(47888),x=a(76085),p=a(34802),g=a(93146),v=a(4600);function j(e){let{time:t,duration:a,format:n="HH:MM:SS:FF",fps:l=30,onTimeChange:i,className:s,disabled:d=!1}=e,[c,u]=(0,o.useState)(!1),[m,f]=(0,o.useState)(""),[h,x]=(0,o.useState)(!1),p=(0,o.useRef)(null),j=(0,o.useRef)(!1),b=(0,v.s)(t,n,l),y=()=>{let e=(0,v.a)(m,n,l);if(null===e)return void x(!0);let t=Math.max(0,a?Math.min(a,e):e);null==i||i(t),u(!1),f(""),x(!1),j.current=!1};return((0,o.useEffect)(()=>{c&&p.current&&(p.current.focus(),p.current.select())},[c]),c)?(0,r.jsx)("input",{ref:p,type:"text",value:m,onChange:e=>{f(e.target.value),x(!1)},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),j.current=!0,y()):"Escape"===e.key&&(e.preventDefault(),u(!1),f(""),x(!1),j.current=!1)},onBlur:()=>{!j.current&&c&&y()},className:(0,g.cn)("text-xs font-mono bg-transparent border-none outline-none","focus:bg-background focus:border focus:border-primary focus:px-1 focus:rounded","tabular-nums text-primary",h&&"text-destructive focus:border-destructive",s),style:{width:"".concat(b.length+1,"ch")},placeholder:b}):(0,r.jsx)("span",{onClick:()=>{d||(u(!0),f(b),x(!1),j.current=!1)},className:(0,g.cn)("text-xs font-mono tabular-nums text-primary cursor-pointer","hover:bg-muted/50 hover:rounded px-1 -mx-1 transition-colors",d&&"cursor-default hover:bg-transparent",s),title:d?void 0:"Click to edit time",children:b})}var b=a(13746),y=a.n(b),w=a(19947),N=a.n(w),S=a(82189),k=a.n(S),E=a(93237),C=a.n(E),T=a(53322),A=a.n(T);let R={Inter:y().className,Roboto:N().className,"Open Sans":k().className,"Playfair Display":C().className,"Comic Neue":A().className,Arial:"",Helvetica:"","Times New Roman":"",Georgia:""};y(),N(),k(),C(),A();var M=a(82337);function D(){let{tracks:e,getTotalDuration:t,updateTextElement:a}=(0,n.A)(),{mediaItems:u}=(0,l.B)(),{currentTime:m,toggle:f,setCurrentTime:h,isPlaying:x}=(0,i.E)(),{canvasSize:p}=(0,s.U)(),g=(0,o.useRef)(null),v=(0,o.useRef)(null),[j,b]=(0,o.useState)({width:0,height:0}),[y,w]=(0,o.useState)(!1),{activeProject:N}=(0,M.I)(),[S,k]=(0,o.useState)({isDragging:!1,elementId:null,trackId:null,startX:0,startY:0,initialElementX:0,initialElementY:0,currentX:0,currentY:0,elementWidth:0,elementHeight:0});(0,o.useEffect)(()=>{let e=()=>{let e,t,a,r;if(!v.current)return;if(y)e=window.innerWidth-24,t=window.innerHeight-80-24;else{let a=v.current.getBoundingClientRect(),r=getComputedStyle(v.current),n=parseFloat(r.paddingTop),l=parseFloat(r.paddingBottom),i=parseFloat(r.paddingLeft),s=parseFloat(r.paddingRight),o=parseFloat(r.gap)||16,d=v.current.querySelector("[data-toolbar]"),c=d?d.getBoundingClientRect().height:0;e=a.width-i-s,t=a.height-n-l-c-(c>0?o:0)}let n=p.width/p.height;e/t>n?a=(r=t*(y?.95:1))*n:r=(a=e*(y?.95:1))/n,b({width:a,height:r})};e();let t=new ResizeObserver(e);return v.current&&t.observe(v.current),y&&window.addEventListener("resize",e),()=>{t.disconnect(),y&&window.removeEventListener("resize",e)}},[p.width,p.height,y]),(0,o.useEffect)(()=>{let e=e=>{"Escape"===e.key&&y&&w(!1)};return y?(document.addEventListener("keydown",e),document.body.style.overflow="hidden"):document.body.style.overflow="",()=>{document.removeEventListener("keydown",e),document.body.style.overflow=""}},[y]),(0,o.useEffect)(()=>{let e=e=>{if(!S.isDragging)return;let t=e.clientX-S.startX,a=e.clientY-S.startY,r=j.width/p.width,n=S.initialElementX+t/r,l=S.initialElementY+a/r,i=S.elementWidth/r/2,s=S.elementHeight/r/2,o=Math.max(-p.width/2+i,Math.min(p.width/2-i,n)),d=Math.max(-p.height/2+s,Math.min(p.height/2-s,l));k(e=>({...e,currentX:o,currentY:d}))},t=()=>{S.isDragging&&S.trackId&&S.elementId&&a(S.trackId,S.elementId,{x:S.currentX,y:S.currentY}),k(e=>({...e,isDragging:!1}))};return S.isDragging&&(document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),document.body.style.cursor="grabbing",document.body.style.userSelect="none"),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.body.style.cursor="",document.body.style.userSelect=""}},[S,j,p,a]);let E=(0,o.useCallback)(()=>{w(e=>!e)},[]),C=e.some(e=>e.elements.length>0),T=(()=>{let t=[];return e.forEach(e=>{e.elements.forEach(a=>{if(a.hidden)return;let r=a.startTime,n=a.startTime+(a.duration-a.trimStart-a.trimEnd);if(m>=r&&m<n){let r=null;"media"===a.type&&(r="test"===a.mediaId?null:u.find(e=>e.id===a.mediaId)||null),t.push({element:a,track:e,mediaItem:r})}})}),t})(),A=T.filter(e=>{let{element:t,mediaItem:a}=e;return"media"===t.type&&a&&("video"===a.type||"image"===a.type)&&"test"!==t.mediaId}),D=()=>{if(!(null==N?void 0:N.backgroundType)||"blur"!==N.backgroundType||0===A.length)return null;let{element:e,mediaItem:t}=A[0];if(!t)return null;let a=N.blurIntensity||8;return"video"===t.type?(0,r.jsx)("div",{className:"absolute inset-0 overflow-hidden",style:{filter:"blur(".concat(a,"px)"),transform:"scale(1.1)",transformOrigin:"center"},children:(0,r.jsx)(d,{src:t.url,poster:t.thumbnailUrl,clipStartTime:e.startTime,trimStart:e.trimStart,trimEnd:e.trimEnd,clipDuration:e.duration,className:"w-full h-full object-cover"})},"blur-".concat(e.id)):"image"===t.type?(0,r.jsx)("div",{className:"absolute inset-0 overflow-hidden",style:{filter:"blur(".concat(a,"px)"),transform:"scale(1.1)",transformOrigin:"center"},children:(0,r.jsx)("img",{src:t.url,alt:t.name,className:"w-full h-full object-cover",draggable:!1})},"blur-".concat(e.id)):null},I=(e,t)=>{let{element:a,mediaItem:n}=e;if("text"===a.type){let n=R[a.fontFamily]||"",l=j.width/p.width;return(0,r.jsx)("div",{className:"absolute flex items-center justify-center cursor-grab",onMouseDown:t=>((e,t,a)=>{e.preventDefault(),e.stopPropagation();let r=e.currentTarget.getBoundingClientRect();k({isDragging:!0,elementId:t.id,trackId:a,startX:e.clientX,startY:e.clientY,initialElementX:t.x,initialElementY:t.y,currentX:t.x,currentY:t.y,elementWidth:r.width,elementHeight:r.height})})(t,a,e.track.id),style:{left:"".concat(50+(S.isDragging&&S.elementId===a.id?S.currentX:a.x)/p.width*100,"%"),top:"".concat(50+(S.isDragging&&S.elementId===a.id?S.currentY:a.y)/p.height*100,"%"),transform:"translate(-50%, -50%) rotate(".concat(a.rotation,"deg) scale(").concat(l,")"),opacity:a.opacity,zIndex:100+t},children:(0,r.jsx)("div",{className:n,style:{fontSize:"".concat(a.fontSize,"px"),color:a.color,backgroundColor:a.backgroundColor,textAlign:a.textAlign,fontWeight:a.fontWeight,fontStyle:a.fontStyle,textDecoration:a.textDecoration,padding:"4px 8px",borderRadius:"2px",whiteSpace:"pre-wrap",...""===n&&{fontFamily:a.fontFamily}},children:a.content})},a.id)}if("media"===a.type){if(!n||"test"===a.mediaId)return(0,r.jsx)("div",{className:"absolute inset-0 bg-linear-to-br from-blue-500/20 to-purple-500/20 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl mb-2",children:"\uD83C\uDFAC"}),(0,r.jsx)("p",{className:"text-xs text-foreground",children:a.name})]})},a.id);if("video"===n.type)return(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)(d,{src:n.url,poster:n.thumbnailUrl,clipStartTime:a.startTime,trimStart:a.trimStart,trimEnd:a.trimEnd,clipDuration:a.duration})},a.id);if("image"===n.type)return(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("img",{src:n.url,alt:n.name,className:"max-w-full max-h-full object-contain",draggable:!1})},a.id);if("audio"===n.type)return(0,r.jsx)("div",{className:"absolute inset-0",children:(0,r.jsx)(c,{src:n.url,clipStartTime:a.startTime,trimStart:a.trimStart,trimEnd:a.trimEnd,clipDuration:a.duration,trackMuted:e.track.muted})},a.id)}return null};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"h-full w-full flex flex-col min-h-0 min-w-0 bg-panel rounded-sm relative",children:(0,r.jsxs)("div",{ref:v,className:"flex-1 flex flex-col items-center justify-center min-h-0 min-w-0",children:[(0,r.jsx)("div",{className:"flex-1"}),C?(0,r.jsxs)("div",{ref:g,className:"relative overflow-hidden border",style:{width:j.width,height:j.height,background:(null==N?void 0:N.backgroundType)==="blur"?"transparent":(null==N?void 0:N.backgroundColor)||"#000000"},children:[D(),0===T.length?(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-muted-foreground",children:"No elements at current time"}):T.map((e,t)=>I(e,t)),(null==N?void 0:N.backgroundType)==="blur"&&0===A.length&&T.length>0&&(0,r.jsx)("div",{className:"absolute bottom-2 left-2 right-2 bg-black/70 text-white text-xs p-2 rounded",children:"Add a video or image to use blur background"})]}):null,(0,r.jsx)("div",{className:"flex-1"}),(0,r.jsx)(P,{hasAnyElements:C,onToggleExpanded:E,isExpanded:y,currentTime:m,setCurrentTime:h,toggle:f,getTotalDuration:t})]})}),y&&(0,r.jsx)(L,{previewDimensions:j,activeProject:N,renderBlurBackground:D,activeElements:T,renderElement:I,blurBackgroundElements:A,hasAnyElements:C,toggleExpanded:E,currentTime:m,setCurrentTime:h,toggle:f,getTotalDuration:t})]})}function I(e){let{hasAnyElements:t,onToggleExpanded:a,currentTime:n,setCurrentTime:l,toggle:s,getTotalDuration:d}=e,{isPlaying:c,seek:b}=(0,i.E)(),{activeProject:y}=(0,M.I)(),[w,N]=(0,o.useState)(!1),S=d(),k=S>0?n/S*100:0;return(0,r.jsxs)("div",{"data-toolbar":!0,className:"flex items-center gap-2 p-1 pt-2 w-full text-foreground relative",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1 text-[0.70rem] tabular-nums text-foreground/90",children:[(0,r.jsx)(j,{time:n,duration:S,format:"HH:MM:SS:FF",fps:(null==y?void 0:y.fps)||30,onTimeChange:b,disabled:!t,className:"text-foreground/90 hover:bg-white/10"}),(0,r.jsx)("span",{className:"opacity-50",children:"/"}),(0,r.jsx)("span",{children:(0,v.s)(S,"HH:MM:SS:FF",(null==y?void 0:y.fps)||30)})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(u.$,{variant:"text",size:"icon",onClick:()=>{l(Math.max(0,n-1))},disabled:!t,className:"h-auto p-0 text-foreground",title:"Skip backward 1s",children:(0,r.jsx)(m.A,{className:"h-3 w-3"})}),(0,r.jsx)(u.$,{variant:"text",size:"icon",onClick:s,disabled:!t,className:"h-auto p-0 text-foreground hover:text-foreground/80",children:c?(0,r.jsx)(f.A,{className:"h-3 w-3"}):(0,r.jsx)(h.A,{className:"h-3 w-3"})}),(0,r.jsx)(u.$,{variant:"text",size:"icon",onClick:()=>{l(Math.min(S,n+1))},disabled:!t,className:"h-auto p-0 text-foreground hover:text-foreground/80",title:"Skip forward 1s",children:(0,r.jsx)(x.A,{className:"h-3 w-3"})})]}),(0,r.jsx)("div",{className:"flex-1 flex items-center gap-2",children:(0,r.jsxs)("div",{className:(0,g.cn)("relative h-1 rounded-full cursor-pointer flex-1 bg-foreground/20",!t&&"opacity-50 cursor-not-allowed"),onClick:t?e=>{if(!t)return;let a=e.currentTarget.getBoundingClientRect();l(Math.max(0,Math.min(Math.max(0,Math.min(1,(e.clientX-a.left)/a.width))*S,S)))}:void 0,onMouseDown:t?e=>{if(!t)return;e.preventDefault(),e.stopPropagation();let a=e.currentTarget.getBoundingClientRect();N(!0);let r=e=>{e.preventDefault(),l(Math.max(0,Math.min(Math.max(0,Math.min(1,(e.clientX-a.left)/a.width))*S,S)))},n=()=>{N(!1),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",n),document.body.style.userSelect=""};document.body.style.userSelect="none",document.addEventListener("mousemove",r),document.addEventListener("mouseup",n),r(e.nativeEvent)}:void 0,style:{userSelect:"none"},children:[(0,r.jsx)("div",{className:(0,g.cn)("absolute top-0 left-0 h-full rounded-full bg-foreground",!w&&"duration-100"),style:{width:"".concat(k,"%")}}),(0,r.jsx)("div",{className:"absolute top-1/2 w-3 h-3 rounded-full -translate-y-1/2 -translate-x-1/2 shadow-xs bg-foreground border border-black/20",style:{left:"".concat(k,"%")}})]})}),(0,r.jsx)(u.$,{variant:"text",size:"icon",className:"size-4! text-foreground/80 hover:text-foreground",onClick:a,title:"Exit fullscreen (Esc)",children:(0,r.jsx)(p.A,{className:"size-4!"})})]})}function L(e){let{previewDimensions:t,activeProject:a,renderBlurBackground:n,activeElements:l,renderElement:i,blurBackgroundElements:s,hasAnyElements:o,toggleExpanded:d,currentTime:c,setCurrentTime:u,toggle:m,getTotalDuration:f}=e;return(0,r.jsxs)("div",{className:"fixed inset-0 z-9999 flex flex-col",children:[(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center bg-background",children:(0,r.jsxs)("div",{className:"relative overflow-hidden border border-border m-3",style:{width:t.width,height:t.height,background:(null==a?void 0:a.backgroundType)==="blur"?"#1a1a1a":(null==a?void 0:a.backgroundColor)||"#1a1a1a"},children:[n(),0===l.length?(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-white/60",children:"No elements at current time"}):l.map((e,t)=>i(e,t)),(null==a?void 0:a.backgroundType)==="blur"&&0===s.length&&l.length>0&&(0,r.jsx)("div",{className:"absolute bottom-2 left-2 right-2 bg-black/70 text-white text-xs p-2 rounded",children:"Add a video or image to use blur background"})]})}),(0,r.jsx)("div",{className:"p-4 bg-background",children:(0,r.jsx)(I,{hasAnyElements:o,onToggleExpanded:d,currentTime:c,setCurrentTime:u,toggle:m,getTotalDuration:f})})]})}function P(e){let{hasAnyElements:t,onToggleExpanded:a,isExpanded:n,currentTime:l,setCurrentTime:s,toggle:o,getTotalDuration:d}=e,{isPlaying:c}=(0,i.E)();return n?(0,r.jsx)(I,{hasAnyElements:t,onToggleExpanded:a,currentTime:l,setCurrentTime:s,toggle:o,getTotalDuration:d}):(0,r.jsx)("div",{"data-toolbar":!0,className:"flex justify-between gap-2 px-1.5 pr-4 py-1.5 border border-border/50 w-auto absolute bottom-4 right-4 bg-black/20 rounded-full backdrop-blur-l text-white",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(u.$,{variant:"text",size:"icon",onClick:o,disabled:!t,className:"h-auto p-0",children:c?(0,r.jsx)(f.A,{className:"h-3 w-3"}):(0,r.jsx)(h.A,{className:"h-3 w-3"})}),(0,r.jsx)(u.$,{variant:"text",size:"icon",className:"size-4!",onClick:a,title:"Enter fullscreen",children:(0,r.jsx)(p.A,{className:"size-4!"})})]})})}},4600:(e,t,a)=>{a.d(t,{a:()=>n,s:()=>r});let r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HH:MM:SS:CS",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,r=Math.floor(e/3600),n=Math.floor(e%3600/60),l=Math.floor(e%60),i=Math.floor(e%1*100),s=Math.floor(e%1*a);switch(t){case"MM:SS":return"".concat(n.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"));case"HH:MM:SS":return"".concat(r.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"));case"HH:MM:SS:CS":return"".concat(r.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"),":").concat(i.toString().padStart(2,"0"));case"HH:MM:SS:FF":return"".concat(r.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(l.toString().padStart(2,"0"),":").concat(s.toString().padStart(2,"0"))}},n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"HH:MM:SS:CS",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(!e||"string"!=typeof e)return null;let r=e.trim();try{switch(t){case"MM:SS":{let e=r.split(":");if(2!==e.length)return null;let[t,a]=e.map(e=>parseInt(e,10));if(isNaN(t)||isNaN(a)||t<0||a<0||a>=60)return null;return 60*t+a}case"HH:MM:SS":{let e=r.split(":");if(3!==e.length)return null;let[t,a,n]=e.map(e=>parseInt(e,10));if(isNaN(t)||isNaN(a)||isNaN(n)||t<0||a<0||n<0||a>=60||n>=60)return null;return 3600*t+60*a+n}case"HH:MM:SS:CS":{let e=r.split(":");if(4!==e.length)return null;let[t,a,n,l]=e.map(e=>parseInt(e,10));if(isNaN(t)||isNaN(a)||isNaN(n)||isNaN(l)||t<0||a<0||n<0||l<0||a>=60||n>=60||l>=100)return null;return 3600*t+60*a+n+l/100}case"HH:MM:SS:FF":{let e=r.split(":");if(4!==e.length)return null;let[t,n,l,i]=e.map(e=>parseInt(e,10));if(isNaN(t)||isNaN(n)||isNaN(l)||isNaN(i)||t<0||n<0||l<0||i<0||n>=60||l>=60||i>=a)return null;return 3600*t+60*n+l+i/a}}}catch(e){}return null}},4976:(e,t,a)=>{a.d(t,{K:()=>Z});var r=a(28064),n=a(10952),l=a(61309),i=a(15482),s=a(87537),o=a(9061),d=a(16224),c=a(43589),u=a(81450),m=a(53093),f=a(45440),h=a(47888),x=a(82549),p=a(26796),g=a(65763),v=a(56139),j=a(79899),b=a(87134),y=a(73539),w=a(20288),N=a(26530),S=a(19884),k=a(43811),E=a(46438),C=a(86434),T=a(8300),A=a(80196),R=a(81925),M=a(82337),D=a(74188),I=a(41134),L=a(61557),P=a(64889),z=a(61275),F=a(85531),O=a(41662),_=a(90617);let X=e=>{let{audioUrl:t,height:a=32,className:n=""}=e,l=(0,D.useRef)(null),i=(0,D.useRef)(null),[s,o]=(0,D.useState)(!0),[d,c]=(0,D.useState)(!1);return((0,D.useEffect)(()=>{let e=!0,r=i.current,n=async()=>{if(l.current&&t)try{r&&(i.current=null);let n=_.A.create({container:l.current,waveColor:"rgba(255, 255, 255, 0.6)",progressColor:"rgba(255, 255, 255, 0.9)",cursorColor:"transparent",barWidth:2,barGap:1,height:a,normalize:!0,interact:!1});if(e)i.current=n;else{try{n.destroy()}catch(e){}return}n.on("ready",()=>{e&&(o(!1),c(!1))}),n.on("error",t=>{e&&(c(!0),o(!1))}),await n.load(t)}catch(t){e&&(c(!0),o(!1))}};return r?(i.current=null,requestAnimationFrame(()=>{try{r.destroy()}catch(e){}e&&n()})):n(),()=>{e=!1;let t=i.current;i.current=null,t&&requestAnimationFrame(()=>{try{t.destroy()}catch(e){}})}},[t,a]),d)?(0,r.jsx)("div",{className:"flex items-center justify-center ".concat(n),style:{height:a},children:(0,r.jsx)("span",{className:"text-xs text-foreground/60",children:"Audio unavailable"})}):(0,r.jsxs)("div",{className:"relative ".concat(n),children:[s&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-xs text-foreground/60",children:"Loading..."})}),(0,r.jsx)("div",{ref:l,className:"w-full transition-opacity duration-200 ".concat(s?"opacity-0":"opacity-100"),style:{height:a}})]})};var B=a(87100);function U(e){let{element:t,track:a,zoomLevel:n,isSelected:l,onElementMouseDown:i,onElementClick:s}=e,{mediaItems:o}=(0,A.B)(),{updateElementTrim:c,updateElementDuration:u,removeElementFromTrack:m,removeElementFromTrackWithRipple:f,dragState:h,splitElement:p,addElementToTrack:g,replaceElementMedia:v,rippleEditingEnabled:b,toggleElementHidden:w}=(0,T.A)(),{currentTime:N}=(0,R.E)(),S="media"===t.type?o.find(e=>e.id===t.mediaId):null,k=(null==S?void 0:S.type)==="audio",{resizing:E,handleResizeStart:I,handleResizeMove:_,handleResizeEnd:U}=function(e){let{element:t,track:a,zoomLevel:r,onUpdateTrim:n,onUpdateDuration:l}=e,[i,s]=(0,D.useState)(null),{mediaItems:o}=(0,A.B)(),{updateElementStartTime:d,updateElementTrim:c,updateElementDuration:u,pushHistory:m}=(0,T.A)();(0,D.useEffect)(()=>{if(!i)return;let e=e=>{h({clientX:e.clientX})},t=()=>{x()};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}},[i]);let f=()=>{if("text"===t.type)return!0;if("media"===t.type){let e=o.find(e=>e.id===t.mediaId);if(!e)return!1;if("image"===e.type)return!0}return!1},h=e=>{var n;if(!i)return;let l=(e.clientX-i.startX)/(50*r),s=(null==(n=M.I.getState().activeProject)?void 0:n.fps)||30;if("left"===i.side){let e=t.duration-i.initialTrimEnd-.1,r=i.initialTrimStart+l;if(r>=0){let n=(0,B.gY)(Math.min(e,r),s),l=n-i.initialTrimStart,o=(0,B.gY)(t.startTime+l,s);c(a.id,t.id,n,i.initialTrimEnd,!1),d(a.id,t.id,o,!1)}else if(f()){let e=Math.min(Math.abs(r),t.startTime),n=(0,B.gY)(t.startTime-e,s),l=(0,B.gY)(t.duration+e,s);c(a.id,t.id,0,i.initialTrimEnd,!1),u(a.id,t.id,l,!1),d(a.id,t.id,n,!1)}else{let e=0-i.initialTrimStart,r=(0,B.gY)(t.startTime+e,s);c(a.id,t.id,0,i.initialTrimEnd,!1),d(a.id,t.id,r,!1)}}else{let e=i.initialTrimEnd-l;if(e<0)if(f()){let r=Math.abs(e),n=(0,B.gY)(t.duration+r,s);u(a.id,t.id,n,!1),c(a.id,t.id,i.initialTrimStart,0,!1)}else c(a.id,t.id,i.initialTrimStart,0,!1);else{let e=t.startTime+t.duration-t.trimStart-t.trimEnd,r=(0,B.gY)(e+l,s),n=Math.max(0,t.duration-t.trimStart-(r-t.startTime)),i=Math.min(t.duration-t.trimStart-.1,n);c(a.id,t.id,t.trimStart,i,!1)}}},x=()=>{s(null)};return{resizing:i,isResizing:null!==i,handleResizeStart:(e,a,r)=>{e.stopPropagation(),e.preventDefault(),m(),s({elementId:a,side:r,startX:e.clientX,initialTrimStart:t.trimStart,initialTrimEnd:t.trimEnd})},handleResizeMove:()=>{},handleResizeEnd:()=>{}}}({element:t,track:a,zoomLevel:n,onUpdateTrim:c,onUpdateDuration:u}),$=t.duration-t.trimStart-t.trimEnd,H=Math.max(B.of.ELEMENT_MIN_WIDTH,$*B.of.PIXELS_PER_SECOND*n),W=h.elementId===t.id,Y=50*(W&&h.isDragging?h.currentTime:t.startTime)*n;return(0,r.jsxs)(C.tz,{children:[(0,r.jsx)(C.Rc,{asChild:!0,children:(0,r.jsx)("div",{className:"absolute top-0 h-full select-none timeline-element ".concat(W?"z-50":"z-10"),style:{left:"".concat(Y,"px"),width:"".concat(H,"px")},"data-element-id":t.id,"data-track-id":a.id,onMouseMove:E?_:void 0,onMouseUp:E?U:void 0,onMouseLeave:E?U:void 0,children:(0,r.jsxs)("div",{className:"relative h-full rounded-[0.15rem] cursor-pointer overflow-hidden ".concat((0,B.A0)(a.type)," ").concat(""," ").concat(W?"z-50":"z-10"," ").concat(t.hidden?"opacity-50":""),onClick:e=>s&&s(e,t),onMouseDown:e=>{i&&i(e,t)},onContextMenu:e=>i&&i(e,t),children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center h-full",children:(()=>{if("text"===t.type)return(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-start pl-2",children:(0,r.jsx)("span",{className:"text-xs text-white truncate",children:t.content})});let e=o.find(e=>e.id===t.mediaId);if(!e)return(0,r.jsx)("span",{className:"text-xs text-foreground/80 truncate",children:t.name});if("image"===e.type||"video"===e.type&&e.thumbnailUrl){let t=(0,B.t_)(a.type),n=16/9*t,i="image"===e.type?e.url:e.thumbnailUrl,s="image"===e.type;return(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-full h-full relative ".concat(l?"bg-primary":"bg-transparent"),children:(0,r.jsx)("div",{className:"absolute top-[0.15rem] bottom-[0.15rem] left-0 right-0",style:{backgroundImage:i?"url(".concat(i,")"):"none",backgroundRepeat:"repeat-x",backgroundSize:"".concat(n,"px ").concat(t,"px"),backgroundPosition:"left center",pointerEvents:"none"},"aria-label":"Tiled ".concat(s?"background":"thumbnail"," of ").concat(e.name)})})})}return"audio"===e.type?(0,r.jsx)("div",{className:"w-full h-full flex items-center gap-2",children:(0,r.jsx)("div",{className:"flex-1 min-w-0",children:(0,r.jsx)(X,{audioUrl:e.url||"",height:24,className:"w-full"})})}):(0,r.jsx)("span",{className:"text-xs text-foreground/80 truncate",children:t.name})})()}),t.hidden&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center pointer-events-none",children:k?(0,r.jsx)(P.A,{className:"h-6 w-6 text-white"}):(0,r.jsx)(z.A,{className:"h-6 w-6 text-white"})}),l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-[0.2rem] cursor-w-resize bg-primary z-50",onMouseDown:e=>I(e,t.id,"left")}),(0,r.jsx)("div",{className:"absolute right-0 top-0 bottom-0 w-[0.2rem] cursor-e-resize bg-primary z-50",onMouseDown:e=>I(e,t.id,"right")})]})]})})}),(0,r.jsxs)(C.Ip,{className:"z-200",children:[(0,r.jsxs)(C.kt,{onClick:e=>{e.stopPropagation();let r=t.startTime,n=t.startTime+(t.duration-t.trimStart-t.trimEnd);N>r&&N<n?p(a.id,t.id,N)||L.oR.error("Failed to split element"):L.oR.error("Playhead must be within element to split")},children:[(0,r.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Split at playhead"]}),(0,r.jsxs)(C.kt,{onClick:e=>{e.stopPropagation(),w(a.id,t.id)},children:[k?t.hidden?(0,r.jsx)(F.A,{className:"h-4 w-4 mr-2"}):(0,r.jsx)(P.A,{className:"h-4 w-4 mr-2"}):t.hidden?(0,r.jsx)(d.A,{className:"h-4 w-4 mr-2"}):(0,r.jsx)(z.A,{className:"h-4 w-4 mr-2"}),(0,r.jsxs)("span",{children:[k?t.hidden?"Unmute":"Mute":t.hidden?"Show":"Hide"," ","text"===t.type?"text":"clip"]})]}),(0,r.jsxs)(C.kt,{onClick:e=>{e.stopPropagation();let{id:r,...n}=t;g(a.id,{...n,name:t.name+" (copy)",startTime:t.startTime+(t.duration-t.trimStart-t.trimEnd)+.1})},children:[(0,r.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Duplicate ","text"===t.type?"text":"clip"]}),"media"===t.type&&(0,r.jsxs)(C.kt,{onClick:e=>{if(e.stopPropagation(),"media"!==t.type)return void L.oR.error("Replace is only available for media clips");let r=document.createElement("input");r.type="file",r.accept="video/*,audio/*,image/*",r.onchange=async e=>{var r;let n=null==(r=e.target.files)?void 0:r[0];if(n)try{let e=await v(a.id,t.id,n);e.success?L.oR.success("Clip replaced successfully"):L.oR.error(e.error||"Failed to replace clip")}catch(e){L.oR.error("Unexpected error: ".concat(e instanceof Error?e.message:"Unknown error"))}},r.click()},children:[(0,r.jsx)(O.A,{className:"h-4 w-4 mr-2"}),"Replace clip"]}),(0,r.jsx)(C.K5,{}),(0,r.jsxs)(C.kt,{onClick:e=>{e.stopPropagation(),b?f(a.id,t.id):m(a.id,t.id)},className:"text-destructive focus:text-destructive",children:[(0,r.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Delete ","text"===t.type?"text":"clip"]})]})]})}var $=a(14700);function H(e){let{track:t,zoomLevel:a,onSnapPointChange:n}=e,{mediaItems:l}=(0,A.B)(),{tracks:i,addTrack:s,moveElementToTrack:o,updateElementStartTime:d,updateElementStartTimeWithRipple:c,addElementToTrack:u,selectedElements:m,selectElement:f,dragState:h,startDrag:x,updateDragTime:p,endDrag:g,clearSelectedElements:v,insertTrackAt:j,snappingEnabled:b,rippleEditingEnabled:y}=(0,T.A)(),{currentTime:w}=(0,R.E)(),{snapElementPosition:N,snapElementEdge:S}=function(){let{snapThreshold:e=10,enableElementSnapping:t=!0,enablePlayheadSnapping:a=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,D.useCallback)((e,r,n,l,i)=>{let s=[];return t&&e.forEach(e=>{e.elements.forEach(t=>{if(t.id===i)return;let a=t.startTime,r=t.startTime+(t.duration-t.trimStart-t.trimEnd);s.push({time:a,type:"element-start",elementId:t.id,trackId:e.id},{time:r,type:"element-end",elementId:t.id,trackId:e.id})})}),a&&s.push({time:n,type:"playhead"}),s},[t,a]),n=(0,D.useCallback)((t,a,r)=>{let n=e/(B.of.PIXELS_PER_SECOND*r),l=null,i=1/0;return a.forEach(e=>{let a=Math.abs(t-e.time);a<n&&a<i&&(i=a,l=e)}),{snappedTime:l?l.time:t,snapPoint:l,snapDistance:i}},[e]);return{snapElementPosition:(0,D.useCallback)((e,t,a,l,i)=>{let s=r(t,e,a,l,i);return n(e,s,l)},[r,n]),snapElementEdge:(0,D.useCallback)(function(e,t,a,l,i,s){let o=!(arguments.length>6)||void 0===arguments[6]||arguments[6],d=r(a,e,l,i,s),c=n(o?e:e+t,d,i);return!o&&c.snapPoint&&(c.snappedTime=c.snappedTime-t),c},[r,n]),findSnapPoints:r,snapToNearestPoint:n}}({snapThreshold:10,enableElementSnapping:b,enablePlayheadSnapping:b}),k=(e,t,r)=>{var n;let l=(null==(n=M.I.getState().activeProject)?void 0:n.fps)||30,s=(0,B.gY)(e,l);if(b){let n=S(e,t,i,w,a,r,!0),l=S(e,t,i,w,a,r,!1),o=n;l.snapPoint&&(!n.snapPoint||l.snapDistance<n.snapDistance)&&(o=l),o.snapPoint&&(s=o.snappedTime)}return s},E=(0,D.useRef)(null),[C,I]=(0,D.useState)(!1),[P,z]=(0,D.useState)(null),[F,O]=(0,D.useState)(!1),_=(0,D.useRef)(0),[X,H]=(0,D.useState)(null);(0,D.useEffect)(()=>{if(!h.isDragging)return;let e=e=>{var t;if(!E.current)return;h.elementId&&h.trackId&&(m.some(e=>e.trackId===h.trackId&&e.elementId===h.elementId)||f(h.trackId,h.elementId,!1));let r=E.current.getBoundingClientRect(),l=Math.max(0,Math.max(0,(e.clientX-r.left)/(B.of.PIXELS_PER_SECOND*a))-h.clickOffsetTime),s=(null==(t=M.I.getState().activeProject)?void 0:t.fps)||30,o=(0,B.gY)(l,s),d=null;if(b){let e=5;if(h.elementId&&h.trackId){let t=i.find(e=>e.id===h.trackId),a=null==t?void 0:t.elements.find(e=>e.id===h.elementId);a&&(e=a.duration-a.trimStart-a.trimEnd)}let t=S(l,e,i,w,a,h.elementId||void 0,!0),r=S(l,e,i,w,a,h.elementId||void 0,!1),s=t;r.snapPoint&&(!t.snapPoint||r.snapDistance<t.snapDistance)&&(s=r),s.snapPoint&&(o=s.snappedTime,d=s.snapPoint),null==n||n(d)}else null==n||n(null);p(o)},r=e=>{var a;if(!h.elementId||!h.trackId)return;let r=h.trackId===t.id,l=null==(a=E.current)?void 0:a.getBoundingClientRect();if(!l){r&&(y?c(t.id,h.elementId,h.currentTime):d(t.id,h.elementId,h.currentTime),g(),null==n||n(null));return}let s=e.clientY>=l.top&&e.clientY<=l.bottom;if(!s&&!r)return;let u=h.currentTime;if(s){let e=i.find(e=>e.id===h.trackId),a=null==e?void 0:e.elements.find(e=>e.id===h.elementId);if(a){let e=u+(a.duration-a.trimStart-a.trimEnd),r=i.find(e=>e.id===t.id);(null==r?void 0:r.elements.some(a=>{if(h.trackId===t.id&&a.id===h.elementId)return!1;let r=a.startTime;return u<a.startTime+(a.duration-a.trimStart-a.trimEnd)&&e>r}))||(h.trackId===t.id?y?c(t.id,h.elementId,u):d(t.id,h.elementId,u):(o(h.trackId,t.id,h.elementId),requestAnimationFrame(()=>{y?c(t.id,h.elementId,u):d(t.id,h.elementId,u)})))}}else if(r){let e=i.find(e=>e.id===h.trackId),a=null==e?void 0:e.elements.find(e=>e.id===h.elementId);if(a){let e=u+(a.duration-a.trimStart-a.trimEnd);t.elements.some(t=>{if(t.id===h.elementId)return!1;let a=t.startTime;return u<t.startTime+(t.duration-t.trimStart-t.trimEnd)&&e>a})||(y?c(t.id,h.elementId,u):d(t.id,h.elementId,u))}}r&&(g(),null==n||n(null))};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",r),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",r)}},[h.isDragging,h.clickOffsetTime,h.elementId,h.trackId,h.currentTime,a,i,t.id,p,d,o,g,m,f,n]);let W=(e,r)=>{H({x:e.clientX,y:e.clientY});let n=2===e.button,l=e.metaKey||e.ctrlKey||e.shiftKey;if(n){m.some(e=>e.trackId===t.id&&e.elementId===r.id)||f(t.id,r.id,l);return}l&&f(t.id,r.id,!0);let i=e.currentTarget.getBoundingClientRect(),s=(e.clientX-i.left)/(B.of.PIXELS_PER_SECOND*a);x(r.id,t.id,e.clientX,r.startTime,s)},Y=(e,a)=>{if(e.stopPropagation(),X){let t=Math.abs(e.clientX-X.x),a=Math.abs(e.clientY-X.y);if(t>5||a>5)return void H(null)}e.metaKey||e.ctrlKey||e.shiftKey||m.some(e=>e.trackId===t.id&&e.elementId===a.id)||f(t.id,a.id,!1)};return(0,r.jsx)("div",{className:"w-full h-full hover:bg-muted/20",onClick:e=>{e.target.closest(".timeline-element")||v()},onDragOver:e=>{e.preventDefault();let r=e.dataTransfer.types.includes("application/x-timeline-element"),n=e.dataTransfer.types.includes("application/x-media-item");if(!r&&!n)return;let s=e.currentTarget.querySelector(".track-elements-container"),o=0;if(s){let t=s.getBoundingClientRect();o=Math.max(0,e.clientX-t.left)/(B.of.PIXELS_PER_SECOND*a)}let d=!1;if(n)try{let a=e.dataTransfer.getData("application/x-media-item");if(a){let e=JSON.parse(a);if("text"===e.type){let e=k(o,5),a=e+5;d=t.elements.some(t=>{let r=t.startTime,n=t.startTime+(t.duration-t.trimStart-t.trimEnd);return e<n&&a>r})}else{let a=l.find(t=>t.id===e.id);if(a){let e=a.duration||5,r=k(o,e),n=r+e;d=t.elements.some(e=>{let t=e.startTime,a=e.startTime+(e.duration-e.trimStart-e.trimEnd);return r<a&&n>t})}}}}catch(e){}else if(r)try{let a=e.dataTransfer.getData("application/x-timeline-element");if(a){let{elementId:e,trackId:r}=JSON.parse(a),n=i.find(e=>e.id===r),l=null==n?void 0:n.elements.find(t=>t.id===e);if(l){let a=l.duration-l.trimStart-l.trimEnd,n=k(o,a,e),i=n+a;d=t.elements.some(a=>{if(r===t.id&&a.id===e)return!1;let l=a.startTime,s=a.startTime+(a.duration-a.trimStart-a.trimEnd);return n<s&&i>l})}}}catch(e){}if(d){e.dataTransfer.dropEffect="none",O(!0),z(k(o,5));return}e.dataTransfer.dropEffect=r?"move":"copy",O(!1),z(k(o,5))},onDragEnter:e=>{e.preventDefault();let t=e.dataTransfer.types.includes("application/x-timeline-element"),a=e.dataTransfer.types.includes("application/x-media-item");(t||a)&&(_.current++,I(!0))},onDragLeave:e=>{e.preventDefault();let t=e.dataTransfer.types.includes("application/x-timeline-element"),a=e.dataTransfer.types.includes("application/x-media-item");(t||a)&&(_.current--,0===_.current&&(I(!1),O(!1),z(null)))},onDrop:e=>{var r;let n;e.preventDefault(),e.stopPropagation(),_.current=0,I(!1),O(!1);let m=e.dataTransfer.types.includes("application/x-timeline-element"),f=e.dataTransfer.types.includes("application/x-media-item");if(!m&&!f)return;let h=e.currentTarget.querySelector(".track-elements-container");if(!h)return;let x=h.getBoundingClientRect(),p=Math.max(0,e.clientX-x.left),g=e.clientY-x.top,v=p/(B.of.PIXELS_PER_SECOND*a),b=(null==(r=M.I.getState().activeProject)?void 0:r.fps)||30;(0,B.gY)(v,b);let w=i.findIndex(e=>e.id===t.id);n=g<20?"above":g>40?"below":"on";try{if(m){let a=e.dataTransfer.getData("application/x-timeline-element");if(!a)return;let{elementId:r,trackId:n,clickOffsetTime:l=0}=JSON.parse(a),s=i.find(e=>e.id===n),u=null==s?void 0:s.elements.find(e=>e.id===r);if(!u)return void L.oR.error("Element not found");let m=u.duration-u.trimStart-u.trimEnd,f=v-l,h=k(f,m,r),x=Math.max(0,h),p=x+m;if(t.elements.some(e=>{if(n===t.id&&e.id===r)return!1;let a=e.startTime,l=e.startTime+(e.duration-e.trimStart-e.trimEnd);return x<l&&p>a}))return void L.oR.error("Cannot move element here - it would overlap with existing elements");n===t.id?y?c(t.id,r,x):d(t.id,r,x):(o(n,t.id,r),requestAnimationFrame(()=>{y?c(t.id,r,x):d(t.id,r,x)}))}else if(f){let a=e.dataTransfer.getData("application/x-media-item");if(!a)return;let r=JSON.parse(a);if("text"===r.type){let e=t.id,a=t;if("text"!==t.type||"on"!==n){let t,r=(0,$.xK)(i);t="above"===n?w:"below"===n?w+1:r?i.findIndex(e=>e.id===r.id):0,e=j("text",t);let l=T.A.getState().tracks.find(t=>t.id===e);if(!l)return;a=l}let l=k(v,5),s=l+5;if(a.elements.some(e=>{let t=e.startTime,a=e.startTime+(e.duration-e.trimStart-e.trimEnd);return l<a&&s>t}))return void L.oR.error("Cannot place element here - it would overlap with existing elements");u(e,{type:"text",name:r.name||"Text",content:r.content||"Default Text",duration:B.of.DEFAULT_TEXT_DURATION,startTime:l,trimStart:0,trimEnd:0,fontSize:48,fontFamily:"Arial",color:"#ffffff",backgroundColor:"transparent",textAlign:"center",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",x:0,y:0,rotation:0,opacity:1})}else{let e=l.find(e=>e.id===r.id);if(!e)return void L.oR.error("Media item not found");let a=t.id,o="video"===r.type||"image"===r.type,d="audio"===r.type,c=o?(0,$.hX)("media",t.type):!!d&&(0,$.hX)("media",t.type),m=i.find(e=>e.id===a);if(!c||"on"!==n){if(o){let e=(0,$.xK)(i);if(e)if(0===e.elements.length&&"on"===n)a=e.id,m=e;else{let t;t="above"===n?w:"below"===n?w+1:i.findIndex(t=>t.id===e.id),a=j("media",t);let r=T.A.getState().tracks.find(e=>e.id===a);if(!r)return;m=r}else{a=s("media");let e=T.A.getState().tracks.find(e=>e.id===a);if(!e)return;m=e}}else if(d){let e,t=(0,$.xK)(i);e="above"===n?w:"below"===n?w+1:t?i.findIndex(e=>e.id===t.id)+1:i.length,a=j("audio",e);let r=T.A.getState().tracks.find(e=>e.id===a);if(!r)return;m=r}}if(!m)return;let f=e.duration||5,h=k(v,f),x=h+f;if(m.elements.some(e=>{let t=e.startTime,a=e.startTime+(e.duration-e.trimStart-e.trimEnd);return h<a&&x>t}))return void L.oR.error("Cannot place element here - it would overlap with existing elements");u(a,{type:"media",mediaId:e.id,name:e.name,duration:e.duration||5,startTime:h,trimStart:0,trimEnd:0})}}}catch(e){L.oR.error("Failed to add media to track")}},children:(0,r.jsx)("div",{ref:E,className:"h-full relative track-elements-container min-w-full",children:0===t.elements.length?(0,r.jsx)("div",{className:"h-full w-full rounded-sm border-2 border-dashed flex items-center justify-center text-xs text-muted-foreground transition-colors ".concat(C?F?"border-red-500 bg-red-500/10 text-red-600":"border-blue-500 bg-blue-500/10 text-blue-600":"border-muted/30"),children:C?F?"Cannot drop - would overlap":"Drop element here":""}):(0,r.jsx)(r.Fragment,{children:t.elements.map(e=>{let n=m.some(a=>a.trackId===t.id&&a.elementId===e.id);return(0,r.jsx)(U,{element:e,track:t,zoomLevel:a,isSelected:n,onElementMouseDown:W,onElementClick:Y},e.id)})})})})}function W(e){let{currentTime:t,duration:a,zoomLevel:r,seek:n,rulerRef:l,rulerScrollRef:i,tracksScrollRef:s,playheadRef:o}=e,[d,c]=(0,D.useState)(!1),[u,m]=(0,D.useState)(null),[f,h]=(0,D.useState)(!1),[x,p]=(0,D.useState)(!1),g=(0,D.useRef)(null),v=(0,D.useRef)(0),j=d&&null!==u?u:t,b=(0,D.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),c(!0),w(e)},[a,r]),y=(0,D.useCallback)(e=>{var t;0===e.button&&(null!=o&&null!=(t=o.current)&&t.contains(e.target)||(e.preventDefault(),h(!0),p(!1),c(!0),w(e)))},[a,r]),w=(0,D.useCallback)(e=>{var t;let i=l.current;if(!i)return;let s=i.getBoundingClientRect(),o=e.clientX-s.left,d=Math.max(0,Math.min(50*a*r,o)),c=Math.max(0,Math.min(a,d/(50*r))),u=(null==(t=M.I.getState().activeProject)?void 0:t.fps)||30,f=(0,B.gY)(c,u);m(f),n(f),v.current=e.clientX},[a,r,n,l]),N=(0,D.useCallback)(()=>{var e,t;let n=null==(e=i.current)?void 0:e.querySelector("[data-radix-scroll-area-viewport]"),l=null==(t=s.current)?void 0:t.querySelector("[data-radix-scroll-area-viewport]");if(!n||!l||!d)return;let o=n.getBoundingClientRect(),c=v.current-o.left,u=n.clientWidth,m=Math.max(0,50*a*r-u),f=0;if(c<100&&n.scrollLeft>0?f=-15*(1-Math.max(0,c)/100):c>u-100&&n.scrollLeft<m&&(f=15*(1-Math.max(0,u-100-c)/100)),0!==f){let e=Math.max(0,Math.min(m,n.scrollLeft+f));n.scrollLeft=e,l.scrollLeft=e}d&&(g.current=requestAnimationFrame(N))},[d,i,s,a,r]);return(0,D.useEffect)(()=>{if(!d)return;let e=e=>{w(e),f&&p(!0)},t=e=>{c(!1),null!==u&&n(u),m(null),g.current&&(cancelAnimationFrame(g.current),g.current=null),f&&(h(!1),x||w(e),p(!1))};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),g.current=requestAnimationFrame(N),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t),g.current&&(cancelAnimationFrame(g.current),g.current=null)}},[d,u,n,w,f,x,N]),(0,D.useEffect)(()=>{var e,t;let{isPlaying:a}=R.E.getState();if(!a||d)return;let n=null==(e=i.current)?void 0:e.querySelector("[data-radix-scroll-area-viewport]"),l=null==(t=s.current)?void 0:t.querySelector("[data-radix-scroll-area-viewport]");if(!n||!l)return;let o=50*j*r,c=n.clientWidth,u=n.scrollWidth-c;(o<n.scrollLeft||o>n.scrollLeft+c)&&(n.scrollLeft=l.scrollLeft=Math.max(0,Math.min(u,o-c/2)))},[j,a,r,i,s,d]),{playheadPosition:j,handlePlayheadMouseDown:b,handleRulerMouseDown:y,isDraggingRuler:f}}function Y(e){var t,a;let{currentTime:n,duration:l,zoomLevel:i,tracks:s,seek:o,rulerRef:d,rulerScrollRef:c,tracksScrollRef:u,trackLabelsRef:m,timelineRef:f,playheadRef:h,isSnappingToPlayhead:x=!1}=e,p=(0,D.useRef)(null),g=h||p,[v,j]=(0,D.useState)(0),{playheadPosition:b,handlePlayheadMouseDown:y}=W({currentTime:n,duration:l,zoomLevel:i,seek:o,rulerRef:d,rulerScrollRef:c,tracksScrollRef:u,playheadRef:g});(0,D.useEffect)(()=>{var e;let t=null==(e=u.current)?void 0:e.querySelector("[data-radix-scroll-area-viewport]");if(!t)return;let a=()=>{j(t.scrollLeft)};return j(t.scrollLeft),t.addEventListener("scroll",a),()=>t.removeEventListener("scroll",a)},[u]);let w=(null==(t=f.current)?void 0:t.offsetHeight)||400,N=s.length>0&&(null==m?void 0:m.current)?m.current.offsetWidth:0,S=N+b*B.of.PIXELS_PER_SECOND*i-v,k=l*B.of.PIXELS_PER_SECOND*i,E=null==(a=u.current)?void 0:a.querySelector("[data-radix-scroll-area-viewport]"),C=Math.min(N+k-v,N+((null==E?void 0:E.clientWidth)||1e3)),T=Math.max(N,Math.min(C,S));return(0,r.jsxs)("div",{ref:g,className:"absolute pointer-events-auto z-150",style:{left:"".concat(T,"px"),top:0,height:"".concat(w-4,"px"),width:"2px"},onMouseDown:y,children:[(0,r.jsx)("div",{className:"absolute left-0 w-0.5 cursor-col-resize h-full ".concat("bg-foreground")}),(0,r.jsx)("div",{className:"absolute top-1 left-1/2 transform -translate-x-1/2 w-3 h-3 rounded-full border-2 shadow-xs ".concat(x?"bg-foreground border-foreground":"bg-foreground border-foreground/50")})]})}function q(e){let{startPos:t,currentPos:a,containerRef:n,isActive:l}=e,i=(0,D.useRef)(null);return((0,D.useEffect)(()=>{if(!l||!t||!a||!n.current)return;let e=n.current.getBoundingClientRect(),r=t.x-e.left,s=t.y-e.top,o=a.x-e.left,d=a.y-e.top,c=Math.min(r,o),u=Math.min(s,d),m=Math.abs(o-r),f=Math.abs(d-s);i.current&&(i.current.style.left="".concat(c,"px"),i.current.style.top="".concat(u,"px"),i.current.style.width="".concat(m,"px"),i.current.style.height="".concat(f,"px"))},[t,a,l,n]),l&&t&&a)?(0,r.jsx)("div",{ref:i,className:"absolute pointer-events-none z-50 bg-foreground/10"}):null}function K(e){var t;let{snapPoint:a,zoomLevel:n,isVisible:l,tracks:i,timelineRef:s,trackLabelsRef:o,tracksScrollRef:d}=e,[c,u]=(0,D.useState)(0);if((0,D.useEffect)(()=>{var e;let t=null==(e=d.current)?void 0:e.querySelector("[data-radix-scroll-area-viewport]");if(!t)return;let a=()=>{u(t.scrollLeft)};return u(t.scrollLeft),t.addEventListener("scroll",a),()=>t.removeEventListener("scroll",a)},[d]),!l||!a)return null;let m=(null==(t=s.current)?void 0:t.offsetHeight)||400,f=i.length>0&&(null==o?void 0:o.current)?o.current.offsetWidth:0,h=a.time*B.of.PIXELS_PER_SECOND*n;return(0,r.jsx)("div",{className:"absolute pointer-events-none z-90",style:{left:"".concat(f+h-c,"px"),top:0,height:"".concat(m-8,"px"),width:"2px"},children:(0,r.jsx)("div",{className:"w-0.5 h-full bg-primary/40 opacity-80"})})}var V=a(14138);function Z(){var e;let{tracks:t,getTotalDuration:a,clearSelectedElements:l,snappingEnabled:c,setSelectedElements:u,toggleTrackMute:m,dragState:f}=(0,T.A)(),{mediaItems:h,addMediaItem:x}=(0,A.B)(),{activeProject:p}=(0,M.I)(),{currentTime:g,duration:v,seek:j,setDuration:b,isPlaying:y,toggle:w}=(0,R.E)(),[N,S]=(0,D.useState)(!1),[k,E]=(0,D.useState)(!1),[P,z]=(0,D.useState)(0),F=(0,D.useRef)(0),O=(0,D.useRef)(null),_=(0,D.useRef)(null),[X,U]=(0,D.useState)(!1),$=(0,D.useRef)({isMouseDown:!1,downX:0,downY:0,downTime:0}),{zoomLevel:V,setZoomLevel:Z,handleWheel:J}=function(e){let{containerRef:t,isInTimeline:a=!1}=e,[r,n]=(0,D.useState)(1),l=(0,D.useCallback)(e=>{if(e.ctrlKey||e.metaKey){e.preventDefault();let t=e.deltaY>0?-.15:.15;n(e=>Math.max(.1,Math.min(10,e+t)))}else if(e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY))return},[]);return(0,D.useEffect)(()=>{let e=e=>{var r;a&&(e.ctrlKey||e.metaKey)&&(null==(r=t.current)?void 0:r.contains(e.target))&&e.preventDefault()};return document.addEventListener("wheel",e,{passive:!1}),()=>{document.removeEventListener("wheel",e)}},[a,t]),{zoomLevel:r,setZoomLevel:n,handleWheel:l}}({containerRef:O,isInTimeline:X}),ee=Math.max((v||0)*B.of.PIXELS_PER_SECOND*V,(g+30)*B.of.PIXELS_PER_SECOND*V,(null==(e=O.current)?void 0:e.clientWidth)||1e3),et=(0,D.useRef)(null),ea=(0,D.useRef)(null),er=(0,D.useRef)(null),en=(0,D.useRef)(null),el=(0,D.useRef)(null),ei=(0,D.useRef)(!1),es=(0,D.useRef)(0),eo=(0,D.useRef)(0),ed=(0,D.useRef)(0),{handleRulerMouseDown:ec}=function(e){let{currentTime:t,duration:a,zoomLevel:r,seek:n,rulerRef:l,rulerScrollRef:i,tracksScrollRef:s,playheadRef:o}=e,{handleRulerMouseDown:d,isDraggingRuler:c}=W({currentTime:t,duration:a,zoomLevel:r,seek:n,rulerRef:l,rulerScrollRef:i,tracksScrollRef:s,playheadRef:o});return{handleRulerMouseDown:d,isDraggingRuler:c}}({currentTime:g,duration:v,zoomLevel:V,seek:j,rulerRef:_,rulerScrollRef:et,tracksScrollRef:ea,playheadRef:en}),eu=(0,D.useRef)(null),{selectionBox:em,handleMouseDown:ef,isSelecting:eh,justFinishedSelecting:ex}=function(e){let{containerRef:t,playheadRef:a,onSelectionComplete:r,isEnabled:n=!0}=e,[l,i]=(0,D.useState)(null),[s,o]=(0,D.useState)(!1),d=(0,D.useCallback)(e=>{var t;!(!n||e.target.closest(".timeline-element")||(null==a||null==(t=a.current)?void 0:t.contains(e.target))||e.target.closest("[data-track-labels]"))&&(e.target.closest("[data-ruler-area]")||i({startPos:{x:e.clientX,y:e.clientY},currentPos:{x:e.clientX,y:e.clientY},isActive:!1}))},[n,a]),c=(0,D.useCallback)((e,a)=>{if(!t.current)return;let n=t.current,l=n.getBoundingClientRect();e.x,l.left,e.y,l.top,a.x,l.left,a.y,l.top;let i=n.querySelectorAll(".timeline-element"),s=[];i.forEach(t=>{let r=t.getBoundingClientRect(),n={left:r.left,top:r.top,right:r.right,bottom:r.bottom},l={left:e.x,top:e.y,right:a.x,bottom:a.y},i={left:Math.min(l.left,l.right),top:Math.min(l.top,l.bottom),right:Math.max(l.left,l.right),bottom:Math.max(l.top,l.bottom)},o=t.getAttribute("data-element-id"),d=t.getAttribute("data-track-id");!(n.right<i.left||n.left>i.right||n.bottom<i.top||n.top>i.bottom)&&o&&d&&s.push({trackId:d,elementId:o})}),r(s)},[t,r]);return(0,D.useEffect)(()=>{if(!l)return;let e=e=>{let t=Math.abs(e.clientX-l.startPos.x),a=Math.abs(e.clientY-l.startPos.y),r={...l,currentPos:{x:e.clientX,y:e.clientY},isActive:t>5||a>5||l.isActive};i(r),r.isActive&&c(r.startPos,r.currentPos)},t=()=>{(null==l?void 0:l.isActive)&&(o(!0),setTimeout(()=>{o(!1)},50)),i(null)};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[l,c]),{selectionBox:l,handleMouseDown:d,isSelecting:(null==l?void 0:l.isActive)||!1,justFinishedSelecting:s}}({containerRef:eu,playheadRef:en,onSelectionComplete:e=>{u(e)}}),[ep,eg]=(0,D.useState)(null),ev=f.isDragging&&c&&null!==ep,ej=(0,D.useCallback)(e=>{eg(e)},[]),eb=(0,D.useCallback)(e=>{var t;let a=e.target;a.closest(".timeline-element")||(null==(t=en.current)?void 0:t.contains(a))||a.closest("[data-track-labels]")||($.current={isMouseDown:!0,downX:e.clientX,downY:e.clientY,downTime:e.timeStamp})},[]),ey=(0,D.useCallback)(e=>{var t,a,r;let n,{isMouseDown:i,downX:s,downY:o,downTime:d}=$.current;if($.current={isMouseDown:!1,downX:0,downY:0,downTime:0},!i)return;let c=Math.abs(e.clientX-s),u=Math.abs(e.clientY-o),m=e.timeStamp-d;if(c>5||u>5||m>500||eh||ex||e.target.closest(".timeline-element")||(null==(t=en.current)?void 0:t.contains(e.target)))return;if(e.target.closest("[data-track-labels]"))return void l();l();let f=e.target.closest("[data-ruler-area]"),h=0;if(f){let t=null==(a=et.current)?void 0:a.querySelector("[data-radix-scroll-area-viewport]");if(!t)return;let r=t.getBoundingClientRect();n=e.clientX-r.left,h=t.scrollLeft}else{let t=null==(r=ea.current)?void 0:r.querySelector("[data-radix-scroll-area-viewport]");if(!t)return;let a=t.getBoundingClientRect();n=e.clientX-a.left,h=t.scrollLeft}let x=Math.max(0,Math.min(v,(n+h)/(B.of.PIXELS_PER_SECOND*V))),g=(null==p?void 0:p.fps)||30;j((0,B.gY)(x,g))},[v,V,j,et,ea,l,eh,ex]);(0,D.useEffect)(()=>{b(Math.max(a(),10))},[t,b,a]);let ew=async e=>{var t;if(e.preventDefault(),S(!1),F.current=0,e.dataTransfer.types.includes("application/x-timeline-element"))return;let a=e.dataTransfer.getData("application/x-media-item");if(a)try{let e=JSON.parse(a);if("text"===e.type)T.A.getState().addTextToNewTrack(e);else{let t=h.find(t=>t.id===e.id);if(!t)return void L.oR.error("Media item not found");T.A.getState().addMediaToNewTrack(t)}}catch(e){L.oR.error("Failed to add item to timeline")}else if((null==(t=e.dataTransfer.files)?void 0:t.length)>0){if(!p)return void L.oR.error("No active project");E(!0),z(0);try{for(let t of(await (0,I.T)(e.dataTransfer.files,e=>z(e)))){await x(p.id,t);let e=A.B.getState().mediaItems.find(e=>e.name===t.name&&e.url===t.url);e&&T.A.getState().addMediaToNewTrack(e)}}catch(e){L.oR.error("Failed to process dropped files")}finally{E(!1),z(0)}}};return(0,D.useEffect)(()=>{var e,t,a;let r=null==(e=et.current)?void 0:e.querySelector("[data-radix-scroll-area-viewport]"),n=null==(t=ea.current)?void 0:t.querySelector("[data-radix-scroll-area-viewport]"),l=null==(a=el.current)?void 0:a.querySelector("[data-radix-scroll-area-viewport]");if(!r||!n)return;let i=()=>{let e=Date.now();ei.current||e-es.current<16||(es.current=e,ei.current=!0,n.scrollLeft=r.scrollLeft,ei.current=!1)},s=()=>{let e=Date.now();ei.current||e-eo.current<16||(eo.current=e,ei.current=!0,r.scrollLeft=n.scrollLeft,ei.current=!1)};if(r.addEventListener("scroll",i),n.addEventListener("scroll",s),l){let e=()=>{let e=Date.now();ei.current||e-ed.current<16||(ed.current=e,ei.current=!0,n.scrollTop=l.scrollTop,ei.current=!1)},t=()=>{let e=Date.now();ei.current||e-ed.current<16||(ed.current=e,ei.current=!0,l.scrollTop=n.scrollTop,ei.current=!1)};return l.addEventListener("scroll",e),n.addEventListener("scroll",t),()=>{r.removeEventListener("scroll",i),n.removeEventListener("scroll",s),l.removeEventListener("scroll",e),n.removeEventListener("scroll",t)}}return()=>{r.removeEventListener("scroll",i),n.removeEventListener("scroll",s)}},[]),(0,r.jsxs)("div",{className:"h-full flex flex-col transition-colors duration-200 relative bg-panel rounded-sm overflow-hidden",...{onDragEnter:e=>{e.preventDefault(),!e.dataTransfer.types.includes("application/x-timeline-element")&&(F.current+=1,N||S(!0))},onDragOver:e=>{e.preventDefault()},onDragLeave:e=>{e.preventDefault(),e.dataTransfer.types.includes("application/x-timeline-element")||(F.current-=1,0===F.current&&S(!1))},onDrop:ew},onMouseEnter:()=>U(!0),onMouseLeave:()=>U(!1),children:[(0,r.jsx)(G,{zoomLevel:V,setZoomLevel:Z}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden relative",ref:O,children:[(0,r.jsx)(Y,{currentTime:g,duration:v,zoomLevel:V,tracks:t,seek:j,rulerRef:_,rulerScrollRef:et,tracksScrollRef:ea,trackLabelsRef:er,timelineRef:O,playheadRef:en,isSnappingToPlayhead:ev&&(null==ep?void 0:ep.type)==="playhead"}),(0,r.jsx)(K,{snapPoint:ep,zoomLevel:V,tracks:t,timelineRef:O,trackLabelsRef:er,tracksScrollRef:ea,isVisible:ev}),(0,r.jsxs)("div",{className:"flex bg-panel sticky top-0 z-10",children:[(0,r.jsx)("div",{className:"w-28 shrink-0 bg-panel border-r flex items-center justify-between px-3 py-2",children:(0,r.jsx)("span",{className:"text-sm font-medium text-muted-foreground opacity-0",children:"."})}),(0,r.jsx)("div",{className:"flex-1 relative overflow-hidden h-10",onWheel:e=>{e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY)||J(e)},onMouseDown:ef,onClick:ey,"data-ruler-area":!0,children:(0,r.jsx)(n.F,{className:"w-full",ref:et,children:(0,r.jsxs)("div",{ref:_,className:"relative h-10 select-none cursor-default",style:{width:"".concat(ee,"px")},onMouseDown:ec,children:[(()=>{let e=(e=>{let t=B.of.PIXELS_PER_SECOND*e;return t>=200?.1:t>=100?.5:t>=50?1:t>=25?2:t>=12?5:t>=6?10:30})(V);return Array.from({length:Math.ceil(v/e)+1},(t,a)=>{let n=a*e;if(n>v)return null;let l=n%(e>=1?Math.max(1,e):1)==0;return(0,r.jsx)("div",{className:"absolute top-0 h-4 ".concat(l?"border-l border-muted-foreground/40":"border-l border-muted-foreground/20"),style:{left:"".concat(n*B.of.PIXELS_PER_SECOND*V,"px")},children:(0,r.jsx)("span",{className:"absolute top-1 left-1 text-[0.6rem] ".concat(l?"text-muted-foreground font-medium":"text-muted-foreground/70"),children:(()=>{let t=Math.floor(n/3600),a=Math.floor(n%3600/60),r=n%60;return t>0?"".concat(t,":").concat(a.toString().padStart(2,"0"),":").concat(Math.floor(r).toString().padStart(2,"0")):a>0?"".concat(a,":").concat(Math.floor(r).toString().padStart(2,"0")):e>=1?"".concat(Math.floor(r),"s"):"".concat(r.toFixed(1),"s")})()})},a)}).filter(Boolean)})(),(()=>{var e;let{activeProject:t}=M.I.getState();return(null==t||null==(e=t.bookmarks)?void 0:e.length)?t.bookmarks.map((e,t)=>(0,r.jsx)("div",{className:"absolute top-0 h-10 w-0.5 !bg-primary cursor-pointer",style:{left:"".concat(e*B.of.PIXELS_PER_SECOND*V,"px")},onClick:t=>{t.stopPropagation(),R.E.getState().seek(e)},children:(0,r.jsx)("div",{className:"absolute top-[-1px] left-[-5px] text-primary",children:(0,r.jsx)(i.A,{className:"h-3 w-3 fill-primary"})})},"bookmark-".concat(t))):null})()]})})})]}),(0,r.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[t.length>0&&(0,r.jsx)("div",{ref:er,className:"w-28 shrink-0 border-r overflow-y-auto z-100 bg-panel","data-track-labels":!0,children:(0,r.jsx)(n.F,{className:"w-full h-full",ref:el,children:(0,r.jsx)("div",{className:"flex flex-col gap-1",children:t.map(e=>(0,r.jsx)("div",{className:"flex items-center px-3 group",style:{height:"".concat((0,B.t_)(e.type),"px")},children:(0,r.jsxs)("div",{className:"flex items-center justify-end flex-1 min-w-0 gap-2",children:[e.muted?(0,r.jsx)(s.A,{className:"h-4 w-4 text-destructive cursor-pointer",onClick:()=>m(e.id)}):(0,r.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground cursor-pointer",onClick:()=>m(e.id)}),(0,r.jsx)(d.A,{className:"h-4 w-4 text-muted-foreground"}),(0,r.jsx)(Q,{track:e})]})},e.id))})})}),(0,r.jsxs)("div",{className:"flex-1 relative overflow-hidden",onWheel:e=>{e.shiftKey||Math.abs(e.deltaX)>Math.abs(e.deltaY)||J(e)},onMouseDown:e=>{eb(e),ef(e)},onClick:ey,ref:eu,children:[(0,r.jsx)(q,{startPos:(null==em?void 0:em.startPos)||null,currentPos:(null==em?void 0:em.currentPos)||null,containerRef:eu,isActive:(null==em?void 0:em.isActive)||!1}),(0,r.jsx)(n.F,{className:"w-full h-full",ref:ea,children:(0,r.jsx)("div",{className:"relative flex-1",style:{height:"".concat(Math.max(200,Math.min(800,(0,B.Ij)(t))),"px"),width:"".concat(ee,"px")},children:0===t.length?(0,r.jsx)("div",{}):(0,r.jsx)(r.Fragment,{children:t.map((e,a)=>(0,r.jsxs)(C.tz,{children:[(0,r.jsx)(C.Rc,{asChild:!0,children:(0,r.jsx)("div",{className:"absolute left-0 right-0",style:{top:"".concat((0,B.sn)(t,a),"px"),height:"".concat((0,B.t_)(e.type),"px")},onClick:e=>{e.target.closest(".timeline-element")||l()},children:(0,r.jsx)(H,{track:e,zoomLevel:V,onSnapPointChange:ej})})}),(0,r.jsxs)(C.Ip,{className:"z-200",children:[(0,r.jsx)(C.kt,{onClick:t=>{t.stopPropagation(),m(e.id)},children:e.muted?"Unmute Track":"Mute Track"}),(0,r.jsx)(C.kt,{onClick:e=>e.stopPropagation(),children:"Track settings (soon)"})]})]},e.id))})})})]})]})]})]})}function Q(e){let{track:t}=e;return(0,r.jsxs)(r.Fragment,{children:["media"===t.type&&(0,r.jsx)(c.A,{className:"w-4 h-4 shrink-0 text-muted-foreground"}),"text"===t.type&&(0,r.jsx)(u.A,{className:"w-4 h-4 shrink-0 text-muted-foreground"}),"audio"===t.type&&(0,r.jsx)(m.A,{className:"w-4 h-4 shrink-0 text-muted-foreground"})]})}function G(e){let{zoomLevel:t,setZoomLevel:a}=e,{tracks:n,addTrack:s,addElementToTrack:o,removeElementFromTrack:d,removeElementFromTrackWithRipple:c,selectedElements:u,clearSelectedElements:m,splitElement:C,splitAndKeepLeft:A,splitAndKeepRight:D,separateAudio:I,snappingEnabled:P,toggleSnapping:z,rippleEditingEnabled:F,toggleRippleEditing:O}=(0,T.A)(),{currentTime:_,duration:X,isPlaying:U,toggle:$}=(0,R.E)(),{toggleBookmark:H,isBookmarked:W}=(0,M.I)(),Y=async()=>{await H(_)},q=W(_);return(0,r.jsxs)("div",{className:"border-b flex items-center justify-between px-2 py-1",children:[(0,r.jsx)("div",{className:"flex items-center gap-1 w-full",children:(0,r.jsxs)(E.TooltipProvider,{delayDuration:500,children:[(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:$,className:"mr-2",children:U?(0,r.jsx)(f.A,{className:"h-4 w-4"}):(0,r.jsx)(h.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:U?"Pause (Space)":"Play (Space)"})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,r.jsxs)("div",{className:"text-xs text-muted-foreground font-mono px-2",style:{minWidth:"18ch",textAlign:"center"},children:[_.toFixed(1),"s / ",X.toFixed(1),"s"]}),0===n.length&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>{o(s("media"),{type:"media",mediaId:"test",name:"Test Clip",duration:B.of.DEFAULT_TEXT_DURATION,startTime:0,trimStart:0,trimEnd:0})},className:"text-xs",children:"Add Test Clip"})}),(0,r.jsx)(E.ZI,{children:"Add a test clip to try playback"})]})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:()=>{if(0===u.length)return;let e=0;u.forEach(t=>{let{trackId:a,elementId:r}=t,l=n.find(e=>e.id===a),i=null==l?void 0:l.elements.find(e=>e.id===r);if(i&&l){let t=i.startTime,n=i.startTime+(i.duration-i.trimStart-i.trimEnd);_>t&&_<n&&C(a,r,_)&&e++}}),0===e&&L.oR.error("Playhead must be within selected elements to split")},children:(0,r.jsx)(x.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Split element (Ctrl+S)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:()=>{if(1!==u.length)return void L.oR.error("Select exactly one element");let{trackId:e,elementId:t}=u[0],a=n.find(t=>t.id===e),r=null==a?void 0:a.elements.find(e=>e.id===t);if(!r)return;let l=r.startTime,i=r.startTime+(r.duration-r.trimStart-r.trimEnd);if(_<=l||_>=i)return void L.oR.error("Playhead must be within selected element");A(e,t,_)},children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Split and keep left (Ctrl+Q)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:()=>{if(1!==u.length)return void L.oR.error("Select exactly one element");let{trackId:e,elementId:t}=u[0],a=n.find(t=>t.id===e),r=null==a?void 0:a.elements.find(e=>e.id===t);if(!r)return;let l=r.startTime,i=r.startTime+(r.duration-r.trimStart-r.trimEnd);if(_<=l||_>=i)return void L.oR.error("Playhead must be within selected element");D(e,t,_)},children:(0,r.jsx)(g.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Split and keep right (Ctrl+W)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:()=>{if(1!==u.length)return void L.oR.error("Select exactly one media element to separate audio");let{trackId:e,elementId:t}=u[0],a=n.find(t=>t.id===e);if(!a||"media"!==a.type)return void L.oR.error("Select a media element to separate audio");I(e,t)},children:(0,r.jsx)(v.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Separate audio (Ctrl+D)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:()=>{0!==u.length&&1===u.length&&(u.forEach(e=>{let{trackId:t,elementId:a}=e,r=n.find(e=>e.id===t),l=null==r?void 0:r.elements.find(e=>e.id===a);if(l){let e=l.startTime+(l.duration-l.trimStart-l.trimEnd)+.1,{id:a,...r}=l;o(t,{...r,startTime:e})}}),m())},children:(0,r.jsx)(j.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Duplicate element (Ctrl+D)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:()=>{L.oR.info("Freeze frame functionality coming soon!")},children:(0,r.jsx)(b.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Freeze frame (F)"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:()=>{0!==u.length&&(u.forEach(e=>{let{trackId:t,elementId:a}=e;F?c(t,a):d(t,a)}),m())},children:(0,r.jsx)(y.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Delete element (Delete)"})]}),(0,r.jsx)("div",{className:"w-px h-6 bg-border mx-1"}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:Y,children:(0,r.jsx)(i.A,{className:"h-4 w-4 ".concat(q?"fill-primary text-primary":"")})})}),(0,r.jsx)(E.ZI,{children:q?"Remove bookmark":"Add bookmark"})]})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)(E.TooltipProvider,{delayDuration:500,children:[(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:z,children:P?(0,r.jsx)(w.A,{className:"h-4 w-4 text-primary"}):(0,r.jsx)(w.A,{className:"h-4 w-4"})})}),(0,r.jsx)(E.ZI,{children:"Auto snapping"})]}),(0,r.jsxs)(E.m_,{children:[(0,r.jsx)(E.k$,{asChild:!0,children:(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:O,children:(0,r.jsx)(N.A,{className:"h-4 w-4 ".concat(F?"text-primary":"")})})}),(0,r.jsx)(E.ZI,{children:F?"Disable Ripple Editing":"Enable Ripple Editing"})]})]}),(0,r.jsx)("div",{className:"h-6 w-px bg-border mx-1"}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:()=>{a(Math.max(.25,t-.25))},children:(0,r.jsx)(S.A,{className:"h-4 w-4"})}),(0,r.jsx)(V.A,{className:"w-24",value:[t],onValueChange:e=>{a(e[0])},min:.25,max:4,step:.25}),(0,r.jsx)(l.$,{variant:"text",size:"icon",onClick:()=>{a(Math.min(4,t+.25))},children:(0,r.jsx)(k.A,{className:"h-4 w-4"})})]})]})]})}},8435:(e,t,a)=>{a.d(t,{z:()=>j});var r=a(28064),n=a(74188),l=a(26880),i=a(75141);class s{subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}emit(e){this.listeners.forEach(t=>t(e))}constructor(){this.listeners=[]}}let o=new s,d={};function c(){let e=Object.keys(d);o.emit(e)}function u(e,t){if(d[e]){var a;null==(a=d[e])||a.push(t)}else d[e]=[t];c()}function m(e,t){var a,r;d[e]=null==(a=d[e])?void 0:a.filter(e=>e!==t),(null==(r=d[e])?void 0:r.length)===0&&delete d[e],c()}function f(e,t,a){let r=(0,n.useRef)(t),[l,i]=(0,n.useState)(!1);(0,n.useEffect)(()=>{r.current=t},[t]);let s=(0,n.useCallback)((e,t)=>{r.current(e,t)},[]);(0,n.useEffect)(()=>{let t=void 0===a||("boolean"==typeof a?a:a.current);return t&&!l?(u(e,s),i(!0)):!t&&l&&(m(e,s),i(!1)),()=>{l&&(m(e,s),i(!1))}},[e,s,a,l]),(0,n.useEffect)(()=>{if(a&&"object"==typeof a&&"current"in a){let t=setInterval(()=>{let t=a.current;t!==l&&(t?u(e,s):m(e,s),i(t))},100);return()=>clearInterval(t)}},[e,s,a,l])}var h=a(13893),x=a(8300),p=a(81925),g=a(82337),v=a(61557);function j(e){let{children:t}=e,{isInitializing:a,isPanelsReady:s,initializeApp:o}=(0,i.U)(),{disableKeybindings:c,enableKeybindings:u}=function(){let{disableKeybindings:e,enableKeybindings:t}=(0,h.y)();return{disableKeybindings:e,enableKeybindings:t}}(),{tracks:m,selectedElements:j,clearSelectedElements:b,setSelectedElements:y,removeElementFromTrack:w,splitElement:N,addElementToTrack:S,snappingEnabled:k,toggleSnapping:E,undo:C,redo:T}=(0,x.A)(),{currentTime:A,duration:R,isPlaying:M,toggle:D,seek:I}=(0,p.E)(),{activeProject:L}=(0,g.I)();f("toggle-play",()=>{D()},void 0),f("stop-playback",()=>{M&&D(),I(0)},void 0),f("seek-forward",e=>{var t;I(Math.min(R,A+(null!=(t=null==e?void 0:e.seconds)?t:1)))},void 0),f("seek-backward",e=>{var t;I(Math.max(0,A-(null!=(t=null==e?void 0:e.seconds)?t:1)))},void 0),f("frame-step-forward",()=>{I(Math.min(R,A+1/((null==L?void 0:L.fps)||30)))},void 0),f("frame-step-backward",()=>{I(Math.max(0,A-1/((null==L?void 0:L.fps)||30)))},void 0),f("jump-forward",e=>{var t;I(Math.min(R,A+(null!=(t=null==e?void 0:e.seconds)?t:5)))},void 0),f("jump-backward",e=>{var t;I(Math.max(0,A-(null!=(t=null==e?void 0:e.seconds)?t:5)))},void 0),f("goto-start",()=>{I(0)},void 0),f("goto-end",()=>{I(R)},void 0),f("split-element",()=>{if(1!==j.length)return void v.oR.error("Select exactly one element to split");let{trackId:e,elementId:t}=j[0],a=m.find(t=>t.id===e),r=null==a?void 0:a.elements.find(e=>e.id===t);if(r){let a=r.startTime,n=r.startTime+(r.duration-r.trimStart-r.trimEnd);A>a&&A<n?N(e,t,A):v.oR.error("Playhead must be within selected element")}},void 0),f("delete-selected",()=>{0!==j.length&&(j.forEach(e=>{let{trackId:t,elementId:a}=e;w(t,a)}),b())},void 0),f("select-all",()=>{y(m.flatMap(e=>e.elements.map(t=>({trackId:e.id,elementId:t.id}))))},void 0),f("duplicate-selected",()=>{if(1!==j.length)return void v.oR.error("Select exactly one element to duplicate");let{trackId:e,elementId:t}=j[0],a=m.find(t=>t.id===e),r=null==a?void 0:a.elements.find(e=>e.id===t);if(r){let t=r.startTime+(r.duration-r.trimStart-r.trimEnd)+.1,{id:a,...n}=r;S(e,{...n,startTime:t})}},void 0),f("toggle-snapping",()=>{E()},void 0),f("undo",()=>{C()},void 0),f("redo",()=>{T()},void 0);let{keybindings:P,getKeybindingString:z,keybindingsEnabled:F,isRecording:O}=(0,h.y)();return((0,n.useEffect)(()=>{let e=e=>{let t;if(!F||O)return;let a=z(e);if(!a)return;let r=P[a];if(!r)return;let n=document.activeElement;if(!(n&&("INPUT"===n.tagName||"TEXTAREA"===n.tagName||n.isContentEditable))){var l,i;e.preventDefault(),"seek-forward"===r||"seek-backward"===r?t={seconds:1}:"jump-forward"===r?t={seconds:5}:"jump-backward"===r&&(t={seconds:5}),l=t,null==(i=d[r])||i.forEach(e=>e(l,"keypress"))}};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[P,z,F,O]),(0,n.useEffect)(()=>{a||!s?c():u()},[a,s,c,u]),(0,n.useEffect)(()=>{o()},[o]),a||!s)?(0,r.jsx)("div",{className:"h-screen w-screen flex items-center justify-center bg-background",children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)(l.A,{className:"h-8 w-8 animate-spin text-muted-foreground"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading editor..."})]})}):(0,r.jsx)(r.Fragment,{children:t})}},9466:(e,t,a)=>{a.d(t,{v:()=>i});var r=a(59467),n=a(20159);let l={toolsPanel:45,previewPanel:75,propertiesPanel:20,mainContent:70,timeline:30},i=(0,r.v)()((0,n.Zr)(e=>({...l,mediaViewMode:"grid",setToolsPanel:t=>e({toolsPanel:t}),setPreviewPanel:t=>e({previewPanel:t}),setPropertiesPanel:t=>e({propertiesPanel:t}),setMainContent:t=>e({mainContent:t}),setTimeline:t=>e({timeline:t}),setMediaViewMode:t=>e({mediaViewMode:t})}),{name:"panel-sizes"}))},13893:(e,t,a)=>{a.d(t,{y:()=>s});var r=a(59467),n=a(20159),l=a(93146);let i={space:"toggle-play",j:"seek-backward",k:"toggle-play",l:"seek-forward",left:"frame-step-backward",right:"frame-step-forward","shift+left":"jump-backward","shift+right":"jump-forward",home:"goto-start",end:"goto-end",s:"split-element",n:"toggle-snapping","ctrl+a":"select-all","ctrl+d":"duplicate-selected","ctrl+z":"undo","ctrl+shift+z":"redo","ctrl+y":"redo",delete:"delete-selected",backspace:"delete-selected"},s=(0,r.v)()((0,n.Zr)((e,t)=>({keybindings:{...i},isCustomized:!1,keybindingsEnabled:!0,isRecording:!1,updateKeybinding:(t,a)=>{e(e=>{let r={...e.keybindings};return r[t]=a,{keybindings:r,isCustomized:!0}})},removeKeybinding:t=>{e(e=>{let a={...e.keybindings};return delete a[t],{keybindings:a,isCustomized:!0}})},resetToDefaults:()=>{e({keybindings:{...i},isCustomized:!1})},enableKeybindings:()=>{e({keybindingsEnabled:!0})},disableKeybindings:()=>{e({keybindingsEnabled:!1})},importKeybindings:t=>{for(let[e,a]of Object.entries(t))if("string"!=typeof e||0===e.length)throw Error("Invalid key format: ".concat(e));e({keybindings:{...t},isCustomized:!0})},exportKeybindings:()=>t().keybindings,validateKeybinding:(e,a)=>{let{keybindings:r}=t(),n=r[e];return n&&n!==a?{key:e,existingAction:n,newAction:a}:null},setIsRecording:t=>{e({isRecording:t})},getKeybindingsForAction:e=>{let{keybindings:a}=t();return Object.keys(a).filter(t=>a[t]===e)},getKeybindingString:e=>(function(e){let t=e.target,a=function(e){let t={ctrl:(0,l.lg)()?e.metaKey:e.ctrlKey,alt:e.altKey,shift:e.shiftKey},a=Object.keys(t).filter(e=>t[e]).join("+");return""===a?null:a}(e),r=function(e){var t,a;let r=(null!=(t=e.key)?t:"").toLowerCase(),n=null!=(a=e.code)?a:"";if(r.startsWith("arrow"))return r.slice(5);if("tab"===r)return"tab";if(" "===r||"space"===r)return"space";if("home"===r)return"home";if("end"===r)return"end";if("delete"===r)return"delete";if("backspace"===r)return"backspace";if(n.startsWith("Key")){let e=n.slice(3).toLowerCase();if(1===e.length&&e>="a"&&e<="z")return e}if(n.startsWith("Digit")){let e=n.slice(5);if(1===e.length&&e>="0"&&e<="9")return e}return 1===r.length&&r>="0"&&r<="9"||"/"===r||"."===r||"enter"===r?r:null}(e);return r?a?"shift"===a&&(0,l.Fe)(t)&&(0,l.mr)(t)?null:"".concat(a,"+").concat(r):(0,l.Fe)(t)&&(0,l.mr)(t)?null:"".concat(r):null})(e)}),{name:"opencut-keybindings",version:1}))},14138:(e,t,a)=>{a.d(t,{A:()=>s});var r=a(28064),n=a(74188),l=a(39124),i=a(93146);let s=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsxs)(l.Root,{ref:t,className:(0,i.cn)("relative flex w-full touch-none select-none items-center",a),...n,children:[(0,r.jsx)(l.Track,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20",children:(0,r.jsx)(l.Range,{className:"absolute h-full bg-primary"})}),(0,r.jsx)(l.Thumb,{className:"block h-4 w-4 rounded-full border border-primary/50 bg-background shadow-sm transition-colors focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50"})]})});s.displayName=l.Root.displayName},15467:(e,t,a)=>{a.d(t,{H:()=>l});var r=a(28064),n=a(93146);function l(e){let{leftContent:t,centerContent:a,rightContent:l,className:i,children:s}=e;return s?(0,r.jsx)("header",{className:(0,n.cn)("px-6 h-16 flex items-center",i),children:s}):(0,r.jsxs)("header",{className:(0,n.cn)("px-6 h-14 flex justify-between items-center",i),children:[t&&(0,r.jsx)("div",{className:"flex items-center",children:t}),a&&(0,r.jsx)("div",{className:"flex items-center",children:a}),l&&(0,r.jsx)("div",{className:"flex items-center",children:l})]})}},18377:(e,t,a)=>{a.d(t,{X:()=>P});var r=a(28064),n=a(61309),l=a(90320),i=a(65803),s=a(80647),o=a(23392),d=a(59674),c=a(27940),u=a(8300),m=a(15467),f=a(4600),h=a(82337),x=a(30651),p=a(74188),g=a(61557),v=a(13893),j=a(93146);let b={"toggle-play":{description:"Play/Pause",category:"Playback"},"stop-playback":{description:"Stop playback",category:"Playback"},"seek-forward":{description:"Seek forward 1 second",category:"Playback"},"seek-backward":{description:"Seek backward 1 second",category:"Playback"},"frame-step-forward":{description:"Frame step forward",category:"Navigation"},"frame-step-backward":{description:"Frame step backward",category:"Navigation"},"jump-forward":{description:"Jump forward 5 seconds",category:"Navigation"},"jump-backward":{description:"Jump backward 5 seconds",category:"Navigation"},"goto-start":{description:"Go to timeline start",category:"Navigation"},"goto-end":{description:"Go to timeline end",category:"Navigation"},"split-element":{description:"Split element at playhead",category:"Editing"},"delete-selected":{description:"Delete selected elements",category:"Editing"},"select-all":{description:"Select all elements",category:"Selection"},"duplicate-selected":{description:"Duplicate selected element",category:"Selection"},"toggle-snapping":{description:"Toggle snapping",category:"Editing"},undo:{description:"Undo",category:"History"},redo:{description:"Redo",category:"History"}};var y=a(66981);let w=e=>{let{shortcut:t,isRecording:a,onStartRecording:n}=e,l=t.keys.filter(e=>!(e.includes("Cmd")&&t.keys.includes(e.replace("Cmd","Ctrl"))));return(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[t.icon&&(0,r.jsx)("div",{className:"text-muted-foreground",children:t.icon}),(0,r.jsx)("span",{className:"text-sm",children:t.description})]}),(0,r.jsx)("div",{className:"flex items-center gap-1",children:l.map((e,i)=>(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("div",{className:"flex items-center",children:e.split("+").map((e,l)=>{let s="".concat(t.id,"-").concat(i,"-").concat(l);return(0,r.jsx)(N,{isRecording:a,onStartRecording:()=>n(t),children:e},s)})}),i<l.length-1&&(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:"or"})]},e))})]})},N=e=>{let{children:t,isRecording:a,onStartRecording:l}=e;return(0,r.jsx)(n.$,{variant:"text",size:"sm",className:"inline-flex font-sans text-xs rounded px-2 min-w-6 min-h-6 leading-none items-center justify-center shadow-xs border mr-1 cursor-pointer hover:bg-opacity-80 ".concat(a?"border-primary bg-primary/10":"border bg-accent"),onClick:e=>{e.preventDefault(),e.stopPropagation(),l()},title:a?"Press any key combination...":"Click to edit shortcut",children:t})},S=()=>{let[e,t]=(0,p.useState)(!1),[a,l]=(0,p.useState)(null),{updateKeybinding:i,removeKeybinding:s,getKeybindingString:o,validateKeybinding:d,getKeybindingsForAction:c,setIsRecording:u,resetToDefaults:m,isRecording:f}=(0,v.y)(),{shortcuts:h}=(()=>{let{keybindings:e}=(0,v.y)();return{shortcuts:(0,p.useMemo)(()=>{let t=[],a={};return Object.entries(e).forEach(e=>{let[t,r]=e;r&&(a[r]||(a[r]=[]),a[r].push(t.replace("ctrl",(0,j.C7)()).replace("alt",(0,j.bT)()).replace("shift","Shift").replace("left","").replace("right","").replace("up","").replace("down","").replace("space","Space").replace("home","Home").replace("end","End").replace("delete","Delete").replace("backspace","Backspace").replace("-","+")))}),Object.entries(a).forEach(e=>{let[a,r]=e,n=b[a];n&&t.push({id:a,keys:r,description:n.description,category:n.category,action:a})}),t.sort((e,t)=>e.category!==t.category?e.category.localeCompare(t.category):e.description.localeCompare(t.description))},[e])}})(),N=Array.from(new Set(h.map(e=>e.category)));(0,p.useEffect)(()=>{if(!f||!a)return;let e=e=>{e.preventDefault(),e.stopPropagation();let t=o(e);if(t){let e=d(t,a.action);if(e){g.oR.error('Key "'.concat(t,'" is already bound to "').concat(e.existingAction,'"')),l(null);return}c(a.action).forEach(e=>s(e)),i(t,a.action),u(!1),l(null)}},t=()=>{l(null),u(!1)};return document.addEventListener("keydown",e),document.addEventListener("click",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("click",t)}},[a,o,i,s,d,c,u,f]);let S=e=>{l(e),u(!0)};return(0,r.jsxs)(y.lG,{open:e,onOpenChange:t,children:[(0,r.jsx)(y.zM,{asChild:!0,children:(0,r.jsxs)(n.$,{variant:"text",size:"sm",className:"gap-2",children:[(0,r.jsx)(x.A,{className:"w-4 h-4"}),"Shortcuts"]})}),(0,r.jsxs)(y.Cf,{className:"max-w-2xl overflow-y-auto",children:[(0,r.jsxs)(y.c7,{children:[(0,r.jsxs)(y.L3,{className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{className:"w-5 h-5"}),"Keyboard Shortcuts"]}),(0,r.jsx)(y.rr,{children:"Speed up your video editing workflow with these keyboard shortcuts. Click any shortcut key to edit it."})]}),(0,r.jsx)("div",{className:"space-y-6",children:N.map(e=>(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("h3",{className:"text-xs text-muted-foreground uppercase tracking-wide font-medium",children:e}),(0,r.jsx)("div",{className:"space-y-0.5",children:h.filter(t=>t.category===e).map(e=>(0,r.jsx)(w,{shortcut:e,isRecording:e.action===(null==a?void 0:a.action),onStartRecording:S},e.action))})]},e))}),(0,r.jsx)(y.Es,{children:(0,r.jsx)(n.$,{size:"sm",className:"mt-4",variant:"destructive",onClick:m,children:"Reset to Default"})})]})]})};var k=a(54678),E=a(35021),C=a.n(E),T=a(97215),A=a(44775),R=a(93442),M=a(59726),D=a(81009),I=a(60331),L=a(81925);function P(){let{getTotalDuration:e}=(0,u.A)(),{currentTime:t}=(0,L.E)(),{activeProject:a,renameProject:x,deleteProject:g}=(0,h.I)(),[v,j]=(0,p.useState)(!1),[b,y]=(0,p.useState)(!1);(0,M.useRouter)();let{theme:w,setTheme:N}=(0,I.D)(),E=async e=>{if(a&&e.trim()&&e!==a.name)try{await x(a.id,e.trim()),y(!1)}catch(e){}},P=(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(k.rI,{children:[(0,r.jsx)(k.ty,{asChild:!0,children:(0,r.jsxs)(n.$,{variant:"secondary",className:"h-auto py-1.5 px-2.5 flex items-center justify-center",children:[(0,r.jsx)(l.A,{className:"text-muted-foreground"}),(0,r.jsx)("span",{className:"text-[0.85rem] mr-2",children:null==a?void 0:a.name})]})}),(0,r.jsxs)(k.SQ,{align:"start",className:"w-40",children:[(0,r.jsxs)(k._2,{className:"flex items-center gap-1.5",onClick:()=>(0,T.vv)(),children:[(0,r.jsx)(i.A,{className:"h-4 w-4"}),"Projects"]}),(0,r.jsxs)(k._2,{className:"flex items-center gap-1.5",onClick:()=>y(!0),children:[(0,r.jsx)(s.A,{className:"h-4 w-4"}),"Rename project"]}),(0,r.jsxs)(k._2,{variant:"destructive",className:"flex items-center gap-1.5",onClick:()=>j(!0),children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),"Delete Project"]}),(0,r.jsx)(k.mB,{}),(0,r.jsx)(k._2,{asChild:!0,children:(0,r.jsxs)(C(),{href:"https://discord.gg/zmR9N35cjK",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5",children:[(0,r.jsx)(D.O4U,{className:"h-4 w-4"}),"Discord"]})})]})]}),(0,r.jsx)(A.U,{isOpen:b,onOpenChange:y,onConfirm:E,projectName:(null==a?void 0:a.name)||""}),(0,r.jsx)(R.B,{isOpen:v,onOpenChange:j,onConfirm:()=>{a&&(g(a.id),j(!1),(0,T.vv)())},projectName:(null==a?void 0:a.name)||""})]}),z=(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)("span",{className:"text-foreground tabular-nums",children:(0,f.s)(t,"HH:MM:SS:FF",(null==a?void 0:a.fps)||30)}),(0,r.jsx)("span",{className:"text-foreground/50",children:"/"}),(0,r.jsx)("span",{className:"text-foreground/50 tabular-nums",children:(0,f.s)(e(),"HH:MM:SS:FF",(null==a?void 0:a.fps)||30)})]}),F=(0,r.jsxs)("nav",{className:"flex items-center gap-2",children:[(0,r.jsx)(S,{}),(0,r.jsxs)(n.$,{size:"sm",className:"h-8 text-xs !bg-linear-to-r from-cyan-400 to-blue-500 text-white hover:opacity-85 transition-opacity",onClick:()=>{window.open("https://youtube.com/watch?v=dQw4w9WgXcQ","_blank")},children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"text-sm pr-1",children:"Export"})]}),(0,r.jsxs)(n.$,{size:"icon",variant:"text",className:"h-7",onClick:()=>N("dark"===w?"light":"dark"),children:[(0,r.jsx)(c.A,{className:"!size-[1.1rem]"}),(0,r.jsx)("span",{className:"sr-only",children:"dark"===w?"Light":"Dark"})]})]});return(0,r.jsx)(m.H,{leftContent:P,centerContent:z,rightContent:F,className:"bg-background h-[3.2rem] px-3 items-center mt-0.5"})}},31744:(e,t,a)=>{a.d(t,{E:()=>y});var r=a(28064),n=a(80196),l=a(8300),i=a(10952);function s(e){let{element:t}=e;return(0,r.jsx)("div",{className:"space-y-4 p-5",children:"Audio properties"})}function o(e){let{element:t}=e;return(0,r.jsx)("div",{className:"space-y-4 p-5",children:"Media properties"})}var d=a(74188),c=a(93146);let u=d.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("textarea",{className:(0,c.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-background px-3 py-2 text-base shadow-xs placeholder:text-muted-foreground focus-visible:outline-hidden focus-visible:ring-0 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-xs",a),ref:t,...n})});u.displayName="Textarea";var m=a(52801);let f=[{value:"Arial",label:"Arial",category:"system",hasClassName:!1},{value:"Helvetica",label:"Helvetica",category:"system",hasClassName:!1},{value:"Times New Roman",label:"Times New Roman",category:"system",hasClassName:!1},{value:"Georgia",label:"Georgia",category:"system",hasClassName:!1},{value:"Inter",label:"Inter",category:"google",weights:[400,700],hasClassName:!0},{value:"Roboto",label:"Roboto",category:"google",weights:[400,700],hasClassName:!0},{value:"Open Sans",label:"Open Sans",category:"google",hasClassName:!0},{value:"Playfair Display",label:"Playfair Display",category:"google",hasClassName:!0},{value:"Comic Neue",label:"Comic Neue",category:"google",hasClassName:!1}];function h(e){let{defaultValue:t,onValueChange:a,className:n}=e;return(0,r.jsxs)(m.l6,{defaultValue:t,onValueChange:a,children:[(0,r.jsx)(m.bq,{className:"w-full text-xs ".concat(n||""),children:(0,r.jsx)(m.yv,{placeholder:"Select a font"})}),(0,r.jsx)(m.gC,{children:f.map(e=>(0,r.jsx)(m.eb,{value:e.value,className:"text-xs",style:{fontFamily:e.value},children:e.label},e.value))})]})}var x=a(14138),p=a(84843),g=a(61309),v=a(34248);function j(e){let{element:t,trackId:a}=e,{updateTextElement:n}=(0,l.A)(),[i,s]=(0,d.useState)(t.fontSize.toString()),[o,c]=(0,d.useState)(Math.round(100*t.opacity).toString()),m=(e,t,a,r)=>{let n=parseInt(e,10);return isNaN(n)?r:Math.max(t,Math.min(a,n))};return(0,r.jsxs)("div",{className:"space-y-6 p-5",children:[(0,r.jsx)(u,{placeholder:"Name",defaultValue:t.content,className:"min-h-18 resize-none bg-background/50",onChange:e=>n(a,t.id,{content:e.target.value})}),(0,r.jsxs)(v.DC,{direction:"row",children:[(0,r.jsx)(v.Tq,{children:"Font"}),(0,r.jsx)(v.Wg,{children:(0,r.jsx)(h,{defaultValue:t.fontFamily,onValueChange:e=>n(a,t.id,{fontFamily:e})})})]}),(0,r.jsxs)(v.DC,{direction:"column",children:[(0,r.jsxs)(v.DC,{direction:"row",children:[(0,r.jsx)(v.Tq,{children:"Style"}),(0,r.jsx)(v.Wg,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(g.$,{variant:"bold"===t.fontWeight?"default":"outline",size:"sm",onClick:()=>n(a,t.id,{fontWeight:"bold"===t.fontWeight?"normal":"bold"}),className:"h-8 px-3 font-bold",children:"B"}),(0,r.jsx)(g.$,{variant:"italic"===t.fontStyle?"default":"outline",size:"sm",onClick:()=>n(a,t.id,{fontStyle:"italic"===t.fontStyle?"normal":"italic"}),className:"h-8 px-3 italic",children:"I"}),(0,r.jsx)(g.$,{variant:"underline"===t.textDecoration?"default":"outline",size:"sm",onClick:()=>n(a,t.id,{textDecoration:"underline"===t.textDecoration?"none":"underline"}),className:"h-8 px-3 underline",children:"U"}),(0,r.jsx)(g.$,{variant:"line-through"===t.textDecoration?"default":"outline",size:"sm",onClick:()=>n(a,t.id,{textDecoration:"line-through"===t.textDecoration?"none":"line-through"}),className:"h-8 px-3 line-through",children:"S"})]})})]}),(0,r.jsx)(v.Tq,{children:"Font size"}),(0,r.jsx)(v.Wg,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{value:[t.fontSize],min:8,max:300,step:1,onValueChange:e=>{let[r]=e;n(a,t.id,{fontSize:r}),s(r.toString())},className:"w-full"}),(0,r.jsx)(p.p,{type:"number",value:i,min:8,max:300,onChange:e=>(e=>{if(s(e),""!==e.trim()){let r=m(e,8,300,t.fontSize);n(a,t.id,{fontSize:r})}})(e.target.value),onBlur:()=>{let e=m(i,8,300,t.fontSize);s(e.toString()),n(a,t.id,{fontSize:e})},className:"w-12 !text-xs h-7 rounded-sm text-center   [appearance:textfield]   [&::-webkit-outer-spin-button]:appearance-none   [&::-webkit-inner-spin-button]:appearance-none"})]})})]}),(0,r.jsxs)(v.DC,{direction:"row",children:[(0,r.jsx)(v.Tq,{children:"Color"}),(0,r.jsx)(v.Wg,{children:(0,r.jsx)(p.p,{type:"color",value:t.color||"#ffffff",onChange:e=>{let r=e.target.value;n(a,t.id,{color:r})},className:"w-full cursor-pointer rounded-full"})})]}),(0,r.jsxs)(v.DC,{direction:"row",children:[(0,r.jsx)(v.Tq,{children:"Background"}),(0,r.jsx)(v.Wg,{children:(0,r.jsx)(p.p,{type:"color",value:"transparent"===t.backgroundColor?"#000000":t.backgroundColor||"#000000",onChange:e=>{let r=e.target.value;n(a,t.id,{backgroundColor:r})},className:"w-full cursor-pointer rounded-full"})})]}),(0,r.jsxs)(v.DC,{direction:"column",children:[(0,r.jsx)(v.Tq,{children:"Opacity"}),(0,r.jsx)(v.Wg,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(x.A,{value:[100*t.opacity],min:0,max:100,step:1,onValueChange:e=>{let[r]=e;n(a,t.id,{opacity:r/100}),c(r.toString())},className:"w-full"}),(0,r.jsx)(p.p,{type:"number",value:o,min:0,max:100,onChange:e=>(e=>{if(c(e),""!==e.trim()){let r=m(e,0,100,Math.round(100*t.opacity));n(a,t.id,{opacity:r/100})}})(e.target.value),onBlur:()=>{let e=m(o,0,100,Math.round(100*t.opacity));c(e.toString()),n(a,t.id,{opacity:e/100})},className:"w-12 !text-xs h-7 rounded-sm text-center   [appearance:textfield]   [&::-webkit-outer-spin-button]:appearance-none   [&::-webkit-inner-spin-button]:appearance-none"})]})})]})]})}var b=a(24565);function y(){let{selectedElements:e,tracks:t}=(0,l.A)(),{mediaItems:a}=(0,n.B)();return(0,r.jsx)(r.Fragment,{children:e.length>0?(0,r.jsx)(i.F,{className:"h-full bg-panel rounded-sm",children:e.map(e=>{let{trackId:n,elementId:l}=e,i=t.find(e=>e.id===n),d=null==i?void 0:i.elements.find(e=>e.id===l);if((null==d?void 0:d.type)==="text")return(0,r.jsx)("div",{children:(0,r.jsx)(j,{element:d,trackId:n})},l);if((null==d?void 0:d.type)==="media"){let e=a.find(e=>e.id===d.mediaId);return(null==e?void 0:e.type)==="audio"?(0,r.jsx)(s,{element:d},l):(0,r.jsx)("div",{children:(0,r.jsx)(o,{element:d})},l)}return null})}):(0,r.jsx)(w,{})})}function w(){return(0,r.jsxs)("div",{className:"bg-panel h-full p-4 flex flex-col items-center justify-center gap-3",children:[(0,r.jsx)(b.A,{className:"w-10 h-10 text-muted-foreground",strokeWidth:1.5}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 text-center",children:[(0,r.jsx)("p",{className:"text-lg font-medium",children:"Its empty here"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-balance",children:"Click an element on the timeline to edit its properties"})]})]})}},34248:(e,t,a)=>{a.d(t,{DC:()=>s,Tq:()=>o,Wg:()=>d,Zf:()=>c});var r=a(28064),n=a(93146),l=a(90320),i=a(74188);function s(e){let{direction:t="row",children:a,className:l}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex gap-2","row"===t?"items-center justify-between gap-6":"flex-col gap-1.5",l),children:a})}function o(e){let{children:t,className:a}=e;return(0,r.jsx)("label",{className:(0,n.cn)("text-xs text-muted-foreground",a),children:t})}function d(e){let{children:t,className:a}=e;return(0,r.jsx)("div",{className:(0,n.cn)("flex-1 text-sm",a),children:t})}function c(e){let{title:t,children:a,defaultExpanded:c=!0,className:u}=e,[m,f]=(0,i.useState)(c);return(0,r.jsxs)(s,{direction:"column",className:(0,n.cn)("gap-3",u),children:[(0,r.jsxs)("div",{className:"flex items-center gap-1.5 cursor-pointer",onClick:()=>f(!m),children:[(0,r.jsx)(o,{className:"cursor-pointer",children:t}),(0,r.jsx)(l.A,{className:(0,n.cn)("size-3",!m&&"-rotate-90")})]}),m&&(0,r.jsx)(d,{children:a})]})}},41134:(e,t,a)=>{a.d(t,{T:()=>m});var r=a(61557),n=a(80196),l=a(19600),i=a(84945),s=a(3532);let o=null,d=async()=>{if(o)return o;o=new l.m;let e="".concat(s.J,"/ffmpeg");return await o.load({coreURL:await (0,i.KA)("".concat(e,"/ffmpeg-core.js"),"text/javascript"),wasmURL:await (0,i.KA)("".concat(e,"/ffmpeg-core.wasm"),"application/wasm")}),o},c=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=await d(),r="input.mp4",n="thumbnail.jpg";await a.writeFile(r,new Uint8Array(await e.arrayBuffer())),await a.exec(["-i",r,"-ss",t.toString(),"-vframes","1","-vf","scale=320:240","-q:v","2",n]);let l=new Blob([await a.readFile(n)],{type:"image/jpeg"});return await a.deleteFile(r),await a.deleteFile(n),URL.createObjectURL(l)},u=async e=>{let t=await d(),a="input.mp4";await t.writeFile(a,new Uint8Array(await e.arrayBuffer()));let r="",n=!0;t.on("log",e=>{let{message:t}=e;n&&(r+=t)});try{await t.exec(["-i",a,"-f","null","-"])}catch(e){throw n=!1,await t.deleteFile(a),Error("Failed to extract video info. The file may be corrupted or in an unsupported format.")}n=!1,await t.deleteFile(a);let l=r.match(/Duration: (\d+):(\d+):([\d.]+)/),i=0;if(l){let[,e,t,a]=l;i=3600*parseInt(e)+60*parseInt(t)+parseFloat(a)}let s=r.match(/Video:.* (\d+)x(\d+)[^,]*, ([\d.]+) fps/),o=0,c=0,u=0;return s&&(o=parseInt(s[1]),c=parseInt(s[2]),u=parseFloat(s[3])),{duration:i,width:o,height:c,fps:u}};async function m(e,t){let a=Array.from(e),l=[],i=a.length,s=0;for(let e of a){let a,o,d,m,f,h=(0,n.getFileType)(e);if(!h){r.oR.error("Unsupported file type: ".concat(e.name));continue}let x=URL.createObjectURL(e);try{if("image"===h){let t=await (0,n.getImageDimensions)(e);d=t.width,m=t.height}else if("video"===h)try{let t=await u(e);o=t.duration,d=t.width,m=t.height,f=t.fps,a=await c(e,1)}catch(r){let t=await (0,n.generateVideoThumbnail)(e);a=t.thumbnailUrl,d=t.width,m=t.height,o=await (0,n.getMediaDuration)(e)}else"audio"===h&&(o=await (0,n.getMediaDuration)(e));if(l.push({name:e.name,type:h,file:e,url:x,thumbnailUrl:a,duration:o,width:d,height:m,fps:f}),await new Promise(e=>setTimeout(e,0)),s+=1,t){let e=Math.round(s/i*100);t(e)}}catch(t){r.oR.error("Failed to process ".concat(e.name)),URL.revokeObjectURL(x)}}return l}},46438:(e,t,a)=>{a.d(t,{TooltipProvider:()=>s,ZI:()=>c,k$:()=>d,m_:()=>o});var r=a(28064),n=a(74188),l=a(1005),i=a(93146);let s=l.Provider,o=l.Root,d=l.Trigger,c=n.forwardRef((e,t)=>{let{className:a,sideOffset:n=4,...s}=e;return(0,r.jsx)(l.Portal,{children:(0,r.jsx)(l.Content,{ref:t,sideOffset:n,className:(0,i.cn)("z-50 overflow-hidden rounded-md bg-foreground px-3 py-1.5 text-xs text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...s})})});c.displayName=l.Content.displayName},67034:(e,t,a)=>{a.d(t,{Separator:()=>s});var r=a(28064),n=a(74188),l=a(22276),i=a(93146);let s=n.forwardRef((e,t)=>{let{className:a,orientation:n="horizontal",decorative:s=!0,...o}=e;return(0,r.jsx)(l.b,{ref:t,decorative:s,orientation:n,className:(0,i.cn)("shrink-0 bg-border","horizontal"===n?"h-px w-full":"h-full w-px",a),...o})});s.displayName=l.b.displayName},68820:(e,t,a)=>{a.d(t,{HK:()=>i,WM:()=>o,wV:()=>s});var r=a(28064),n=a(11940),l=a(93146);let i=e=>{let{className:t,...a}=e;return(0,r.jsx)(n.YZ,{className:(0,l.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...a})},s=n.Zk,o=e=>{let{withHandle:t,className:a,...i}=e;return(0,r.jsx)(n.TW,{className:(0,l.cn)("relative flex w-px items-center justify-center bg-transparent after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",a),...i})}},81925:(e,t,a)=>{a.d(t,{E:()=>s});var r=a(59467),n=a(8300),l=a(82337);let i=null,s=(0,r.v)((e,t)=>({isPlaying:!1,currentTime:0,duration:0,volume:1,muted:!1,previousVolume:1,speed:1,play:()=>{e({isPlaying:!0}),(e=>{i&&cancelAnimationFrame(i);let t=()=>{let r=e();if(r.isPlaying&&r.currentTime<r.duration){let e=performance.now(),t=(e-a)/1e3;a=e;let i=r.currentTime+t*r.speed,o=n.A.getState().getTotalDuration(),d=o>0?o:r.duration;if(i>=d){var s;let e=null==(s=l.I.getState().activeProject)?void 0:s.fps,t=Math.max(0,d-1/(null!=e?e:30));r.pause(),r.setCurrentTime(t),window.dispatchEvent(new CustomEvent("playback-seek",{detail:{time:t}}))}else r.setCurrentTime(i),window.dispatchEvent(new CustomEvent("playback-update",{detail:{time:i}}))}i=requestAnimationFrame(t)},a=performance.now();i=requestAnimationFrame(t)})(t)},pause:()=>{e({isPlaying:!1}),i&&(cancelAnimationFrame(i),i=null)},toggle:()=>{let{isPlaying:e}=t();e?t().pause():t().play()},seek:a=>{let{duration:r}=t(),n=Math.max(0,Math.min(r,a));e({currentTime:n});let l=new CustomEvent("playback-seek",{detail:{time:n}});window.dispatchEvent(l)},setVolume:t=>e(e=>({volume:Math.max(0,Math.min(1,t)),muted:0===t,previousVolume:t>0?t:e.previousVolume})),setSpeed:t=>{let a=Math.max(.1,Math.min(2,t));e({speed:a});let r=new CustomEvent("playback-speed",{detail:{speed:a}});window.dispatchEvent(r)},setDuration:t=>e({duration:t}),setCurrentTime:t=>e({currentTime:t}),mute:()=>{let{volume:a,previousVolume:r}=t();e({muted:!0,previousVolume:a>0?a:r,volume:0})},unmute:()=>{let{previousVolume:a}=t();e({muted:!1,volume:null!=a?a:1})},toggleMute:()=>{let{muted:e}=t();e?t().unmute():t().mute()}}))},85877:(e,t,a)=>{a.d(t,{l:()=>eP});var r=a(28064),n=a(93146),l=a(43589),i=a(53093),s=a(81450),o=a(79649),d=a(38333),c=a(78456),u=a(40149),m=a(99469),f=a(26951),h=a(16219),x=a(59467);let p={media:{icon:l.A,label:"Media"},sounds:{icon:i.A,label:"Sounds"},text:{icon:s.A,label:"Text"},stickers:{icon:o.A,label:"Stickers"},effects:{icon:d.A,label:"Effects"},transitions:{icon:c.A,label:"Transitions"},captions:{icon:u.A,label:"Captions"},filters:{icon:m.A,label:"Filters"},adjustment:{icon:f.A,label:"Adjustment"},settings:{icon:h.A,label:"Settings"}},g=(0,x.v)(e=>({activeTab:"media",setActiveTab:t=>e({activeTab:t})}));var v=a(61309),j=a(68321),b=a(37770),y=a(74188);function w(){let{activeTab:e,setActiveTab:t}=g(),a=(0,y.useRef)(null),[l,i]=(0,y.useState)(!1),[s,o]=(0,y.useState)(!0),d=()=>{if(a.current){let{scrollLeft:e,scrollWidth:t,clientWidth:r}=a.current;i(e+r>=t-1),o(e<=1)}};return(0,y.useEffect)(()=>{let e=a.current;if(!e)return;d(),e.addEventListener("scroll",d);let t=new ResizeObserver(d);return t.observe(e),()=>{e.removeEventListener("scroll",d),t.disconnect()}},[]),(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(N,{direction:"left",onClick:()=>{a.current&&(a.current.scrollTo({left:0}),o(!0),i(!1))},isVisible:!s}),(0,r.jsx)("div",{ref:a,className:"h-full px-4 flex flex-col justify-start items-center gap-5 overflow-x-auto scrollbar-x-hidden relative w-full py-4",children:Object.keys(p).map(a=>{let l=p[a];return(0,r.jsx)("div",{className:(0,n.cn)("flex flex-col gap-0.5 items-center cursor-pointer opacity-100 hover:opacity-75",e===a?"text-primary !opacity-100":"text-muted-foreground"),onClick:()=>t(a),children:(0,r.jsx)(l.icon,{className:"size-[1.1rem]!"})},a)})}),(0,r.jsx)(N,{direction:"right",onClick:()=>{a.current&&(a.current.scrollTo({left:a.current.scrollWidth}),i(!0),o(!1))},isVisible:!l})]})}function N(e){let{direction:t,onClick:a,isVisible:n}=e;if(!n)return null;let l="left"===t?j.A:b.A;return(0,r.jsx)("div",{className:"bg-panel-accent w-12 h-full flex items-center justify-center",children:(0,r.jsx)(v.$,{size:"icon",className:"rounded-[0.4rem] w-4 h-7 bg-foreground/10!",onClick:a,children:(0,r.jsx)(l,{className:"size-4! text-foreground"})})})}let S=e=>!e.types.includes("application/x-media-item")&&e.types.includes("Files");var k=a(41134),E=a(80196),C=a(93843),T=a(26880),A=a(83091),R=a(97946),M=a(57107),D=a(80965),I=a(61557),L=a(95647);function P(e){let{isVisible:t,isProcessing:a=!1,progress:n=0,onClick:l,isEmptyState:i=!1}=e;return t?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 h-full text-center rounded-lg bg-foreground/5 hover:bg-foreground/10 transition-all duration-200 p-8",onClick:e=>{!a&&l&&(e.preventDefault(),e.stopPropagation(),l())},children:[(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)(L.A,{className:"h-10 w-10 text-foreground"})}),(0,r.jsx)("div",{className:"space-y-2",children:(0,r.jsx)("p",{className:"text-xs text-muted-foreground max-w-sm",children:a?"Processing your files (".concat(n,"%)"):"Drag and drop videos, photos, and audio files here"})}),a&&(0,r.jsx)("div",{className:"w-full max-w-xs",children:(0,r.jsx)("div",{className:"w-full bg-muted/50 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:"".concat(n,"%")}})})})]}):null}var z=a(86434),F=a(54678);let O=a(26542).b;var _=a(46438),X=a(82749),B=a(85794),U=a(81925);function $(e){let{name:t,preview:a,dragData:l,onDragStart:i,onAddToTimeline:s,aspectRatio:o=16/9,className:d="",showPlusOnDrag:c=!0,showLabel:u=!0,rounded:m=!0,variant:f="card"}=e,[h,x]=(0,y.useState)(!1),[p,g]=(0,y.useState)({x:0,y:0}),v=(0,y.useRef)(null),j=(0,U.E)(e=>e.currentTime),b=()=>{null==s||s(j)},w=new window.Image;w.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",(0,y.useEffect)(()=>{if(!h)return;let e=e=>{g({x:e.clientX,y:e.clientY})};return document.addEventListener("dragover",e),()=>{document.removeEventListener("dragover",e)}},[h]);let N=e=>{e.dataTransfer.setDragImage(w,0,0),e.dataTransfer.setData("application/x-media-item",JSON.stringify(l)),e.dataTransfer.effectAllowed="copy",g({x:e.clientX,y:e.clientY}),x(!0),null==i||i(e)},S=()=>{x(!1)};return(0,r.jsxs)(r.Fragment,{children:["card"===f?(0,r.jsx)("div",{ref:v,className:"relative group w-28 h-28",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1 p-0 h-auto w-full relative cursor-default ".concat(d),children:[(0,r.jsxs)(O,{ratio:o,className:(0,n.cn)("bg-panel-accent relative overflow-hidden",m&&"rounded-md","[&::-webkit-drag-ghost]:opacity-0"),draggable:!0,onDragStart:N,onDragEnd:S,children:[a,!h&&(0,r.jsx)(H,{className:"opacity-0 group-hover:opacity-100",onClick:b})]}),u&&(0,r.jsx)("span",{className:"text-[0.7rem] text-muted-foreground truncate w-full text-left","aria-label":t,title:t,children:t.length>8?"".concat(t.slice(0,16),"...").concat(t.slice(-3)):t})]})}):(0,r.jsx)("div",{ref:v,className:"relative group w-full",children:(0,r.jsxs)("div",{className:(0,n.cn)("h-10 flex items-center gap-3 cursor-default w-full","[&::-webkit-drag-ghost]:opacity-0",d),draggable:!0,onDragStart:N,onDragEnd:S,children:[(0,r.jsx)("div",{className:"w-6 h-6 flex-shrink-0 rounded overflow-hidden",children:a}),(0,r.jsx)("span",{className:"text-sm truncate flex-1 w-full",children:t})]})}),h&&"undefined"!=typeof document&&(0,X.createPortal)((0,r.jsx)("div",{className:"fixed pointer-events-none z-9999",style:{left:p.x-40,top:p.y-40},children:(0,r.jsx)("div",{className:"w-[80px]",children:(0,r.jsxs)(O,{ratio:1,className:"relative rounded-md overflow-hidden shadow-2xl ring-3 ring-primary",children:[(0,r.jsx)("div",{className:"w-full h-full [&_img]:w-full [&_img]:h-full [&_img]:object-cover [&_img]:rounded-none",children:a}),c&&(0,r.jsx)(H,{onClick:b,tooltipText:"Add to timeline or drag to position"})]})})}),document.body)]})}function H(e){let{className:t,onClick:a,tooltipText:l}=e,i=(0,r.jsx)(v.$,{size:"icon",className:(0,n.cn)("absolute bottom-2 right-2 size-4 bg-background text-foreground",t),onClick:e=>{e.preventDefault(),e.stopPropagation(),null==a||a()},title:l,children:(0,r.jsx)(B.A,{className:"size-3!"})});return l?(0,r.jsxs)(_.m_,{children:[(0,r.jsx)(_.k$,{asChild:!0,children:i}),(0,r.jsx)(_.ZI,{children:(0,r.jsx)("p",{children:l})})]}):i}var W=a(82337),Y=a(8300),q=a(9466);function K(e){let{item:t,children:a,onRemove:n}=e;return(0,r.jsxs)(z.tz,{children:[(0,r.jsx)(z.Rc,{children:a}),(0,r.jsxs)(z.Ip,{children:[(0,r.jsx)(z.kt,{children:"Export clips"}),(0,r.jsx)(z.kt,{variant:"destructive",onClick:e=>n(e,t.id),children:"Delete"})]})]})}function V(){let{mediaItems:e,addMediaItem:t,removeMediaItem:a}=(0,E.B)(),{activeProject:n}=(0,W.I)(),{mediaViewMode:s,setMediaViewMode:o}=(0,q.v)(),d=(0,y.useRef)(null),[c,u]=(0,y.useState)(!1),[m,f]=(0,y.useState)(0),[h,x]=(0,y.useState)(""),[p,g]=(0,y.useState)("all"),[j,b]=(0,y.useState)("name"),[w,N]=(0,y.useState)("asc"),L=async e=>{if(e&&0!==e.length){if(!n)return void I.oR.error("No active project");u(!0),f(0);try{for(let a of(await (0,k.T)(e,e=>f(e))))await t(n.id,a)}catch(e){I.oR.error("Failed to process files")}finally{u(!1),f(0)}}},{isDragOver:z,dragProps:O}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,a]=(0,y.useState)(!1),r=(0,y.useRef)(0);return{isDragOver:t,dragProps:{onDragEnter:e=>{e.preventDefault(),S(e.dataTransfer)&&(r.current+=1,t||a(!0))},onDragOver:e=>{if(e.preventDefault(),!S(e.dataTransfer))return},onDragLeave:e=>{e.preventDefault(),S(e.dataTransfer)&&(r.current-=1,0===r.current&&a(!1))},onDrop:t=>{t.preventDefault(),a(!1),r.current=0,e.onDrop&&t.dataTransfer.files&&S(t.dataTransfer)&&e.onDrop(t.dataTransfer.files)}}}}({onDrop:L}),X=()=>{var e;return null==(e=d.current)?void 0:e.click()},B=async(e,t)=>{if(e.stopPropagation(),!n)return void I.oR.error("No active project");await a(n.id,t)},U=e=>{let t=Math.floor(e/60),a=Math.floor(e%60);return"".concat(t,":").concat(a.toString().padStart(2,"0"))},[$,H]=(0,y.useState)(e);(0,y.useEffect)(()=>{let t=e.filter(e=>(!p||"all"===p||e.type===p)&&(!h||!!e.name.toLowerCase().includes(h.toLowerCase())));t.sort((e,t)=>{let a,r;switch(j){case"name":a=e.name.toLowerCase(),r=t.name.toLowerCase();break;case"type":a=e.type,r=t.type;break;case"duration":a=e.duration||0,r=t.duration||0;break;case"size":a=e.file.size,r=t.file.size;break;default:return 0}return a<r?"asc"===w?-1:1:a>r?"asc"===w?1:-1:0}),H(t)},[e,p,h,j,w]);let Y=(0,y.useMemo)(()=>{let e=new Map;return $.forEach(t=>{let a;a="image"===t.type?(0,r.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,r.jsx)("img",{src:t.url,alt:t.name,className:"max-w-full max-h-full object-contain",loading:"lazy"})}):"video"===t.type?t.thumbnailUrl?(0,r.jsxs)("div",{className:"relative w-full h-full",children:[(0,r.jsx)("img",{src:t.thumbnailUrl,alt:t.name,className:"w-full h-full object-cover rounded",loading:"lazy"}),(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 rounded",children:(0,r.jsx)(l.A,{className:"h-6 w-6 text-white drop-shadow-md"})}),t.duration&&(0,r.jsx)("div",{className:"absolute bottom-1 right-1 bg-black/70 text-white text-xs px-1 rounded",children:U(t.duration)})]}):(0,r.jsxs)("div",{className:"w-full h-full bg-muted/30 flex flex-col items-center justify-center text-muted-foreground rounded",children:[(0,r.jsx)(l.A,{className:"h-6 w-6 mb-1"}),(0,r.jsx)("span",{className:"text-xs",children:"Video"}),t.duration&&(0,r.jsx)("span",{className:"text-xs opacity-70",children:U(t.duration)})]}):"audio"===t.type?(0,r.jsxs)("div",{className:"w-full h-full bg-linear-to-br from-green-500/20 to-emerald-500/20 flex flex-col items-center justify-center text-muted-foreground rounded border border-green-500/20",children:[(0,r.jsx)(i.A,{className:"h-6 w-6 mb-1"}),(0,r.jsx)("span",{className:"text-xs",children:"Audio"}),t.duration&&(0,r.jsx)("span",{className:"text-xs opacity-70",children:U(t.duration)})]}):(0,r.jsxs)("div",{className:"w-full h-full bg-muted/30 flex flex-col items-center justify-center text-muted-foreground rounded",children:[(0,r.jsx)(C.A,{className:"h-6 w-6"}),(0,r.jsx)("span",{className:"text-xs mt-1",children:"Unknown"})]}),e.set(t.id,a)}),e},[$]),K=e=>Y.get(e.id);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{ref:d,type:"file",accept:"image/*,video/*,audio/*",multiple:!0,className:"hidden",onChange:e=>{e.target.files&&L(e.target.files),e.target.value=""}}),(0,r.jsxs)("div",{className:"h-full flex flex-col gap-1 transition-colors relative ".concat(z?"bg-accent/30":""),...O,children:[(0,r.jsx)("div",{className:"p-3 pb-2 bg-panel",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(v.$,{variant:"outline",size:"lg",onClick:X,disabled:c,className:"!bg-background px-4 flex-1 justify-center items-center h-9 opacity-100 hover:opacity-75 transition-opacity",children:[c?(0,r.jsx)(T.A,{className:"h-4 w-4 animate-spin"}):(0,r.jsx)(A.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Upload"})]}),(0,r.jsx)("div",{className:"flex items-center gap-0",children:(0,r.jsx)(_.TooltipProvider,{children:(0,r.jsxs)(_.m_,{children:[(0,r.jsx)(_.k$,{asChild:!0,children:(0,r.jsx)(v.$,{size:"icon",variant:"text",onClick:()=>o("grid"===s?"list":"grid"),disabled:c,className:"justify-center items-center",children:"grid"===s?(0,r.jsx)(R.A,{strokeWidth:1.5,className:"!size-[1.05rem]"}):(0,r.jsx)(M.A,{strokeWidth:1.5,className:"!size-[1.05rem]"})})}),(0,r.jsx)(_.ZI,{children:(0,r.jsx)("p",{children:"grid"===s?"Switch to list view":"Switch to grid view"})}),(0,r.jsxs)(_.m_,{children:[(0,r.jsxs)(F.rI,{children:[(0,r.jsx)(_.k$,{asChild:!0,children:(0,r.jsx)(F.ty,{asChild:!0,children:(0,r.jsx)(v.$,{size:"icon",variant:"text",disabled:c,className:"justify-center items-center",children:(0,r.jsx)(D.A,{strokeWidth:1.5,className:"!size-[1.05rem]"})})})}),(0,r.jsxs)(F.SQ,{align:"end",children:[(0,r.jsxs)(F._2,{onClick:()=>{"name"===j?N("asc"===w?"desc":"asc"):(b("name"),N("asc"))},children:["Name"," ","name"===j&&("asc"===w?"":"")]}),(0,r.jsxs)(F._2,{onClick:()=>{"type"===j?N("asc"===w?"desc":"asc"):(b("type"),N("asc"))},children:["Type"," ","type"===j&&("asc"===w?"":"")]}),(0,r.jsxs)(F._2,{onClick:()=>{"duration"===j?N("asc"===w?"desc":"asc"):(b("duration"),N("asc"))},children:["Duration"," ","duration"===j&&("asc"===w?"":"")]}),(0,r.jsxs)(F._2,{onClick:()=>{"size"===j?N("asc"===w?"desc":"asc"):(b("size"),N("asc"))},children:["File Size"," ","size"===j&&("asc"===w?"":"")]})]})]}),(0,r.jsx)(_.ZI,{children:(0,r.jsxs)("p",{children:["Sort by ",j," (","asc"===w?"ascending":"descending",")"]})})]})]})})})]})}),(0,r.jsx)("div",{className:"h-full w-full overflow-y-auto scrollbar-thin",children:(0,r.jsx)("div",{className:"flex-1 p-3 pt-0 w-full",children:z||0===$.length?(0,r.jsx)(P,{isVisible:!0,isProcessing:c,progress:m,onClick:X,isEmptyState:0===$.length&&!z}):"grid"===s?(0,r.jsx)(Z,{filteredMediaItems:$,renderPreview:K,handleRemove:B}):(0,r.jsx)(Q,{filteredMediaItems:$,renderPreview:K,handleRemove:B,formatDuration:U})})})]})]})}function Z(e){let{filteredMediaItems:t,renderPreview:a,handleRemove:n}=e;return(0,r.jsx)("div",{className:"grid gap-2",style:{gridTemplateColumns:"repeat(auto-fill, 160px)"},children:t.map(e=>(0,r.jsx)(K,{item:e,onRemove:n,children:(0,r.jsx)($,{name:e.name,preview:a(e),dragData:{id:e.id,type:e.type,name:e.name},showPlusOnDrag:!1,onAddToTimeline:t=>Y.A.getState().addMediaAtTime(e,t),rounded:!1,variant:"card"})},e.id))})}function Q(e){let{filteredMediaItems:t,renderPreview:a,handleRemove:n,formatDuration:l}=e;return(0,r.jsx)("div",{className:"space-y-1",children:t.map(e=>(0,r.jsx)(K,{item:e,onRemove:n,children:(0,r.jsx)($,{name:e.name,preview:a(e),dragData:{id:e.id,type:e.type,name:e.name},showPlusOnDrag:!1,onAddToTimeline:t=>Y.A.getState().addMediaAtTime(e,t),variant:"compact"})},e.id))})}var G=a(87100);let J={id:"default-text",type:"text",name:"Default text",content:"Default text",fontSize:48,fontFamily:"Arial",color:"#ffffff",backgroundColor:"transparent",textAlign:"center",fontWeight:"normal",fontStyle:"normal",textDecoration:"none",x:0,y:0,rotation:0,opacity:1,duration:G.of.DEFAULT_TEXT_DURATION,startTime:0,trimStart:0,trimEnd:0};function ee(){return(0,r.jsx)("div",{className:"p-4",children:(0,r.jsx)($,{name:"Default text",preview:(0,r.jsx)("div",{className:"flex items-center justify-center w-full h-full bg-panel-accent rounded",children:(0,r.jsx)("span",{className:"text-xs select-none",children:"Default text"})}),dragData:{id:J.id,type:J.type,name:J.name,content:J.content},aspectRatio:1,onAddToTimeline:e=>Y.A.getState().addTextAtTime(J,e),showLabel:!1})})}var et=a(84843),ea=a(67034),er=a(10952),en=a(91048);let el=en.Root,ei=y.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)(en.List,{ref:t,className:(0,n.cn)("inline-flex h-auto items-center justify-center gap-2 rounded-lg bg-transparent p-0 text-muted-foreground",a),...l})});ei.displayName=en.List.displayName;let es=y.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)(en.Trigger,{ref:t,className:(0,n.cn)("inline-flex items-center cursor-pointer justify-center whitespace-nowrap rounded-lg px-3 py-1 text-sm font-medium ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-card data-[state=active]:text-foreground",a),...l})});es.displayName=en.Trigger.displayName;let eo=y.forwardRef((e,t)=>{let{className:a,...l}=e;return(0,r.jsx)(en.Content,{ref:t,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-hidden focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...l})});eo.displayName=en.Content.displayName;var ed=a(37975),ec=a(11566),eu=a(45440),em=a(47888),ef=a(19439);let eh=(0,x.v)((e,t)=>({topSoundEffects:[],isLoading:!1,error:null,hasLoaded:!1,showCommercialOnly:!0,toggleCommercialFilter:()=>{e(e=>({showCommercialOnly:!e.showCommercialOnly}))},searchQuery:"",searchResults:[],isSearching:!1,searchError:null,lastSearchQuery:"",scrollPosition:0,currentPage:1,hasNextPage:!1,totalCount:0,isLoadingMore:!1,savedSounds:[],isSavedSoundsLoaded:!1,isLoadingSavedSounds:!1,savedSoundsError:null,setTopSoundEffects:t=>e({topSoundEffects:t}),setLoading:t=>e({isLoading:t}),setError:t=>e({error:t}),setHasLoaded:t=>e({hasLoaded:t}),setSearchQuery:t=>e({searchQuery:t}),setSearchResults:t=>e({searchResults:t,currentPage:1}),setSearching:t=>e({isSearching:t}),setSearchError:t=>e({searchError:t}),setLastSearchQuery:t=>e({lastSearchQuery:t}),setScrollPosition:t=>e({scrollPosition:t}),setCurrentPage:t=>e({currentPage:t}),setHasNextPage:t=>e({hasNextPage:t}),setTotalCount:t=>e({totalCount:t}),setLoadingMore:t=>e({isLoadingMore:t}),appendSearchResults:t=>e(e=>({searchResults:[...e.searchResults,...t]})),appendTopSounds:t=>e(e=>({topSoundEffects:[...e.topSoundEffects,...t]})),resetPagination:()=>e({currentPage:1,hasNextPage:!1,totalCount:0,isLoadingMore:!1}),loadSavedSounds:async()=>{if(!t().isSavedSoundsLoaded)try{e({isLoadingSavedSounds:!0,savedSoundsError:null});let t=await ef.P.loadSavedSounds();e({savedSounds:t.sounds,isSavedSoundsLoaded:!0,isLoadingSavedSounds:!1})}catch(t){e({savedSoundsError:t instanceof Error?t.message:"Failed to load saved sounds",isLoadingSavedSounds:!1})}},saveSoundEffect:async t=>{try{await ef.P.saveSoundEffect(t);let a=await ef.P.loadSavedSounds();e({savedSounds:a.sounds})}catch(t){e({savedSoundsError:t instanceof Error?t.message:"Failed to save sound"}),I.oR.error("Failed to save sound")}},removeSavedSound:async t=>{try{await ef.P.removeSavedSound(t),e(e=>({savedSounds:e.savedSounds.filter(e=>e.id!==t)}))}catch(t){e({savedSoundsError:t instanceof Error?t.message:"Failed to remove sound"}),I.oR.error("Failed to remove sound")}},isSoundSaved:e=>{let{savedSounds:a}=t();return a.some(t=>t.id===e)},toggleSavedSound:async e=>{let{isSoundSaved:a,saveSoundEffect:r,removeSavedSound:n}=t();a(e.id)?await n(e.id):await r(e)},clearSavedSounds:async()=>{try{await ef.P.clearSavedSounds(),e({savedSounds:[],savedSoundsError:null})}catch(t){e({savedSoundsError:t instanceof Error?t.message:"Failed to clear saved sounds"}),I.oR.error("Failed to clear saved sounds")}},addSoundToTimeline:async e=>{let t=W.I.getState().activeProject;if(!t)return I.oR.error("No active project"),!1;let a=e.previewUrl;if(!a)return I.oR.error("Sound file not available"),!1;try{let r=await fetch(a);if(!r.ok)throw Error("Failed to download audio: ".concat(r.statusText));let n=await r.blob(),l=new File([n],"".concat(e.name,".mp3"),{type:"audio/mpeg"});await E.B.getState().addMediaItem(t.id,{name:e.name,type:"audio",file:l,duration:e.duration,url:URL.createObjectURL(l)});let i=E.B.getState().mediaItems.find(e=>e.file===l);if(!i)throw Error("Failed to create media item");if(Y.A.getState().addMediaAtTime(i,U.E.getState().currentTime))return!0;throw Error("Failed to add to timeline - check for overlaps")}catch(t){return I.oR.error(t instanceof Error?t.message:"Failed to add sound to timeline",{id:"sound-".concat(e.id)}),!1}}}));var ex=a(66981);function ep(){return(0,r.jsx)("div",{className:"h-full flex flex-col",children:(0,r.jsxs)(el,{defaultValue:"sound-effects",className:"flex flex-col h-full",children:[(0,r.jsx)("div",{className:"px-3 pt-4 pb-0",children:(0,r.jsxs)(ei,{children:[(0,r.jsx)(es,{value:"sound-effects",children:"Sound effects"}),(0,r.jsx)(es,{value:"songs",children:"Songs"}),(0,r.jsx)(es,{value:"saved",children:"Saved"})]})}),(0,r.jsx)(ea.Separator,{className:"my-4"}),(0,r.jsx)(eo,{value:"sound-effects",className:"p-5 pt-0 mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(eg,{})}),(0,r.jsx)(eo,{value:"saved",className:"p-5 pt-0 mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(ev,{})}),(0,r.jsx)(eo,{value:"songs",className:"p-5 pt-0 mt-0 flex-1 flex flex-col min-h-0",children:(0,r.jsx)(ej,{})})]})})}function eg(){let{topSoundEffects:e,isLoading:t,searchQuery:a,setSearchQuery:l,scrollPosition:i,setScrollPosition:s,loadSavedSounds:o,isSoundSaved:d,toggleSavedSound:c,showCommercialOnly:u,toggleCommercialFilter:m}=eh(),{results:f,isLoading:h,loadMore:x,hasNextPage:p,isLoadingMore:g}=function(e,t){let{searchResults:a,isSearching:r,searchError:n,lastSearchQuery:l,currentPage:i,hasNextPage:s,isLoadingMore:o,totalCount:d,setSearchResults:c,setSearching:u,setSearchError:m,setLastSearchQuery:f,setCurrentPage:h,setHasNextPage:x,setTotalCount:p,setLoadingMore:g,appendSearchResults:v,appendTopSounds:j,resetPagination:b}=eh(),w=async()=>{if(!o&&s)try{g(!0);let a=i+1,r=new URLSearchParams({page:a.toString(),type:"effects"});e.trim()&&r.set("q",e),r.set("commercial_only",t.toString());let n=await fetch("/api/sounds/search?".concat(r.toString()));if(n.ok){let t=await n.json();e.trim()?v(t.results):j(t.results),h(a),x(!!t.next),p(t.count)}else m("Load more failed: ".concat(n.status))}catch(e){m(e instanceof Error?e.message:"Load more failed")}finally{g(!1)}};return(0,y.useEffect)(()=>{if(!e.trim()){c([]),m(null),f("");return}if(e===l&&a.length>0)return;let t=!1,r=setTimeout(async()=>{try{u(!0),m(null),b();let a=await fetch("/api/sounds/search?q=".concat(encodeURIComponent(e),"&type=effects&page=1"));if(!t)if(a.ok){let t=await a.json();c(t.results),f(e),x(!!t.next),p(t.count),h(1)}else m("Search failed: ".concat(a.status))}catch(e){t||m(e instanceof Error?e.message:"Search failed")}finally{t||u(!1)}},300);return()=>{clearTimeout(r),t=!0}},[e,l,a.length,c,u,m,f,h,x,p,b]),{results:a,isLoading:r,error:n,loadMore:w,hasNextPage:s,isLoadingMore:o,totalCount:d}}(a,u),[j,b]=(0,y.useState)(null),[w,N]=(0,y.useState)(null),S=(0,y.useRef)(null);(0,y.useEffect)(()=>{if(o(),S.current&&i>0){let e=setTimeout(()=>{var e;null==(e=S.current)||e.scrollTo({top:i})},100);return()=>clearTimeout(e)}},[]);let k=(0,y.useMemo)(()=>a?f:e,[a,f,e]);return(0,r.jsxs)("div",{className:"flex flex-col gap-5 mt-1 h-full",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(et.p,{placeholder:"Search sound effects",className:"bg-panel-accent w-full",containerClassName:"w-full",value:a,onChange:e=>l(e.target.value),showClearIcon:!0,onClear:()=>l("")}),(0,r.jsxs)(F.rI,{children:[(0,r.jsx)(F.ty,{asChild:!0,children:(0,r.jsx)(v.$,{variant:"text",size:"icon",className:(0,n.cn)(u&&"text-primary"),children:(0,r.jsx)(ed.A,{className:"w-4 h-4"})})}),(0,r.jsxs)(F.SQ,{align:"end",className:"w-56",children:[(0,r.jsx)(F.hO,{checked:u,onCheckedChange:m,children:"Show only commercially licensed"}),(0,r.jsx)("div",{className:"px-2 py-1.5 text-xs text-muted-foreground",children:u?"Only showing sounds licensed for commercial use":"Showing all sounds regardless of license"})]})]})]}),(0,r.jsx)("div",{className:"relative h-full overflow-hidden",children:(0,r.jsx)(er.F,{className:"flex-1 h-full",ref:S,onScrollCapture:e=>{let{scrollTop:t,scrollHeight:a,clientHeight:r}=e.currentTarget;s(t),t+r>=a-200&&p&&!g&&!h&&x()},children:(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[t&&!a&&(0,r.jsx)("div",{className:"text-muted-foreground text-sm",children:"Loading sounds..."}),h&&a&&(0,r.jsx)("div",{className:"text-muted-foreground text-sm",children:"Searching..."}),k.map(e=>(0,r.jsx)(eb,{sound:e,isPlaying:j===e.id,onPlay:()=>(e=>{if(j===e.id){null==w||w.pause(),b(null);return}if(null==w||w.pause(),e.previewUrl){let t=new Audio(e.previewUrl);t.addEventListener("ended",()=>{b(null)}),t.addEventListener("error",e=>{b(null)}),t.play().catch(e=>{b(null)}),N(t),b(e.id)}})(e),isSaved:d(e.id),onToggleSaved:()=>c(e)},e.id)),!t&&!h&&0===k.length&&(0,r.jsx)("div",{className:"text-muted-foreground text-sm",children:a?"No sounds found":"No sounds available"}),g&&(0,r.jsx)("div",{className:"text-muted-foreground text-sm text-center py-4",children:"Loading more sounds..."})]})})})]})}function ev(){let{savedSounds:e,isLoadingSavedSounds:t,savedSoundsError:a,loadSavedSounds:n,isSoundSaved:l,toggleSavedSound:i,clearSavedSounds:s}=eh(),[o,d]=(0,y.useState)(null),[c,u]=(0,y.useState)(null),[m,f]=(0,y.useState)(!1);(0,y.useEffect)(()=>{n()},[n]);let h=e=>({id:e.id,name:e.name,description:"",url:"",previewUrl:e.previewUrl,downloadUrl:e.downloadUrl,duration:e.duration,filesize:0,type:"audio",channels:0,bitrate:0,bitdepth:0,samplerate:0,username:e.username,tags:e.tags,license:e.license,created:e.savedAt,downloads:0,rating:0,ratingCount:0});return t?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsx)("div",{className:"text-muted-foreground text-sm",children:"Loading saved sounds..."})}):a?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsxs)("div",{className:"text-destructive text-sm",children:["Error: ",a]})}):0===e.length?(0,r.jsxs)("div",{className:"bg-panel h-full p-4 flex flex-col items-center justify-center gap-3",children:[(0,r.jsx)(ec.A,{className:"w-10 h-10 text-muted-foreground",strokeWidth:1.5}),(0,r.jsxs)("div",{className:"flex flex-col gap-2 text-center",children:[(0,r.jsx)("p",{className:"text-lg font-medium",children:"No saved sounds"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground text-balance",children:"Click the heart icon on any sound to save it here"})]})]}):(0,r.jsxs)("div",{className:"flex flex-col gap-5 mt-1 h-full",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.length," saved"," ",1===e.length?"sound":"sounds"]}),(0,r.jsxs)(ex.lG,{open:m,onOpenChange:f,children:[(0,r.jsx)(ex.zM,{asChild:!0,children:(0,r.jsx)(v.$,{variant:"text",size:"sm",className:"h-auto text-muted-foreground hover:text-destructive !opacity-100",children:"Clear all"})}),(0,r.jsxs)(ex.Cf,{children:[(0,r.jsxs)(ex.c7,{children:[(0,r.jsx)(ex.L3,{children:"Clear all saved sounds?"}),(0,r.jsxs)(ex.rr,{children:["This will permanently remove all ",e.length," saved sounds from your collection. This action cannot be undone."]})]}),(0,r.jsxs)(ex.Es,{children:[(0,r.jsx)(v.$,{variant:"text",onClick:()=>f(!1),children:"Cancel"}),(0,r.jsx)(v.$,{variant:"destructive",onClick:async()=>{await s(),f(!1)},children:"Clear all sounds"})]})]})]})]}),(0,r.jsx)("div",{className:"relative h-full overflow-hidden",children:(0,r.jsx)(er.F,{className:"flex-1 h-full",children:(0,r.jsx)("div",{className:"flex flex-col gap-4",children:e.map(e=>(0,r.jsx)(eb,{sound:h(e),isPlaying:o===e.id,onPlay:()=>(e=>{if(o===e.id){null==c||c.pause(),d(null);return}if(null==c||c.pause(),e.previewUrl){let t=new Audio(e.previewUrl);t.addEventListener("ended",()=>{d(null)}),t.addEventListener("error",e=>{d(null)}),t.play().catch(e=>{d(null)}),u(t),d(e.id)}})(e),isSaved:l(e.id),onToggleSaved:()=>i(h(e))},e.id))})})})]})}function ej(){return(0,r.jsx)("div",{children:"Songs"})}function eb(e){let{sound:t,isPlaying:a,onPlay:n,isSaved:l,onToggleSaved:i}=e,{addSoundToTimeline:s}=eh(),o=async e=>{e.stopPropagation(),await s(t)};return(0,r.jsxs)("div",{className:"group flex items-center gap-3 opacity-100 hover:opacity-75 transition-opacity cursor-pointer",onClick:()=>{n()},children:[(0,r.jsxs)("div",{className:"relative w-12 h-12 bg-accent rounded-md flex items-center justify-center overflow-hidden shrink-0",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/20 to-transparent"}),a?(0,r.jsx)(eu.A,{className:"w-5 h-5"}):(0,r.jsx)(em.A,{className:"w-5 h-5"})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0 overflow-hidden",children:[(0,r.jsx)("p",{className:"font-medium truncate text-sm",children:t.name}),(0,r.jsx)("span",{className:"text-xs text-muted-foreground truncate block",children:t.username})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 pr-2",children:[(0,r.jsx)(v.$,{variant:"text",size:"icon",className:"text-muted-foreground hover:text-foreground !opacity-100 w-auto",onClick:o,title:"Add to timeline",children:(0,r.jsx)(B.A,{className:"w-4 h-4"})}),(0,r.jsx)(v.$,{variant:"text",size:"icon",className:"hover:text-foreground !opacity-100 w-auto ".concat(l?"text-red-500 hover:text-red-600":"text-muted-foreground"),onClick:e=>{e.stopPropagation(),i()},title:l?"Remove from saved":"Save sound",children:(0,r.jsx)(ec.A,{className:"w-4 h-4 ".concat(l?"fill-current":"")})})]})]})}var ey=a(52801),ew=a(34248),eN=a(75141),eS=a(30461);let ek=["#ffffff","#000000","#ffe2e2","#ffc9c9","#ffa2a2","#ff6467","#fb2c36","#e7000b","#c10007","#9f0712","#82181a","#460809","#fff7ed","#ffedd4","#ffd6a7","#ffb86a","#ff8904","#ff6900","#f54900","#ca3500","#9f2d00","#7e2a0c","#441306","#fffbeb","#fef3c6","#fee685","#ffd230","#ffb900","#fe9a00","#e17100","#bb4d00","#973c00","#7b3306","#461901","#fefce8","#fef9c2","#fff085","#ffdf20","#fdc700","#f0b100","#d08700","#a65f00","#894b00","#733e0a","#432004","#f7fee7","#ecfcca","#d8f999","#bbf451","#9ae600","#7ccf00","#5ea500","#497d00","#3c6300","#35530e","#192e03","#f0fdf4","#dcfce7","#b9f8cf","#7bf1a8","#05df72","#00c950","#00a63e","#008236","#016630","#0d542b","#032e15","#ecfdf5","#d0fae5","#a4f4cf","#5ee9b5","#00d492","#00bc7d","#009966","#007a55","#006045","#004f3b","#002c22","#f0fdfa","#cbfbf1","#96f7e4","#46ecd5","#00d5be","#00bba7","#009689","#00786f","#005f5a","#0b4f4a","#022f2e","#ecfeff","#cefafe","#a2f4fd","#53eafd","#00d3f2","#00b8db","#0092b8","#007595","#005f78","#104e64","#053345","#f0f9ff","#dff2fe","#b8e6fe","#74d4ff","#00bcff","#00a6f4","#0084d1","#0069a8","#00598a","#024a70","#052f4a","#eff6ff","#dbeafe","#bedbff","#8ec5ff","#51a2ff","#2b7fff","#155dfc","#1447e6","#193cb8","#1c398e","#162456","#eef2ff","#e0e7ff","#c6d2ff","#a3b3ff","#7c86ff","#615fff","#4f39f6","#432dd7","#372aac","#312c85","#1e1a4d","#f5f3ff","#ede9fe","#ddd6ff","#c4b4ff","#a684ff","#8e51ff","#7f22fe","#7008e7","#5d0ec0","#4d179a","#2f0d68","#faf5ff","#f3e8ff","#e9d4ff","#dab2ff","#c27aff","#ad46ff","#9810fa","#8200db","#6e11b0","#59168b","#3c0366","#fdf4ff","#fae8ff","#f6cfff","#f4a8ff","#ed6aff","#e12afb","#c800de","#a800b7","#8a0194","#721378","#4b004f","#fdf2f8","#fce7f3","#fccee8","#fda5d5","#fb64b6","#f6339a","#e60076","#c6005c","#a3004c","#861043","#510424","#fff1f2","#ffe4e6","#ffccd3","#ffa1ad","#ff637e","#ff2056","#ec003f","#c70036","#a50036","#8b0836","#4d0218","#f8fafc","#f1f5f9","#e2e8f0","#cad5e2","#90a1b9","#62748e","#45556c","#314158","#1d293d","#0f172b","#020618","#f9fafb","#f3f4f6","#e5e7eb","#d1d5dc","#99a1af","#6a7282","#4a5565","#364153","#1e2939","#101828","#030712","#fafafa","#f4f4f5","#e4e4e7","#d4d4d8","#9f9fa9","#71717b","#52525c","#3f3f46","#27272a","#18181b","#09090b","#f5f5f5","#e5e5e5","#d4d4d4","#a1a1a1","#737373","#525252","#404040","#262626","#171717","#0a0a0a","#fafaf9","#f5f5f4","#e7e5e4","#d6d3d1","#a6a09b","#79716b","#57534d","#44403b","#292524","#1c1917","#0c0a09"],eE=["radial-gradient(circle at 30% 70%, rgba(173, 216, 230, 0.35), transparent 60%), radial-gradient(circle at 70% 30%, rgba(255, 182, 193, 0.4), transparent 60%)","radial-gradient(circle at 20% 80%, rgba(255, 182, 153, 0.3) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(255, 244, 214, 0.5) 0%, transparent 50%), radial-gradient(circle at 40% 40%, rgba(255, 182, 153, 0.1) 0%, transparent 50%), #fff8f0","radial-gradient(circle at 20% 80%, rgba(255, 160, 146, 0.25) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(255, 244, 228, 0.3) 0%, transparent 50%), radial-gradient(circle at 40% 40%, rgba(255, 160, 146, 0.15) 0%, transparent 50%), #fef9f7","radial-gradient(circle at center, #8FFFB0, transparent), white","radial-gradient(circle at top right, rgba(173, 109, 244, 0.5), transparent 70%)","radial-gradient(circle at top right, rgba(56, 193, 182, 0.5), transparent 70%)","radial-gradient(circle at top right, rgba(255, 140, 60, 0.5), transparent 70%)","radial-gradient(circle at top right, rgba(70, 130, 180, 0.5), transparent 70%)","radial-gradient(circle at top left, rgba(173, 109, 244, 0.5), transparent 70%)"];var eC=a(2245);let eT=["linear-gradient(to right, #22d3ee, #0ea5e9, #0284c7)","linear-gradient(to right, #bfdbfe, #a5f3fc)","linear-gradient(to right, #22d3ee, #0ea5e9, #0284c7)","linear-gradient(to right, #e9d5ff, #d8b4fe, #c084fc)","linear-gradient(to right, #c4b5fd, #a78bfa, #8b5cf6)","linear-gradient(to right, #93c5fd, #60a5fa, #3b82f6)","linear-gradient(to right, #93c5fd, #60a5fa, #3b82f6)","linear-gradient(to right, #6ee7b7, #34d399, #10b981)","linear-gradient(to right, #d1fae5, #a7f3d0, #6ee7b7)","linear-gradient(to right, #fca5a5, #f87171, #ef4444)","linear-gradient(to right, #fde68a, #fbbf24, #f59e0b)","linear-gradient(to right, #fbcfe8, #f9a8d4, #f472b6)","radial-gradient(circle at bottom left, #ff00ff, #00ffff)"];function eA(){return(0,r.jsx)(eR,{})}function eR(){return(0,r.jsx)("div",{className:"h-full flex flex-col",children:(0,r.jsxs)(el,{defaultValue:"project-info",className:"flex flex-col h-full",children:[(0,r.jsx)("div",{className:"px-3 pt-4 pb-0",children:(0,r.jsxs)(ei,{children:[(0,r.jsx)(es,{value:"project-info",children:"Project info"}),(0,r.jsx)(es,{value:"background",children:"Background"})]})}),(0,r.jsx)(ea.Separator,{className:"my-4"}),(0,r.jsxs)(er.F,{className:"flex-1",children:[(0,r.jsx)(eo,{value:"project-info",className:"p-5 pt-0 mt-0",children:(0,r.jsx)(eM,{})}),(0,r.jsx)(eo,{value:"background",className:"p-4 pt-0",children:(0,r.jsx)(eL,{})})]})]})})}function eM(){let{activeProject:e,updateProjectFps:t}=(0,W.I)(),{canvasPresets:a,setCanvasSize:n}=(0,eN.U)(),{getDisplayName:l}=function(){let{canvasSize:e,canvasMode:t,canvasPresets:a}=(0,eN.U)(),{mediaItems:r}=(0,E.B)(),{tracks:n}=(0,Y.A)(),l=a.find(t=>t.width===e.width&&t.height===e.height),i=()=>e.width/e.height,s=e=>{for(let{ratio:t,label:a}of[{ratio:16/9,label:"16:9"},{ratio:9/16,label:"9:16"},{ratio:1,label:"1:1"},{ratio:4/3,label:"4:3"},{ratio:3/4,label:"3:4"},{ratio:21/9,label:"21:9"}])if(.01>Math.abs(e-t))return a;return e.toFixed(2)};return{currentPreset:l,canvasMode:t,isOriginal:"original"===t,getCurrentAspectRatio:i,getOriginalAspectRatio:()=>{for(let e of n)for(let t of e.elements)if("media"===t.type){let e=r.find(e=>e.id===t.mediaId);if(e&&("video"===e.type||"image"===e.type))return(0,E.C)(e)}return 16/9},formatAspectRatio:s,getDisplayName:()=>"original"===t?"Original":l?l.name:s(i()),canvasSize:e,canvasPresets:a}}();return(0,r.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,r.jsxs)(ew.DC,{direction:"column",children:[(0,r.jsx)(ew.Tq,{children:"Name"}),(0,r.jsx)(ew.Wg,{children:(null==e?void 0:e.name)||"Untitled project"})]}),(0,r.jsxs)(ew.DC,{direction:"column",children:[(0,r.jsx)(ew.Tq,{children:"Aspect ratio"}),(0,r.jsx)(ew.Wg,{children:(0,r.jsxs)(ey.l6,{value:l(),onValueChange:e=>{let t=a.find(t=>t.name===e);t&&n({width:t.width,height:t.height})},children:[(0,r.jsx)(ey.bq,{className:"bg-panel-accent",children:(0,r.jsx)(ey.yv,{placeholder:"Select an aspect ratio"})}),(0,r.jsx)(ey.gC,{children:a.map(e=>(0,r.jsx)(ey.eb,{value:e.name,children:e.name},e.name))})]})})]}),(0,r.jsxs)(ew.DC,{direction:"column",children:[(0,r.jsx)(ew.Tq,{children:"Frame rate"}),(0,r.jsx)(ew.Wg,{children:(0,r.jsxs)(ey.l6,{value:((null==e?void 0:e.fps)||30).toString(),onValueChange:e=>{t(parseFloat(e))},children:[(0,r.jsx)(ey.bq,{className:"bg-panel-accent",children:(0,r.jsx)(ey.yv,{placeholder:"Select a frame rate"})}),(0,r.jsx)(ey.gC,{children:G.Tm.map(e=>(0,r.jsx)(ey.eb,{value:e.value,children:e.label},e.value))})]})})]})]})}let eD=(0,y.memo)(e=>{let{blur:t,isSelected:a,onSelect:l}=e;return(0,r.jsxs)("div",{className:(0,n.cn)("w-full aspect-square rounded-sm cursor-pointer border border-foreground/15 hover:border-primary relative overflow-hidden",a&&"border-2 border-primary"),onClick:l,children:[(0,r.jsx)(eS.default,{src:"https://images.unsplash.com/photo-1501785888041-af3ef285b470?q=80&w=1470&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",alt:"Blur preview ".concat(t.label),fill:!0,className:"object-cover",style:{filter:"blur(".concat(t.value,"px)")},loading:"eager"}),(0,r.jsx)("div",{className:"absolute bottom-1 left-1 right-1 text-center",children:(0,r.jsx)("span",{className:"text-xs text-white bg-black/50 px-1 rounded",children:t.label})})]})});eD.displayName="BlurPreview";let eI=(0,y.memo)(e=>{let{backgrounds:t,currentBackgroundColor:a,isColorBackground:l,handleColorSelect:i,useBackgroundColor:s=!1}=e;return(0,y.useMemo)(()=>t.map(e=>(0,r.jsx)("div",{className:(0,n.cn)("w-full aspect-square rounded-sm cursor-pointer border border-foreground/15 hover:border-primary",l&&e===a&&"border-2 border-primary"),style:s?{backgroundColor:e}:{background:e,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},onClick:()=>i(e)},e)),[t,l,a,i,s])});function eL(){let{activeProject:e,updateBackgroundType:t}=(0,W.I)(),a=(0,y.useMemo)(()=>[{label:"Light",value:4},{label:"Medium",value:8},{label:"Heavy",value:18}],[]),n=(0,y.useCallback)(async e=>{await t("blur",{blurIntensity:e})},[t]),l=(0,y.useCallback)(async e=>{await t("color",{backgroundColor:e})},[t]),i=(null==e?void 0:e.blurIntensity)||8,s=(null==e?void 0:e.backgroundType)==="blur",o=(null==e?void 0:e.backgroundColor)||"#000000",d=(null==e?void 0:e.backgroundType)==="color",c=(0,y.useMemo)(()=>a.map(e=>(0,r.jsx)(eD,{blur:e,isSelected:s&&i===e.value,onSelect:()=>n(e.value)},e.value)),[a,s,i,n]);return(0,r.jsxs)("div",{className:"flex flex-col gap-5",children:[(0,r.jsx)(ew.Zf,{title:"Blur",defaultExpanded:!1,children:(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 w-full",children:c})}),(0,r.jsx)(ew.Zf,{title:"Colors",defaultExpanded:!1,children:(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-2 w-full",children:[(0,r.jsx)("div",{className:"w-full aspect-square rounded-sm cursor-pointer border border-foreground/15 hover:border-primary flex items-center justify-center",children:(0,r.jsx)(eC.A,{className:"size-4"})}),(0,r.jsx)(eI,{backgrounds:ek,currentBackgroundColor:o,isColorBackground:d,handleColorSelect:l,useBackgroundColor:!0})]})}),(0,r.jsx)(ew.Zf,{title:"Pattern Craft",defaultExpanded:!1,children:(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 w-full",children:(0,r.jsx)(eI,{backgrounds:eE,currentBackgroundColor:o,isColorBackground:d,handleColorSelect:l})})}),(0,r.jsx)(ew.Zf,{title:"Syntax UI",defaultExpanded:!1,children:(0,r.jsx)("div",{className:"grid grid-cols-4 gap-2 w-full",children:(0,r.jsx)(eI,{backgrounds:eT,currentBackgroundColor:o,isColorBackground:d,handleColorSelect:l})})})]})}function eP(){let{activeTab:e}=g(),t={media:(0,r.jsx)(V,{}),sounds:(0,r.jsx)(ep,{}),text:(0,r.jsx)(ee,{}),stickers:(0,r.jsx)("div",{className:"p-4 text-muted-foreground",children:"Stickers view coming soon..."}),effects:(0,r.jsx)("div",{className:"p-4 text-muted-foreground",children:"Effects view coming soon..."}),transitions:(0,r.jsx)("div",{className:"p-4 text-muted-foreground",children:"Transitions view coming soon..."}),captions:(0,r.jsx)("div",{className:"p-4 text-muted-foreground",children:"Captions view coming soon..."}),filters:(0,r.jsx)("div",{className:"p-4 text-muted-foreground",children:"Filters view coming soon..."}),adjustment:(0,r.jsx)("div",{className:"p-4 text-muted-foreground",children:"Adjustment view coming soon..."}),settings:(0,r.jsx)(eA,{})};return(0,r.jsxs)("div",{className:"h-full flex bg-panel",children:[(0,r.jsx)(w,{}),(0,r.jsx)(ea.Separator,{orientation:"vertical"}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:t[e]})]})}eI.displayName="BackgroundPreviews"},86434:(e,t,a)=>{a.d(t,{Ip:()=>h,K5:()=>p,Rc:()=>m,kt:()=>x,tz:()=>u});var r=a(28064),n=a(74188),l=a(14219),i=a(37770),s=a(58090),o=a(57118),d=a(24827),c=a(93146);let u=l.Root,m=l.Trigger;l.Group,l.Portal,l.Sub,l.RadioGroup;let f=(0,d.F)("relative flex cursor-pointer select-none items-center gap-2 px-2 py-1.5 text-sm outline-hidden transition-opacity data-disabled:pointer-events-none data-disabled:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"focus:opacity-65 focus:text-accent-foreground",destructive:"text-destructive focus:text-destructive/80"}},defaultVariants:{variant:"default"}});n.forwardRef((e,t)=>{let{className:a,inset:n,children:s,variant:o="default",...d}=e;return(0,r.jsxs)(l.SubTrigger,{ref:t,className:(0,c.cn)(f({variant:o}),"data-[state=open]:bg-accent data-[state=open]:opacity-65",n&&"pl-8",a),...d,children:[s,(0,r.jsx)(i.A,{className:"ml-auto"})]})}).displayName=l.SubTrigger.displayName,n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.SubContent,{ref:t,className:(0,c.cn)("z-50 min-w-32 overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})}).displayName=l.SubContent.displayName;let h=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.Portal,{children:(0,r.jsx)(l.Content,{ref:t,className:(0,c.cn)("z-50 min-w-32 overflow-hidden rounded-md border p-1 bg-popover text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})})});h.displayName=l.Content.displayName;let x=n.forwardRef((e,t)=>{let{className:a,inset:n,variant:i="default",...s}=e;return(0,r.jsx)(l.Item,{ref:t,className:(0,c.cn)(f({variant:i}),n&&"pl-8",a),...s})});x.displayName=l.Item.displayName,n.forwardRef((e,t)=>{let{className:a,children:n,checked:i,variant:o="default",...d}=e;return(0,r.jsxs)(l.CheckboxItem,{ref:t,className:(0,c.cn)(f({variant:o}),"pl-8 pr-2",a),checked:i,...d,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.ItemIndicator,{children:(0,r.jsx)(s.A,{className:"h-4 w-4"})})}),n]})}).displayName=l.CheckboxItem.displayName,n.forwardRef((e,t)=>{let{className:a,children:n,variant:i="default",...s}=e;return(0,r.jsxs)(l.RadioItem,{ref:t,className:(0,c.cn)(f({variant:i}),"pl-8 pr-2",a),...s,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.ItemIndicator,{children:(0,r.jsx)(o.A,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=l.RadioItem.displayName,n.forwardRef((e,t)=>{let{className:a,inset:n,...i}=e;return(0,r.jsx)(l.Label,{ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",n&&"pl-8",a),...i})}).displayName=l.Label.displayName;let p=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(l.Separator,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-foreground/10",a),...n})});p.displayName=l.Separator.displayName},87819:(e,t,a)=>{a.d(t,{M:()=>d});var r=a(28064),n=a(66981),l=a(61309),i=a(15700),s=a(74188),o=a(40124);function d(){let[e,t]=(0,s.useState)(0),[a,l]=(0,s.useState)(!1);(0,s.useEffect)(()=>{localStorage.getItem("hasSeenOnboarding")||l(!0)},[]);let i=()=>{t(e+1)},o=()=>{l(!1),localStorage.setItem("hasSeenOnboarding","true")},d=()=>{switch(e){case 0:return"Welcome to OpenCut Beta! \uD83C\uDF89";case 1:return" This is a super early beta!";case 2:return"\uD83E\uDD8B Have fun testing!";default:return"OpenCut Onboarding"}};return(0,r.jsx)(n.lG,{open:a,onOpenChange:o,children:(0,r.jsxs)(n.Cf,{className:"sm:max-w-[425px] outline-hidden!",children:[(0,r.jsx)(n.L3,{children:(0,r.jsx)("span",{className:"sr-only",children:d()})}),(()=>{switch(e){case 0:return(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(c,{title:"Welcome to OpenCut Beta! \uD83C\uDF89"}),(0,r.jsx)(u,{description:"You're among the first to try OpenCut - the fully open source CapCut alternative."})]}),(0,r.jsx)(m,{onClick:i,children:"Next"})]});case 1:return(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(c,{title:d()}),(0,r.jsx)(u,{description:"OpenCut started just one month ago. There's still a ton of things to do to make this editor amazing."}),(0,r.jsx)(u,{description:"If you're curious, check out our roadmap [here](https://opencut.app/roadmap)"})]}),(0,r.jsx)(m,{onClick:i,children:"Next"})]});case 2:return(0,r.jsxs)("div",{className:"space-y-5",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(c,{title:d()}),(0,r.jsx)(u,{description:"Join our [Discord](https://discord.gg/zmR9N35cjK), chat with cool people and share feedback to help make OpenCut the best editor ever."})]}),(0,r.jsx)(m,{onClick:o,children:"Finish"})]});default:return null}})()]})})}function c(e){let{title:t}=e;return(0,r.jsx)("h2",{className:"text-lg md:text-xl font-bold",children:t})}function u(e){let{description:t}=e;return(0,r.jsx)("div",{className:"text-muted-foreground",children:(0,r.jsx)(o.oz,{components:{p:e=>{let{children:t}=e;return(0,r.jsx)("p",{className:"mb-0",children:t})},a:e=>{let{href:t,children:a}=e;return(0,r.jsx)("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-foreground hover:text-foreground/80 underline",children:a})}},children:t})})}function m(e){let{children:t,onClick:a}=e;return(0,r.jsxs)(l.$,{onClick:a,variant:"default",className:"w-full",children:[t,(0,r.jsx)(i.A,{className:"w-4 h-4"})]})}},89100:(e,t,a)=>{a.d(t,{z:()=>s});var r=a(74188),n=a(81925),l=a(8300),i=a(61557);let s=()=>{let{isPlaying:e,currentTime:t,play:a,pause:s,seek:o}=(0,n.E)(),{selectedElements:d,tracks:c,splitElement:u,splitAndKeepLeft:m,splitAndKeepRight:f,separateAudio:h}=(0,l.A)();(0,r.useCallback)(()=>{if(1!==d.length)return void i.oR.error("Select exactly one element to split");let{trackId:e,elementId:a}=d[0],r=c.find(t=>t.id===e),n=null==r?void 0:r.elements.find(e=>e.id===a);if(!n)return;let l=n.startTime,s=n.startTime+(n.duration-n.trimStart-n.trimEnd);if(t<=l||t>=s)return void i.oR.error("Playhead must be within selected element");u(e,a,t)},[d,c,t,u]),(0,r.useCallback)(()=>{if(1!==d.length)return void i.oR.error("Select exactly one element");let{trackId:e,elementId:a}=d[0],r=c.find(t=>t.id===e),n=null==r?void 0:r.elements.find(e=>e.id===a);if(!n)return;let l=n.startTime,s=n.startTime+(n.duration-n.trimStart-n.trimEnd);if(t<=l||t>=s)return void i.oR.error("Playhead must be within selected element");m(e,a,t)},[d,c,t,m]),(0,r.useCallback)(()=>{if(1!==d.length)return void i.oR.error("Select exactly one element");let{trackId:e,elementId:a}=d[0],r=c.find(t=>t.id===e),n=null==r?void 0:r.elements.find(e=>e.id===a);if(!n)return;let l=n.startTime,s=n.startTime+(n.duration-n.trimStart-n.trimEnd);if(t<=l||t>=s)return void i.oR.error("Playhead must be within selected element");f(e,a,t)},[d,c,t,f]),(0,r.useCallback)(()=>{if(1!==d.length)return void i.oR.error("Select exactly one media element to separate audio");let{trackId:e,elementId:t}=d[0],a=c.find(t=>t.id===e);if(!a||"media"!==a.type)return void i.oR.error("Select a media element to separate audio");h(e,t)},[d,c,h])}}}]);
//# sourceMappingURL=622-ea09f038bcfadbb2.js.map