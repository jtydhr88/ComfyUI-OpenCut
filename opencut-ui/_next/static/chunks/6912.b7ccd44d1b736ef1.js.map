{"version":3,"file":"static/chunks/6912.b7ccd44d1b736ef1.js","mappings":"uRAYA,OACA,8BACA,oCACA,wCACA,4CACA,EACA,CAAC,MAAiB,EAClB,MAA0B,IAAK,SAC/B,QAAW,IAAkB,CAC7B,SACA,iCACA,CACA,CAAC,EAuID,GACA,MACA,4CACA,EACA,GACA,MACA,WACA,EACA,GAAuB,uBACvB,GACA,MACA,oCACA,EACA,GAAuB,OACvB,GACA,MACA,2BACA,EACA,GAAuB,uBACvB,GAAuB,+BACvB,EAAoC,QAAe,EACnD,wBACA,SAAmB,SAAkB,EACrC,MAAmB,QAAG,KACtB,EAAoB,QAAG,KACvB,EAAkB,QAAG,OACrB,EAhKA,MACA,MAAoB,QAAG,KACvB,EAAgB,QAAG,OACnB,GAAU,GAAI,CAAE,OAAO,GAkBvB,eACA,iBAAY,yBAAoC,CAChD,YACA,aACA,IAEA,OADA,WACA,KACM,SAEN,MADA,CAzBA,cACA,UAEA,EADA,IAAQ,QAAY,KAEpB,GAAS,IAAK,iBAER,CAEN,eADA,EACA,0BAEA,EADA,yBACA,KAEA,mBALA,EAKA,+CAAqH,GAAS,qBAAqB,EAAO,OAP1J,KAAmB,GAAS,UAAU,uCAAiD,CAUvF,WACA,GASA,OACA,IACA,EAAM,OACN,UACA,CACA,EAsBA,cACA,0EACA,CACA,oBACA,mBACA,mBAEA,iCAAsD,EAAE,IAAI,EAAE,IAAI,EAAE,GACpE,6BAEA,CACA,CA6BA,kBACA,SACA,WACA,CAAI,EAAI,EAMR,YAA8B,QAAoB,0BAClD,EAIA,EACA,+BACA,aAAkB,UAAa,CAC/B,SACA,CAAO,EACP,CAAQ,aAfR,2BAeQ,oBAdR,CACA,oCACA,eACA,CAWQ,IARR,2CACA,KASA,CACA,OAEA,YACA,QAEA,cACA,gBAzFA,YACA,UACA,mBACA,qBACA,uBACA,uBACA,2BACA,iBACA,SACA,QACA,CACA,EA+EA,iBAzDA,YACA,UACA,mBACA,eACA,uBAIA,QAHA,YACA,2BACA,eAGA,CACA,EA+CA,aAlCA,mBACA,EACA,mBADA,MAEA,EAgCA,kBA/CA,YACA,IAAY,kCAA0C,aACtD,8BACA,EA6CA,WAjFA,YAEA,SADA,YACA,CACA,c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","sources":["webpack://_N_E/../../node_modules/.bun/@comfyorg+comfyui-frontend@.+comfyorg-comfyui-frontend-1.26.2.tgz+e5b32ef95522b1e7/node_modules/@comfyorg/comfyui-frontend/lib/CreditsPanel-QeF4dlp3.js"],"sourcesContent":["import { ref, defineComponent, computed, resolveDirective, openBlock, createElementBlock, createVNode, unref, withCtx, createTextVNode, toDisplayString, createBlock, createElementVNode, createCommentVNode, withDirectives, watch, normalizeClass } from \"vue\";\nimport Button from \"primevue/button\";\nimport Column from \"primevue/column\";\nimport DataTable from \"primevue/datatable\";\nimport Divider from \"primevue/divider\";\nimport Skeleton from \"primevue/skeleton\";\nimport TabPanel from \"primevue/tabpanel\";\nimport { useI18n } from \"vue-i18n\";\nimport { a8 as axios, a9 as COMFY_API_BASE_URL, aa as useFirebaseAuthStore, ab as isAbortError, h as useDialogService, ac as useFirebaseAuthActions, ad as _sfc_main$2, ae as formatMetronomeCurrency } from \"./lib-index-DdMUP0fe.js\";\nimport Badge from \"primevue/badge\";\nimport Message from \"primevue/message\";\nimport ProgressSpinner from \"primevue/progressspinner\";\nvar EventType = /* @__PURE__ */ ((EventType2) => {\n  EventType2[\"CREDIT_ADDED\"] = \"credit_added\";\n  EventType2[\"ACCOUNT_CREATED\"] = \"account_created\";\n  EventType2[\"API_USAGE_STARTED\"] = \"api_usage_started\";\n  EventType2[\"API_USAGE_COMPLETED\"] = \"api_usage_completed\";\n  return EventType2;\n})(EventType || {});\nconst customerApiClient = axios.create({\n  baseURL: COMFY_API_BASE_URL,\n  headers: {\n    \"Content-Type\": \"application/json\"\n  }\n});\nconst useCustomerEventsService = () => {\n  const isLoading = ref(false);\n  const error = ref(null);\n  const { d } = useI18n();\n  const handleRequestError = (err, context, routeSpecificErrors) => {\n    var _a, _b, _c;\n    if (isAbortError(err)) return;\n    let message;\n    if (!axios.isAxiosError(err)) {\n      message = `${context} failed: ${err instanceof Error ? err.message : String(err)}`;\n    } else {\n      const axiosError = err;\n      const status = (_a = axiosError.response) == null ? void 0 : _a.status;\n      if (status && (routeSpecificErrors == null ? void 0 : routeSpecificErrors[status])) {\n        message = routeSpecificErrors[status];\n      } else {\n        message = ((_c = (_b = axiosError.response) == null ? void 0 : _b.data) == null ? void 0 : _c.message) ?? `${context} failed with status ${status}`;\n      }\n    }\n    error.value = message;\n  };\n  const executeRequest = async (requestCall, options) => {\n    const { errorContext, routeSpecificErrors } = options;\n    isLoading.value = true;\n    error.value = null;\n    try {\n      const response = await requestCall();\n      return response.data;\n    } catch (err) {\n      handleRequestError(err, errorContext, routeSpecificErrors);\n      return null;\n    } finally {\n      isLoading.value = false;\n    }\n  };\n  function formatEventType(eventType) {\n    switch (eventType) {\n      case \"credit_added\":\n        return \"Credits Added\";\n      case \"account_created\":\n        return \"Account Created\";\n      case \"api_usage_completed\":\n        return \"API Usage\";\n      default:\n        return eventType;\n    }\n  }\n  function formatDate(dateString) {\n    const date = new Date(dateString);\n    return d(date, {\n      month: \"short\",\n      day: \"numeric\",\n      hour: \"2-digit\",\n      minute: \"2-digit\"\n    });\n  }\n  function formatJsonKey(key) {\n    return key.split(\"_\").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(\" \");\n  }\n  function formatJsonValue(value) {\n    if (typeof value === \"number\") {\n      return value.toLocaleString();\n    }\n    if (typeof value === \"string\" && value.match(/^\\d{4}-\\d{2}-\\d{2}/)) {\n      return new Date(value).toLocaleString();\n    }\n    return value;\n  }\n  function getEventSeverity(eventType) {\n    switch (eventType) {\n      case \"credit_added\":\n        return \"success\";\n      case \"account_created\":\n        return \"info\";\n      case \"api_usage_completed\":\n        return \"warning\";\n      default:\n        return \"info\";\n    }\n  }\n  function hasAdditionalInfo(event) {\n    const { amount, api_name, model, ...otherParams } = event.params || {};\n    return Object.keys(otherParams).length > 0;\n  }\n  function getTooltipContent(event) {\n    const { ...params } = event.params || {};\n    return Object.entries(params).map(([key, value]) => {\n      const formattedKey = formatJsonKey(key);\n      const formattedValue = formatJsonValue(value);\n      return `<strong>${formattedKey}:</strong> ${formattedValue}`;\n    }).join(\"<br>\");\n  }\n  function formatAmount(amountMicros) {\n    if (!amountMicros) return \"0.00\";\n    return (amountMicros / 100).toFixed(2);\n  }\n  async function getMyEvents({\n    page = 1,\n    limit = 10\n  } = {}) {\n    const errorContext = \"Fetching customer events\";\n    const routeSpecificErrors = {\n      400: \"Invalid input, object invalid\",\n      404: \"Not found\"\n    };\n    const authHeaders = await useFirebaseAuthStore().getAuthHeader();\n    if (!authHeaders) {\n      error.value = \"Authentication header is missing\";\n      return null;\n    }\n    return executeRequest(\n      () => customerApiClient.get(\"/customers/events\", {\n        params: { page, limit },\n        headers: authHeaders\n      }),\n      { errorContext, routeSpecificErrors }\n    );\n  }\n  return {\n    // State\n    isLoading,\n    error,\n    // Methods\n    getMyEvents,\n    formatEventType,\n    getEventSeverity,\n    formatAmount,\n    hasAdditionalInfo,\n    formatDate,\n    formatJsonKey,\n    formatJsonValue,\n    getTooltipContent\n  };\n};\nconst _hoisted_1$1 = {\n  key: 0,\n  class: \"flex items-center justify-center p-8\"\n};\nconst _hoisted_2$1 = {\n  key: 1,\n  class: \"p-4\"\n};\nconst _hoisted_3$1 = { class: \"event-details\" };\nconst _hoisted_4$1 = {\n  key: 0,\n  class: \"text-green-500 font-semibold\"\n};\nconst _hoisted_5$1 = { key: 1 };\nconst _hoisted_6$1 = {\n  key: 2,\n  class: \"flex flex-col gap-1\"\n};\nconst _hoisted_7$1 = { class: \"font-semibold\" };\nconst _hoisted_8$1 = { class: \"text-sm text-gray-400\" };\nconst _sfc_main$1 = /* @__PURE__ */ defineComponent({\n  __name: \"UsageLogsTable\",\n  setup(__props, { expose: __expose }) {\n    const events = ref([]);\n    const loading = ref(true);\n    const error = ref(null);\n    const customerEventService = useCustomerEventsService();\n    const pagination = ref({\n      page: 1,\n      limit: 7,\n      total: 0,\n      totalPages: 0\n    });\n    const dataTableFirst = computed(\n      () => (pagination.value.page - 1) * pagination.value.limit\n    );\n    const tooltipContentMap = computed(() => {\n      const map = /* @__PURE__ */ new Map();\n      events.value.forEach((event) => {\n        if (customerEventService.hasAdditionalInfo(event) && event.event_id) {\n          map.set(event.event_id, customerEventService.getTooltipContent(event));\n        }\n      });\n      return map;\n    });\n    const loadEvents = async () => {\n      loading.value = true;\n      error.value = null;\n      try {\n        const response = await customerEventService.getMyEvents({\n          page: pagination.value.page,\n          limit: pagination.value.limit\n        });\n        if (response) {\n          if (response.events) {\n            events.value = response.events;\n          }\n          if (response.page) {\n            pagination.value.page = response.page;\n          }\n          if (response.limit) {\n            pagination.value.limit = response.limit;\n          }\n          if (response.total) {\n            pagination.value.total = response.total;\n          }\n          if (response.totalPages) {\n            pagination.value.totalPages = response.totalPages;\n          }\n        } else {\n          error.value = customerEventService.error.value || \"Failed to load events\";\n        }\n      } catch (err) {\n        error.value = err instanceof Error ? err.message : \"Unknown error\";\n        console.error(\"Error loading events:\", err);\n      } finally {\n        loading.value = false;\n      }\n    };\n    const onPageChange = (event) => {\n      pagination.value.page = event.page + 1;\n      loadEvents().catch((error2) => {\n        console.error(\"Error loading events:\", error2);\n      });\n    };\n    const refresh = async () => {\n      pagination.value.page = 1;\n      await loadEvents();\n    };\n    __expose({\n      refresh\n    });\n    return (_ctx, _cache) => {\n      const _directive_tooltip = resolveDirective(\"tooltip\");\n      return openBlock(), createElementBlock(\"div\", null, [\n        loading.value ? (openBlock(), createElementBlock(\"div\", _hoisted_1$1, [\n          createVNode(unref(ProgressSpinner))\n        ])) : error.value ? (openBlock(), createElementBlock(\"div\", _hoisted_2$1, [\n          createVNode(unref(Message), {\n            severity: \"error\",\n            closable: false\n          }, {\n            default: withCtx(() => [\n              createTextVNode(toDisplayString(error.value), 1)\n            ]),\n            _: 1\n          })\n        ])) : (openBlock(), createBlock(unref(DataTable), {\n          key: 2,\n          value: events.value,\n          paginator: true,\n          rows: pagination.value.limit,\n          \"total-records\": pagination.value.total,\n          first: dataTableFirst.value,\n          lazy: true,\n          class: \"p-datatable-sm custom-datatable\",\n          onPage: onPageChange\n        }, {\n          default: withCtx(() => [\n            createVNode(unref(Column), {\n              field: \"event_type\",\n              header: _ctx.$t(\"credits.eventType\")\n            }, {\n              body: withCtx(({ data }) => [\n                createVNode(unref(Badge), {\n                  value: unref(customerEventService).formatEventType(data.event_type),\n                  severity: unref(customerEventService).getEventSeverity(data.event_type)\n                }, null, 8, [\"value\", \"severity\"])\n              ]),\n              _: 1\n            }, 8, [\"header\"]),\n            createVNode(unref(Column), {\n              field: \"details\",\n              header: _ctx.$t(\"credits.details\")\n            }, {\n              body: withCtx(({ data }) => {\n                var _a, _b, _c;\n                return [\n                  createElementVNode(\"div\", _hoisted_3$1, [\n                    data.event_type === unref(EventType).CREDIT_ADDED ? (openBlock(), createElementBlock(\"div\", _hoisted_4$1, toDisplayString(_ctx.$t(\"credits.added\")) + \" $\" + toDisplayString(unref(customerEventService).formatAmount((_a = data.params) == null ? void 0 : _a.amount)), 1)) : data.event_type === unref(EventType).ACCOUNT_CREATED ? (openBlock(), createElementBlock(\"div\", _hoisted_5$1, toDisplayString(_ctx.$t(\"credits.accountInitialized\")), 1)) : data.event_type === unref(EventType).API_USAGE_COMPLETED ? (openBlock(), createElementBlock(\"div\", _hoisted_6$1, [\n                      createElementVNode(\"div\", _hoisted_7$1, toDisplayString(((_b = data.params) == null ? void 0 : _b.api_name) || \"API\"), 1),\n                      createElementVNode(\"div\", _hoisted_8$1, toDisplayString(_ctx.$t(\"credits.model\")) + \": \" + toDisplayString(((_c = data.params) == null ? void 0 : _c.model) || \"-\"), 1)\n                    ])) : createCommentVNode(\"\", true)\n                  ])\n                ];\n              }),\n              _: 1\n            }, 8, [\"header\"]),\n            createVNode(unref(Column), {\n              field: \"createdAt\",\n              header: _ctx.$t(\"credits.time\")\n            }, {\n              body: withCtx(({ data }) => [\n                createTextVNode(toDisplayString(unref(customerEventService).formatDate(data.createdAt)), 1)\n              ]),\n              _: 1\n            }, 8, [\"header\"]),\n            createVNode(unref(Column), {\n              field: \"params\",\n              header: _ctx.$t(\"credits.additionalInfo\")\n            }, {\n              body: withCtx(({ data }) => [\n                unref(customerEventService).hasAdditionalInfo(data) ? withDirectives((openBlock(), createBlock(unref(Button), {\n                  key: 0,\n                  icon: \"pi pi-info-circle\",\n                  class: \"p-button-text p-button-sm\"\n                }, null, 512)), [\n                  [\n                    _directive_tooltip,\n                    {\n                      escape: false,\n                      value: tooltipContentMap.value.get(data.event_id) || \"\",\n                      pt: {\n                        text: {\n                          style: {\n                            width: \"max-content !important\"\n                          }\n                        }\n                      }\n                    },\n                    void 0,\n                    { top: true }\n                  ]\n                ]) : createCommentVNode(\"\", true)\n              ]),\n              _: 1\n            }, 8, [\"header\"])\n          ]),\n          _: 1\n        }, 8, [\"value\", \"rows\", \"total-records\", \"first\"]))\n      ]);\n    };\n  }\n});\nconst _hoisted_1 = { class: \"flex flex-col h-full\" };\nconst _hoisted_2 = { class: \"text-2xl font-bold mb-2\" };\nconst _hoisted_3 = { class: \"flex flex-col gap-2\" };\nconst _hoisted_4 = { class: \"text-sm font-medium text-muted\" };\nconst _hoisted_5 = { class: \"flex justify-between items-center\" };\nconst _hoisted_6 = { class: \"flex flex-row items-center\" };\nconst _hoisted_7 = {\n  key: 1,\n  class: \"text-xs text-muted\"\n};\nconst _hoisted_8 = { class: \"flex justify-between items-center\" };\nconst _hoisted_9 = {\n  key: 0,\n  class: \"flex-grow\"\n};\nconst _hoisted_10 = { class: \"text-sm font-medium\" };\nconst _hoisted_11 = { class: \"text-xs text-muted\" };\nconst _hoisted_12 = { class: \"flex flex-row gap-2\" };\nconst _sfc_main = /* @__PURE__ */ defineComponent({\n  __name: \"CreditsPanel\",\n  setup(__props) {\n    const { t } = useI18n();\n    const dialogService = useDialogService();\n    const authStore = useFirebaseAuthStore();\n    const authActions = useFirebaseAuthActions();\n    const loading = computed(() => authStore.loading);\n    const balanceLoading = computed(() => authStore.isFetchingBalance);\n    const usageLogsTableRef = ref(null);\n    const formattedLastUpdateTime = computed(\n      () => authStore.lastBalanceUpdateTime ? authStore.lastBalanceUpdateTime.toLocaleString() : \"\"\n    );\n    watch(\n      () => authStore.lastBalanceUpdateTime,\n      (newTime, oldTime) => {\n        if (newTime && newTime !== oldTime && usageLogsTableRef.value) {\n          usageLogsTableRef.value.refresh();\n        }\n      }\n    );\n    const handlePurchaseCreditsClick = () => {\n      dialogService.showTopUpCreditsDialog();\n    };\n    const handleCreditsHistoryClick = async () => {\n      await authActions.accessBillingPortal();\n    };\n    const handleMessageSupport = () => {\n      dialogService.showIssueReportDialog({\n        title: t(\"issueReport.contactSupportTitle\"),\n        subtitle: t(\"issueReport.contactSupportDescription\"),\n        panelProps: {\n          errorType: \"BillingSupport\",\n          defaultFields: [\"Workflow\", \"Logs\", \"SystemStats\", \"Settings\"]\n        }\n      });\n    };\n    const handleFaqClick = () => {\n      window.open(\"https://docs.comfy.org/tutorials/api-nodes/faq\", \"_blank\");\n    };\n    const creditHistory = ref([]);\n    return (_ctx, _cache) => {\n      return openBlock(), createBlock(unref(TabPanel), {\n        value: \"Credits\",\n        class: \"credits-container h-full\"\n      }, {\n        default: withCtx(() => [\n          createElementVNode(\"div\", _hoisted_1, [\n            createElementVNode(\"h2\", _hoisted_2, toDisplayString(_ctx.$t(\"credits.credits\")), 1),\n            createVNode(unref(Divider)),\n            createElementVNode(\"div\", _hoisted_3, [\n              createElementVNode(\"h3\", _hoisted_4, toDisplayString(_ctx.$t(\"credits.yourCreditBalance\")), 1),\n              createElementVNode(\"div\", _hoisted_5, [\n                createVNode(_sfc_main$2, { \"text-class\": \"text-3xl font-bold\" }),\n                loading.value ? (openBlock(), createBlock(unref(Skeleton), {\n                  key: 0,\n                  width: \"2rem\",\n                  height: \"2rem\"\n                })) : (openBlock(), createBlock(unref(Button), {\n                  key: 1,\n                  label: _ctx.$t(\"credits.purchaseCredits\"),\n                  loading: loading.value,\n                  onClick: handlePurchaseCreditsClick\n                }, null, 8, [\"label\", \"loading\"]))\n              ]),\n              createElementVNode(\"div\", _hoisted_6, [\n                balanceLoading.value ? (openBlock(), createBlock(unref(Skeleton), {\n                  key: 0,\n                  width: \"12rem\",\n                  height: \"1rem\",\n                  class: \"text-xs\"\n                })) : formattedLastUpdateTime.value ? (openBlock(), createElementBlock(\"div\", _hoisted_7, toDisplayString(_ctx.$t(\"credits.lastUpdated\")) + \": \" + toDisplayString(formattedLastUpdateTime.value), 1)) : createCommentVNode(\"\", true),\n                createVNode(unref(Button), {\n                  icon: \"pi pi-refresh\",\n                  text: \"\",\n                  size: \"small\",\n                  severity: \"secondary\",\n                  onClick: _cache[0] || (_cache[0] = () => unref(authActions).fetchBalance())\n                })\n              ])\n            ]),\n            createElementVNode(\"div\", _hoisted_8, [\n              createElementVNode(\"h3\", null, toDisplayString(_ctx.$t(\"credits.activity\")), 1),\n              createVNode(unref(Button), {\n                label: _ctx.$t(\"credits.invoiceHistory\"),\n                text: \"\",\n                severity: \"secondary\",\n                icon: \"pi pi-arrow-up-right\",\n                loading: loading.value,\n                onClick: handleCreditsHistoryClick\n              }, null, 8, [\"label\", \"loading\"])\n            ]),\n            creditHistory.value.length > 0 ? (openBlock(), createElementBlock(\"div\", _hoisted_9, [\n              createVNode(unref(DataTable), {\n                value: creditHistory.value,\n                \"show-headers\": false\n              }, {\n                default: withCtx(() => [\n                  createVNode(unref(Column), {\n                    field: \"title\",\n                    header: _ctx.$t(\"g.name\")\n                  }, {\n                    body: withCtx(({ data }) => [\n                      createElementVNode(\"div\", _hoisted_10, toDisplayString(data.title), 1),\n                      createElementVNode(\"div\", _hoisted_11, toDisplayString(data.timestamp), 1)\n                    ]),\n                    _: 1\n                  }, 8, [\"header\"]),\n                  createVNode(unref(Column), {\n                    field: \"amount\",\n                    header: _ctx.$t(\"g.amount\")\n                  }, {\n                    body: withCtx(({ data }) => [\n                      createElementVNode(\"div\", {\n                        class: normalizeClass([\n                          \"text-base font-medium text-center\",\n                          data.isPositive ? \"text-sky-500\" : \"text-red-400\"\n                        ])\n                      }, toDisplayString(data.isPositive ? \"+\" : \"-\") + \"$\" + toDisplayString(unref(formatMetronomeCurrency)(data.amount, \"usd\")), 3)\n                    ]),\n                    _: 1\n                  }, 8, [\"header\"])\n                ]),\n                _: 1\n              }, 8, [\"value\"])\n            ])) : createCommentVNode(\"\", true),\n            createVNode(unref(Divider)),\n            createVNode(_sfc_main$1, {\n              ref_key: \"usageLogsTableRef\",\n              ref: usageLogsTableRef\n            }, null, 512),\n            createElementVNode(\"div\", _hoisted_12, [\n              createVNode(unref(Button), {\n                label: _ctx.$t(\"credits.faqs\"),\n                text: \"\",\n                severity: \"secondary\",\n                icon: \"pi pi-question-circle\",\n                onClick: handleFaqClick\n              }, null, 8, [\"label\"]),\n              createVNode(unref(Button), {\n                label: _ctx.$t(\"credits.messageSupport\"),\n                text: \"\",\n                severity: \"secondary\",\n                icon: \"pi pi-comments\",\n                onClick: handleMessageSupport\n              }, null, 8, [\"label\"])\n            ])\n          ])\n        ]),\n        _: 1\n      });\n    };\n  }\n});\nexport {\n  _sfc_main as default\n};\n//# sourceMappingURL=CreditsPanel-QeF4dlp3.js.map\n"],"names":[],"sourceRoot":"","ignoreList":[0]}