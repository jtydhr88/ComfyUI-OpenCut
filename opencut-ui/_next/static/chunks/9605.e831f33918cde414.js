"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9605],{20142:(e,a,n)=>{n.d(a,{Rn:()=>o}),n(94578);var o={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",IN:"in",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",BETWEEN:"between",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"}},69605:(e,a,n)=>{n.r(a),n.d(a,{default:()=>w});var o=n(20713),l=n(92737),t=n(86568),i=n(72780),d=n(20142),s=n(9403),r=n(22917),c=n(44390),m=n(36611),u=n(52803),y=n(16098),b=n(7975),g=n(44348),v=n(86763),f=n(28664);let p=[{combo:{ctrl:!0,key:"Enter"},commandId:"Comfy.QueuePrompt"},{combo:{ctrl:!0,shift:!0,key:"Enter"},commandId:"Comfy.QueuePromptFront"},{combo:{ctrl:!0,alt:!0,key:"Enter"},commandId:"Comfy.Interrupt"},{combo:{key:"r"},commandId:"Comfy.RefreshNodeDefinitions"},{combo:{key:"q"},commandId:"Workspace.ToggleSidebarTab.queue"},{combo:{key:"w"},commandId:"Workspace.ToggleSidebarTab.workflows"},{combo:{key:"n"},commandId:"Workspace.ToggleSidebarTab.node-library"},{combo:{key:"m"},commandId:"Workspace.ToggleSidebarTab.model-library"},{combo:{key:"s",ctrl:!0},commandId:"Comfy.SaveWorkflow"},{combo:{key:"o",ctrl:!0},commandId:"Comfy.OpenWorkflow"},{combo:{key:"g",ctrl:!0},commandId:"Comfy.Graph.GroupSelectedNodes"},{combo:{key:",",ctrl:!0},commandId:"Comfy.ShowSettingsDialog"},{combo:{key:"=",alt:!0},commandId:"Comfy.Canvas.ZoomIn",targetElementId:"graph-canvas"},{combo:{key:"+",alt:!0,shift:!0},commandId:"Comfy.Canvas.ZoomIn",targetElementId:"graph-canvas"},{combo:{key:"+",alt:!0},commandId:"Comfy.Canvas.ZoomIn",targetElementId:"graph-canvas"},{combo:{key:"-",alt:!0},commandId:"Comfy.Canvas.ZoomOut",targetElementId:"graph-canvas"},{combo:{key:"."},commandId:"Comfy.Canvas.FitView",targetElementId:"graph-canvas"},{combo:{key:"p"},commandId:"Comfy.Canvas.ToggleSelected.Pin",targetElementId:"graph-canvas"},{combo:{key:"c",alt:!0},commandId:"Comfy.Canvas.ToggleSelectedNodes.Collapse",targetElementId:"graph-canvas"},{combo:{key:"b",ctrl:!0},commandId:"Comfy.Canvas.ToggleSelectedNodes.Bypass",targetElementId:"graph-canvas"},{combo:{key:"m",ctrl:!0},commandId:"Comfy.Canvas.ToggleSelectedNodes.Mute",targetElementId:"graph-canvas"},{combo:{key:"`",ctrl:!0},commandId:"Workspace.ToggleBottomPanelTab.logs-terminal"},{combo:{key:"f"},commandId:"Workspace.ToggleFocusMode"},{combo:{key:"e",ctrl:!0,shift:!0},commandId:"Comfy.Graph.ConvertToSubgraph"},{combo:{key:"m",alt:!0},commandId:"Comfy.Canvas.ToggleMinimap"},{combo:{ctrl:!0,shift:!0,key:"k"},commandId:"Workspace.ToggleBottomPanel.Shortcuts"},{combo:{key:"Escape"},commandId:"Comfy.Graph.ExitSubgraph"}],k={key:0,class:"px-2"},C=(0,o.pM)({__name:"KeyComboDisplay",props:{keyCombo:{},isModified:{type:Boolean,default:!1}},setup(e){let a=(0,o.EW)(()=>e.keyCombo.getKeySequences());return(e,n)=>((0,o.uX)(),(0,o.CE)("span",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.value,(n,i)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:i},[(0,o.bF)((0,l.R1)(b.A),{severity:e.isModified?"info":"secondary"},{default:(0,o.k6)(()=>[(0,o.eW)((0,t.v_)(n),1)]),_:2},1032,["severity"]),i<a.value.length-1?((0,o.uX)(),(0,o.CE)("span",k,"+")):(0,o.Q3)("",!0)],64))),128))]))}}),I={class:"actions invisible flex flex-row"},h=["title"],E={key:1},K={class:"overflow-hidden text-ellipsis"},T=(0,o.pM)({__name:"KeybindingPanel",setup(e){let a=(0,l.KR)({global:{value:"",matchMode:d.Rn.CONTAINS}}),n=(0,f.ag)(),k=(()=>{let e=(0,f.ag)(),a=(0,f.ah)(),n=(0,f.P)(),o=(0,f.Q)();return{keybindHandler:async function(n){let l=f.ai.fromEvent(n);if(l.isModifier)return;let t=n.composedPath()[0];if(l.isReservedByTextInput&&("TEXTAREA"===t.tagName||"INPUT"===t.tagName||"SPAN"===t.tagName&&t.classList.contains("property_value")))return;let i=e.getKeybinding(l);if(i&&"graph-canvas"!==i.targetElementId){if("Escape"===n.key&&!n.ctrlKey&&!n.altKey&&!n.metaKey&&o.dialogStack.length>0)return;n.preventDefault(),await a.execute(i.commandId);return}if(!n.ctrlKey&&!n.altKey&&!n.metaKey&&"Escape"===n.key){for(let e of document.querySelectorAll(".comfy-modal"))if("none"!==window.getComputedStyle(e).getPropertyValue("display")){e.style.display="none";break}for(let e of document.querySelectorAll("dialog"))e.close()}},registerCoreKeybindings:()=>{for(let a of p)e.addDefaultKeybinding(new f.aj(a))},registerUserKeybindings:function(){for(let a of n.get("Comfy.Keybinding.UnsetBindings"))e.unsetKeybinding(new f.aj(a));for(let a of n.get("Comfy.Keybinding.NewBindings"))e.addUserKeybinding(new f.aj(a))},persistUserKeybindings:async function(){await n.set("Comfy.Keybinding.NewBindings",Object.values(e.getUserKeybindings())),await n.set("Comfy.Keybinding.UnsetBindings",Object.values(e.getUserUnsetKeybindings()))}}})(),T=(0,f.ah)(),{t:w}=(0,v.s9)(),A=(0,o.EW)(()=>Object.values(T.commands).map(e=>({id:e.id,label:w(`commands.${(0,f.ak)(e.id)}.label`,e.label??""),keybinding:n.getKeybindingByCommandId(e.id),source:e.source}))),_=(0,l.KR)(null),R=(0,l.KR)(!1),S=(0,l.KR)(null),N=(0,l.KR)(null),F=(0,l.KR)(null),W=(0,o.EW)(()=>{var e,a;return!N.value||(null==(a=null==(e=N.value.keybinding)?void 0:e.combo)?void 0:a.equals(S.value))||!S.value?null:n.getKeybinding(S.value)});function U(e){N.value=e,S.value=e.keybinding?e.keybinding.combo:null,R.value=!0}async function x(e){e.keybinding&&(n.unsetKeybinding(e.keybinding),await k.persistUserKeybindings())}async function O(e){if(!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)switch(e.key){case"Escape":B();return;case"Enter":await D();return}S.value=f.ai.fromEvent(e)}function B(){R.value=!1,N.value=null,S.value=null}async function D(){N.value&&S.value&&n.updateKeybindingOnCommand(new f.aj({commandId:N.value.id,combo:S.value}))&&await k.persistUserKeybindings(),B()}async function P(e){n.resetKeybindingForCommand(e.id)?await k.persistUserKeybindings():console.warn(`No changes made when resetting keybinding for command: ${e.id}`)}(0,o.nT)(()=>{R.value&&setTimeout(()=>{var e,a;null==(a=null==(e=F.value)?void 0:e.$el)||a.focus()},300)});let L=(0,g.d)();async function M(){n.resetAllKeybindings(),await k.persistUserKeybindings(),L.add({severity:"info",summary:"Info",detail:"All keybindings reset",life:3e3})}return(e,d)=>{let g=(0,o.gN)("tooltip");return(0,o.uX)(),(0,o.Wv)(f.a7,{value:"Keybinding",class:"keybinding-panel"},{header:(0,o.k6)(()=>[(0,o.bF)(f.al,{modelValue:a.value.global.value,"onUpdate:modelValue":d[0]||(d[0]=e=>a.value.global.value=e),placeholder:e.$t("g.searchKeybindings")+"..."},null,8,["modelValue","placeholder"])]),default:(0,o.k6)(()=>{var v;return[(0,o.bF)((0,l.R1)(c.A),{selection:_.value,"onUpdate:selection":d[1]||(d[1]=e=>_.value=e),value:A.value,"global-filter-fields":["id","label"],filters:a.value,"selection-mode":"single","striped-rows":"",pt:{header:"px-0"},onRowDblclick:d[2]||(d[2]=e=>U(e.data))},{default:(0,o.k6)(()=>[(0,o.bF)((0,l.R1)(r.A),{field:"actions",header:""},{body:(0,o.k6)(e=>[(0,o.Lk)("div",I,[(0,o.bF)((0,l.R1)(s.A),{icon:"pi pi-pencil",class:"p-button-text",onClick:a=>U(e.data)},null,8,["onClick"]),(0,o.bF)((0,l.R1)(s.A),{icon:"pi pi-replay",class:"p-button-text p-button-warn",disabled:!(0,l.R1)(n).isCommandKeybindingModified(e.data.id),onClick:a=>P(e.data)},null,8,["disabled","onClick"]),(0,o.bF)((0,l.R1)(s.A),{icon:"pi pi-trash",class:"p-button-text p-button-danger",disabled:!e.data.keybinding,onClick:a=>x(e.data)},null,8,["disabled","onClick"])])]),_:1}),(0,o.bF)((0,l.R1)(r.A),{field:"id",header:e.$t("g.command"),sortable:"",class:"max-w-64 2xl:max-w-full"},{body:(0,o.k6)(e=>[(0,o.Lk)("div",{class:"overflow-hidden text-ellipsis whitespace-nowrap",title:e.data.id},(0,t.v_)(e.data.label),9,h)]),_:1},8,["header"]),(0,o.bF)((0,l.R1)(r.A),{field:"keybinding",header:e.$t("g.keybinding")},{body:(0,o.k6)(e=>[e.data.keybinding?((0,o.uX)(),(0,o.Wv)(C,{key:0,"key-combo":e.data.keybinding.combo,"is-modified":(0,l.R1)(n).isCommandKeybindingModified(e.data.id)},null,8,["key-combo","is-modified"])):((0,o.uX)(),(0,o.CE)("span",E,"-"))]),_:1},8,["header"]),(0,o.bF)((0,l.R1)(r.A),{field:"source",header:e.$t("g.source")},{body:(0,o.k6)(e=>[(0,o.Lk)("span",K,(0,t.v_)(e.data.source||"-"),1)]),_:1},8,["header"])]),_:1},8,["selection","value","filters"]),(0,o.bF)((0,l.R1)(m.A),{visible:R.value,"onUpdate:visible":d[3]||(d[3]=e=>R.value=e),class:"min-w-96",modal:"",header:null==(v=N.value)?void 0:v.label,onHide:B},{footer:(0,o.k6)(()=>[(0,o.bF)((0,l.R1)(s.A),{label:W.value?"Overwrite":"Save",icon:W.value?"pi pi-pencil":"pi pi-check",severity:W.value?"warn":void 0,autofocus:"",onClick:D},null,8,["label","icon","severity"])]),default:(0,o.k6)(()=>{var a;return[(0,o.Lk)("div",null,[(0,o.bF)((0,l.R1)(u.A),{ref_key:"keybindingInput",ref:F,class:"mb-2 text-center","model-value":(null==(a=S.value)?void 0:a.toString())??"",placeholder:"Press keys for new binding",autocomplete:"off",fluid:"",onKeydown:(0,i.D$)(O,["stop","prevent"])},null,8,["model-value"]),W.value?((0,o.uX)(),(0,o.Wv)((0,l.R1)(y.A),{key:0,severity:"warn"},{default:(0,o.k6)(()=>[(0,o.eW)((0,t.v_)(e.$t("g.keybindingAlreadyExists"))+" ",1),(0,o.bF)((0,l.R1)(b.A),{severity:"secondary",value:W.value.commandId},null,8,["value"])]),_:1})):(0,o.Q3)("",!0)])]}),_:1},8,["visible","header"]),(0,o.bo)((0,o.bF)((0,l.R1)(s.A),{class:"mt-4",label:e.$t("g.resetAll"),icon:"pi pi-replay",severity:"danger",fluid:"",text:"",onClick:M},null,8,["label"]),[[g,e.$t("g.resetAllKeybindingsTooltip")]])]}),_:1})}}}),w=(0,f._)(T,[["__scopeId","data-v-ac8bbe49"]])}}]);
//# sourceMappingURL=9605.e831f33918cde414.js.map